require=// modules are defined as an array
// [ module function, map of requireuires ]
//
// map of requireuires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the requireuire for previous bundles

(function outer (modules, cache, entry) {
    // Save the require from previous bundle to this closure if any
    var previousRequire = typeof require == "function" && require;

    function findProxyquireifyName() {
        var deps = Object.keys(modules)
            .map(function (k) { return modules[k][1]; });

        for (var i = 0; i < deps.length; i++) {
            var pq = deps[i]['proxyquireify'];
            if (pq) return pq;
        }
    }

    var proxyquireifyName = findProxyquireifyName();

    function newRequire(name, jumped){
        // Find the proxyquireify module, if present
        var pqify = (proxyquireifyName != null) && cache[proxyquireifyName];

        // Proxyquireify provides a separate cache that is used when inside
        // a proxyquire call, and is set to null outside a proxyquire call.
        // This allows the regular caching semantics to work correctly both
        // inside and outside proxyquire calls while keeping the cached
        // modules isolated.
        // When switching from one proxyquire call to another, it clears
        // the cache to prevent contamination between different sets
        // of stubs.
        var currentCache = (pqify && pqify.exports._cache) || cache;

        if(!currentCache[name]) {
            if(!modules[name]) {
                // if we cannot find the the module within our internal map or
                // cache jump to the current global require ie. the last bundle
                // that was added to the page.
                var currentRequire = typeof require == "function" && require;
                if (!jumped && currentRequire) return currentRequire(name, true);

                // If there are other bundles on this page the require from the
                // previous one is saved to 'previousRequire'. Repeat this as
                // many times as there are bundles until the module is found or
                // we exhaust the require chain.
                if (previousRequire) return previousRequire(name, true);
                var err = new Error('Cannot find module \'' + name + '\'');
                err.code = 'MODULE_NOT_FOUND';
                throw err;
            }
            var m = currentCache[name] = {exports:{}};

            // The normal browserify require function
            var req = function(x){
                var id = modules[name][1][x];
                return newRequire(id ? id : x);
            };

            // The require function substituted for proxyquireify
            var moduleRequire = function(x){
                var pqify = (proxyquireifyName != null) && cache[proxyquireifyName];
                // Only try to use the proxyquireify version if it has been `require`d
                if (pqify && pqify.exports._proxy) {
                    return pqify.exports._proxy(req, x);
                } else {
                    return req(x);
                }
            };

            modules[name][0].call(m.exports,moduleRequire,m,m.exports,outer,modules,currentCache,entry);
        }
        return currentCache[name].exports;
    }
    for(var i=0;i<entry.length;i++) newRequire(entry[i]);

    // Override the current require with this new one
    return newRequire;
})
({1:[function(require,module,exports){
;(function (root, factory) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory();
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define([], factory);
	}
	else {
		// Global (browser)
		root.CryptoJS = factory();
	}
}(this, function () {

	/**
	 * CryptoJS core components.
	 */
	var CryptoJS = CryptoJS || (function (Math, undefined) {
	    /*
	     * Local polyfil of Object.create
	     */
	    var create = Object.create || (function () {
	        function F() {};

	        return function (obj) {
	            var subtype;

	            F.prototype = obj;

	            subtype = new F();

	            F.prototype = null;

	            return subtype;
	        };
	    }())

	    /**
	     * CryptoJS namespace.
	     */
	    var C = {};

	    /**
	     * Library namespace.
	     */
	    var C_lib = C.lib = {};

	    /**
	     * Base object for prototypal inheritance.
	     */
	    var Base = C_lib.Base = (function () {


	        return {
	            /**
	             * Creates a new object that inherits from this object.
	             *
	             * @param {Object} overrides Properties to copy into the new object.
	             *
	             * @return {Object} The new object.
	             *
	             * @static
	             *
	             * @example
	             *
	             *     var MyType = CryptoJS.lib.Base.extend({
	             *         field: 'value',
	             *
	             *         method: function () {
	             *         }
	             *     });
	             */
	            extend: function (overrides) {
	                // Spawn
	                var subtype = create(this);

	                // Augment
	                if (overrides) {
	                    subtype.mixIn(overrides);
	                }

	                // Create default initializer
	                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {
	                    subtype.init = function () {
	                        subtype.$super.init.apply(this, arguments);
	                    };
	                }

	                // Initializer's prototype is the subtype object
	                subtype.init.prototype = subtype;

	                // Reference supertype
	                subtype.$super = this;

	                return subtype;
	            },

	            /**
	             * Extends this object and runs the init method.
	             * Arguments to create() will be passed to init().
	             *
	             * @return {Object} The new object.
	             *
	             * @static
	             *
	             * @example
	             *
	             *     var instance = MyType.create();
	             */
	            create: function () {
	                var instance = this.extend();
	                instance.init.apply(instance, arguments);

	                return instance;
	            },

	            /**
	             * Initializes a newly created object.
	             * Override this method to add some logic when your objects are created.
	             *
	             * @example
	             *
	             *     var MyType = CryptoJS.lib.Base.extend({
	             *         init: function () {
	             *             // ...
	             *         }
	             *     });
	             */
	            init: function () {
	            },

	            /**
	             * Copies properties into this object.
	             *
	             * @param {Object} properties The properties to mix in.
	             *
	             * @example
	             *
	             *     MyType.mixIn({
	             *         field: 'value'
	             *     });
	             */
	            mixIn: function (properties) {
	                for (var propertyName in properties) {
	                    if (properties.hasOwnProperty(propertyName)) {
	                        this[propertyName] = properties[propertyName];
	                    }
	                }

	                // IE won't copy toString using the loop above
	                if (properties.hasOwnProperty('toString')) {
	                    this.toString = properties.toString;
	                }
	            },

	            /**
	             * Creates a copy of this object.
	             *
	             * @return {Object} The clone.
	             *
	             * @example
	             *
	             *     var clone = instance.clone();
	             */
	            clone: function () {
	                return this.init.prototype.extend(this);
	            }
	        };
	    }());

	    /**
	     * An array of 32-bit words.
	     *
	     * @property {Array} words The array of 32-bit words.
	     * @property {number} sigBytes The number of significant bytes in this word array.
	     */
	    var WordArray = C_lib.WordArray = Base.extend({
	        /**
	         * Initializes a newly created word array.
	         *
	         * @param {Array} words (Optional) An array of 32-bit words.
	         * @param {number} sigBytes (Optional) The number of significant bytes in the words.
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.lib.WordArray.create();
	         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);
	         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);
	         */
	        init: function (words, sigBytes) {
	            words = this.words = words || [];

	            if (sigBytes != undefined) {
	                this.sigBytes = sigBytes;
	            } else {
	                this.sigBytes = words.length * 4;
	            }
	        },

	        /**
	         * Converts this word array to a string.
	         *
	         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex
	         *
	         * @return {string} The stringified word array.
	         *
	         * @example
	         *
	         *     var string = wordArray + '';
	         *     var string = wordArray.toString();
	         *     var string = wordArray.toString(CryptoJS.enc.Utf8);
	         */
	        toString: function (encoder) {
	            return (encoder || Hex).stringify(this);
	        },

	        /**
	         * Concatenates a word array to this word array.
	         *
	         * @param {WordArray} wordArray The word array to append.
	         *
	         * @return {WordArray} This word array.
	         *
	         * @example
	         *
	         *     wordArray1.concat(wordArray2);
	         */
	        concat: function (wordArray) {
	            // Shortcuts
	            var thisWords = this.words;
	            var thatWords = wordArray.words;
	            var thisSigBytes = this.sigBytes;
	            var thatSigBytes = wordArray.sigBytes;

	            // Clamp excess bits
	            this.clamp();

	            // Concat
	            if (thisSigBytes % 4) {
	                // Copy one byte at a time
	                for (var i = 0; i < thatSigBytes; i++) {
	                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;
	                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);
	                }
	            } else {
	                // Copy one word at a time
	                for (var i = 0; i < thatSigBytes; i += 4) {
	                    thisWords[(thisSigBytes + i) >>> 2] = thatWords[i >>> 2];
	                }
	            }
	            this.sigBytes += thatSigBytes;

	            // Chainable
	            return this;
	        },

	        /**
	         * Removes insignificant bits.
	         *
	         * @example
	         *
	         *     wordArray.clamp();
	         */
	        clamp: function () {
	            // Shortcuts
	            var words = this.words;
	            var sigBytes = this.sigBytes;

	            // Clamp
	            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);
	            words.length = Math.ceil(sigBytes / 4);
	        },

	        /**
	         * Creates a copy of this word array.
	         *
	         * @return {WordArray} The clone.
	         *
	         * @example
	         *
	         *     var clone = wordArray.clone();
	         */
	        clone: function () {
	            var clone = Base.clone.call(this);
	            clone.words = this.words.slice(0);

	            return clone;
	        },

	        /**
	         * Creates a word array filled with random bytes.
	         *
	         * @param {number} nBytes The number of random bytes to generate.
	         *
	         * @return {WordArray} The random word array.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.lib.WordArray.random(16);
	         */
	        random: function (nBytes) {
	            var words = [];

	            var r = (function (m_w) {
	                var m_w = m_w;
	                var m_z = 0x3ade68b1;
	                var mask = 0xffffffff;

	                return function () {
	                    m_z = (0x9069 * (m_z & 0xFFFF) + (m_z >> 0x10)) & mask;
	                    m_w = (0x4650 * (m_w & 0xFFFF) + (m_w >> 0x10)) & mask;
	                    var result = ((m_z << 0x10) + m_w) & mask;
	                    result /= 0x100000000;
	                    result += 0.5;
	                    return result * (Math.random() > .5 ? 1 : -1);
	                }
	            });

	            for (var i = 0, rcache; i < nBytes; i += 4) {
	                var _r = r((rcache || Math.random()) * 0x100000000);

	                rcache = _r() * 0x3ade67b7;
	                words.push((_r() * 0x100000000) | 0);
	            }

	            return new WordArray.init(words, nBytes);
	        }
	    });

	    /**
	     * Encoder namespace.
	     */
	    var C_enc = C.enc = {};

	    /**
	     * Hex encoding strategy.
	     */
	    var Hex = C_enc.Hex = {
	        /**
	         * Converts a word array to a hex string.
	         *
	         * @param {WordArray} wordArray The word array.
	         *
	         * @return {string} The hex string.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);
	         */
	        stringify: function (wordArray) {
	            // Shortcuts
	            var words = wordArray.words;
	            var sigBytes = wordArray.sigBytes;

	            // Convert
	            var hexChars = [];
	            for (var i = 0; i < sigBytes; i++) {
	                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;
	                hexChars.push((bite >>> 4).toString(16));
	                hexChars.push((bite & 0x0f).toString(16));
	            }

	            return hexChars.join('');
	        },

	        /**
	         * Converts a hex string to a word array.
	         *
	         * @param {string} hexStr The hex string.
	         *
	         * @return {WordArray} The word array.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);
	         */
	        parse: function (hexStr) {
	            // Shortcut
	            var hexStrLength = hexStr.length;

	            // Convert
	            var words = [];
	            for (var i = 0; i < hexStrLength; i += 2) {
	                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);
	            }

	            return new WordArray.init(words, hexStrLength / 2);
	        }
	    };

	    /**
	     * Latin1 encoding strategy.
	     */
	    var Latin1 = C_enc.Latin1 = {
	        /**
	         * Converts a word array to a Latin1 string.
	         *
	         * @param {WordArray} wordArray The word array.
	         *
	         * @return {string} The Latin1 string.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);
	         */
	        stringify: function (wordArray) {
	            // Shortcuts
	            var words = wordArray.words;
	            var sigBytes = wordArray.sigBytes;

	            // Convert
	            var latin1Chars = [];
	            for (var i = 0; i < sigBytes; i++) {
	                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;
	                latin1Chars.push(String.fromCharCode(bite));
	            }

	            return latin1Chars.join('');
	        },

	        /**
	         * Converts a Latin1 string to a word array.
	         *
	         * @param {string} latin1Str The Latin1 string.
	         *
	         * @return {WordArray} The word array.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);
	         */
	        parse: function (latin1Str) {
	            // Shortcut
	            var latin1StrLength = latin1Str.length;

	            // Convert
	            var words = [];
	            for (var i = 0; i < latin1StrLength; i++) {
	                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);
	            }

	            return new WordArray.init(words, latin1StrLength);
	        }
	    };

	    /**
	     * UTF-8 encoding strategy.
	     */
	    var Utf8 = C_enc.Utf8 = {
	        /**
	         * Converts a word array to a UTF-8 string.
	         *
	         * @param {WordArray} wordArray The word array.
	         *
	         * @return {string} The UTF-8 string.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);
	         */
	        stringify: function (wordArray) {
	            try {
	                return decodeURIComponent(escape(Latin1.stringify(wordArray)));
	            } catch (e) {
	                throw new Error('Malformed UTF-8 data');
	            }
	        },

	        /**
	         * Converts a UTF-8 string to a word array.
	         *
	         * @param {string} utf8Str The UTF-8 string.
	         *
	         * @return {WordArray} The word array.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);
	         */
	        parse: function (utf8Str) {
	            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));
	        }
	    };

	    /**
	     * Abstract buffered block algorithm template.
	     *
	     * The property blockSize must be implemented in a concrete subtype.
	     *
	     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0
	     */
	    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({
	        /**
	         * Resets this block algorithm's data buffer to its initial state.
	         *
	         * @example
	         *
	         *     bufferedBlockAlgorithm.reset();
	         */
	        reset: function () {
	            // Initial values
	            this._data = new WordArray.init();
	            this._nDataBytes = 0;
	        },

	        /**
	         * Adds new data to this block algorithm's buffer.
	         *
	         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.
	         *
	         * @example
	         *
	         *     bufferedBlockAlgorithm._append('data');
	         *     bufferedBlockAlgorithm._append(wordArray);
	         */
	        _append: function (data) {
	            // Convert string to WordArray, else assume WordArray already
	            if (typeof data == 'string') {
	                data = Utf8.parse(data);
	            }

	            // Append
	            this._data.concat(data);
	            this._nDataBytes += data.sigBytes;
	        },

	        /**
	         * Processes available data blocks.
	         *
	         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.
	         *
	         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.
	         *
	         * @return {WordArray} The processed data.
	         *
	         * @example
	         *
	         *     var processedData = bufferedBlockAlgorithm._process();
	         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');
	         */
	        _process: function (doFlush) {
	            // Shortcuts
	            var data = this._data;
	            var dataWords = data.words;
	            var dataSigBytes = data.sigBytes;
	            var blockSize = this.blockSize;
	            var blockSizeBytes = blockSize * 4;

	            // Count blocks ready
	            var nBlocksReady = dataSigBytes / blockSizeBytes;
	            if (doFlush) {
	                // Round up to include partial blocks
	                nBlocksReady = Math.ceil(nBlocksReady);
	            } else {
	                // Round down to include only full blocks,
	                // less the number of blocks that must remain in the buffer
	                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);
	            }

	            // Count words ready
	            var nWordsReady = nBlocksReady * blockSize;

	            // Count bytes ready
	            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);

	            // Process blocks
	            if (nWordsReady) {
	                for (var offset = 0; offset < nWordsReady; offset += blockSize) {
	                    // Perform concrete-algorithm logic
	                    this._doProcessBlock(dataWords, offset);
	                }

	                // Remove processed words
	                var processedWords = dataWords.splice(0, nWordsReady);
	                data.sigBytes -= nBytesReady;
	            }

	            // Return processed words
	            return new WordArray.init(processedWords, nBytesReady);
	        },

	        /**
	         * Creates a copy of this object.
	         *
	         * @return {Object} The clone.
	         *
	         * @example
	         *
	         *     var clone = bufferedBlockAlgorithm.clone();
	         */
	        clone: function () {
	            var clone = Base.clone.call(this);
	            clone._data = this._data.clone();

	            return clone;
	        },

	        _minBufferSize: 0
	    });

	    /**
	     * Abstract hasher template.
	     *
	     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)
	     */
	    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({
	        /**
	         * Configuration options.
	         */
	        cfg: Base.extend(),

	        /**
	         * Initializes a newly created hasher.
	         *
	         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.
	         *
	         * @example
	         *
	         *     var hasher = CryptoJS.algo.SHA256.create();
	         */
	        init: function (cfg) {
	            // Apply config defaults
	            this.cfg = this.cfg.extend(cfg);

	            // Set initial values
	            this.reset();
	        },

	        /**
	         * Resets this hasher to its initial state.
	         *
	         * @example
	         *
	         *     hasher.reset();
	         */
	        reset: function () {
	            // Reset data buffer
	            BufferedBlockAlgorithm.reset.call(this);

	            // Perform concrete-hasher logic
	            this._doReset();
	        },

	        /**
	         * Updates this hasher with a message.
	         *
	         * @param {WordArray|string} messageUpdate The message to append.
	         *
	         * @return {Hasher} This hasher.
	         *
	         * @example
	         *
	         *     hasher.update('message');
	         *     hasher.update(wordArray);
	         */
	        update: function (messageUpdate) {
	            // Append
	            this._append(messageUpdate);

	            // Update the hash
	            this._process();

	            // Chainable
	            return this;
	        },

	        /**
	         * Finalizes the hash computation.
	         * Note that the finalize operation is effectively a destructive, read-once operation.
	         *
	         * @param {WordArray|string} messageUpdate (Optional) A final message update.
	         *
	         * @return {WordArray} The hash.
	         *
	         * @example
	         *
	         *     var hash = hasher.finalize();
	         *     var hash = hasher.finalize('message');
	         *     var hash = hasher.finalize(wordArray);
	         */
	        finalize: function (messageUpdate) {
	            // Final message update
	            if (messageUpdate) {
	                this._append(messageUpdate);
	            }

	            // Perform concrete-hasher logic
	            var hash = this._doFinalize();

	            return hash;
	        },

	        blockSize: 512/32,

	        /**
	         * Creates a shortcut function to a hasher's object interface.
	         *
	         * @param {Hasher} hasher The hasher to create a helper for.
	         *
	         * @return {Function} The shortcut function.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);
	         */
	        _createHelper: function (hasher) {
	            return function (message, cfg) {
	                return new hasher.init(cfg).finalize(message);
	            };
	        },

	        /**
	         * Creates a shortcut function to the HMAC's object interface.
	         *
	         * @param {Hasher} hasher The hasher to use in this HMAC helper.
	         *
	         * @return {Function} The shortcut function.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);
	         */
	        _createHmacHelper: function (hasher) {
	            return function (message, key) {
	                return new C_algo.HMAC.init(hasher, key).finalize(message);
	            };
	        }
	    });

	    /**
	     * Algorithm namespace.
	     */
	    var C_algo = C.algo = {};

	    return C;
	}(Math));


	return CryptoJS;

}));
},{}],2:[function(require,module,exports){
;(function (root, factory) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"));
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define(["./core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function () {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var WordArray = C_lib.WordArray;
	    var C_enc = C.enc;

	    /**
	     * Base64 encoding strategy.
	     */
	    var Base64 = C_enc.Base64 = {
	        /**
	         * Converts a word array to a Base64 string.
	         *
	         * @param {WordArray} wordArray The word array.
	         *
	         * @return {string} The Base64 string.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var base64String = CryptoJS.enc.Base64.stringify(wordArray);
	         */
	        stringify: function (wordArray) {
	            // Shortcuts
	            var words = wordArray.words;
	            var sigBytes = wordArray.sigBytes;
	            var map = this._map;

	            // Clamp excess bits
	            wordArray.clamp();

	            // Convert
	            var base64Chars = [];
	            for (var i = 0; i < sigBytes; i += 3) {
	                var byte1 = (words[i >>> 2]       >>> (24 - (i % 4) * 8))       & 0xff;
	                var byte2 = (words[(i + 1) >>> 2] >>> (24 - ((i + 1) % 4) * 8)) & 0xff;
	                var byte3 = (words[(i + 2) >>> 2] >>> (24 - ((i + 2) % 4) * 8)) & 0xff;

	                var triplet = (byte1 << 16) | (byte2 << 8) | byte3;

	                for (var j = 0; (j < 4) && (i + j * 0.75 < sigBytes); j++) {
	                    base64Chars.push(map.charAt((triplet >>> (6 * (3 - j))) & 0x3f));
	                }
	            }

	            // Add padding
	            var paddingChar = map.charAt(64);
	            if (paddingChar) {
	                while (base64Chars.length % 4) {
	                    base64Chars.push(paddingChar);
	                }
	            }

	            return base64Chars.join('');
	        },

	        /**
	         * Converts a Base64 string to a word array.
	         *
	         * @param {string} base64Str The Base64 string.
	         *
	         * @return {WordArray} The word array.
	         *
	         * @static
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.enc.Base64.parse(base64String);
	         */
	        parse: function (base64Str) {
	            // Shortcuts
	            var base64StrLength = base64Str.length;
	            var map = this._map;
	            var reverseMap = this._reverseMap;

	            if (!reverseMap) {
	                    reverseMap = this._reverseMap = [];
	                    for (var j = 0; j < map.length; j++) {
	                        reverseMap[map.charCodeAt(j)] = j;
	                    }
	            }

	            // Ignore padding
	            var paddingChar = map.charAt(64);
	            if (paddingChar) {
	                var paddingIndex = base64Str.indexOf(paddingChar);
	                if (paddingIndex !== -1) {
	                    base64StrLength = paddingIndex;
	                }
	            }

	            // Convert
	            return parseLoop(base64Str, base64StrLength, reverseMap);

	        },

	        _map: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='
	    };

	    function parseLoop(base64Str, base64StrLength, reverseMap) {
	      var words = [];
	      var nBytes = 0;
	      for (var i = 0; i < base64StrLength; i++) {
	          if (i % 4) {
	              var bits1 = reverseMap[base64Str.charCodeAt(i - 1)] << ((i % 4) * 2);
	              var bits2 = reverseMap[base64Str.charCodeAt(i)] >>> (6 - (i % 4) * 2);
	              words[nBytes >>> 2] |= (bits1 | bits2) << (24 - (nBytes % 4) * 8);
	              nBytes++;
	          }
	      }
	      return WordArray.create(words, nBytes);
	    }
	}());


	return CryptoJS.enc.Base64;

}));
},{"./core":1}],3:[function(require,module,exports){
;(function (root, factory) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"));
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define(["./core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function () {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var WordArray = C_lib.WordArray;
	    var Hasher = C_lib.Hasher;
	    var C_algo = C.algo;

	    // Reusable object
	    var W = [];

	    /**
	     * SHA-1 hash algorithm.
	     */
	    var SHA1 = C_algo.SHA1 = Hasher.extend({
	        _doReset: function () {
	            this._hash = new WordArray.init([
	                0x67452301, 0xefcdab89,
	                0x98badcfe, 0x10325476,
	                0xc3d2e1f0
	            ]);
	        },

	        _doProcessBlock: function (M, offset) {
	            // Shortcut
	            var H = this._hash.words;

	            // Working variables
	            var a = H[0];
	            var b = H[1];
	            var c = H[2];
	            var d = H[3];
	            var e = H[4];

	            // Computation
	            for (var i = 0; i < 80; i++) {
	                if (i < 16) {
	                    W[i] = M[offset + i] | 0;
	                } else {
	                    var n = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];
	                    W[i] = (n << 1) | (n >>> 31);
	                }

	                var t = ((a << 5) | (a >>> 27)) + e + W[i];
	                if (i < 20) {
	                    t += ((b & c) | (~b & d)) + 0x5a827999;
	                } else if (i < 40) {
	                    t += (b ^ c ^ d) + 0x6ed9eba1;
	                } else if (i < 60) {
	                    t += ((b & c) | (b & d) | (c & d)) - 0x70e44324;
	                } else /* if (i < 80) */ {
	                    t += (b ^ c ^ d) - 0x359d3e2a;
	                }

	                e = d;
	                d = c;
	                c = (b << 30) | (b >>> 2);
	                b = a;
	                a = t;
	            }

	            // Intermediate hash value
	            H[0] = (H[0] + a) | 0;
	            H[1] = (H[1] + b) | 0;
	            H[2] = (H[2] + c) | 0;
	            H[3] = (H[3] + d) | 0;
	            H[4] = (H[4] + e) | 0;
	        },

	        _doFinalize: function () {
	            // Shortcuts
	            var data = this._data;
	            var dataWords = data.words;

	            var nBitsTotal = this._nDataBytes * 8;
	            var nBitsLeft = data.sigBytes * 8;

	            // Add padding
	            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);
	            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);
	            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;
	            data.sigBytes = dataWords.length * 4;

	            // Hash final blocks
	            this._process();

	            // Return final computed hash
	            return this._hash;
	        },

	        clone: function () {
	            var clone = Hasher.clone.call(this);
	            clone._hash = this._hash.clone();

	            return clone;
	        }
	    });

	    /**
	     * Shortcut function to the hasher's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     *
	     * @return {WordArray} The hash.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hash = CryptoJS.SHA1('message');
	     *     var hash = CryptoJS.SHA1(wordArray);
	     */
	    C.SHA1 = Hasher._createHelper(SHA1);

	    /**
	     * Shortcut function to the HMAC's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     * @param {WordArray|string} key The secret key.
	     *
	     * @return {WordArray} The HMAC.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hmac = CryptoJS.HmacSHA1(message, key);
	     */
	    C.HmacSHA1 = Hasher._createHmacHelper(SHA1);
	}());


	return CryptoJS.SHA1;

}));
},{"./core":1}],4:[function(require,module,exports){
;(function (root, factory) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"));
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define(["./core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function (Math) {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var WordArray = C_lib.WordArray;
	    var Hasher = C_lib.Hasher;
	    var C_algo = C.algo;

	    // Initialization and round constants tables
	    var H = [];
	    var K = [];

	    // Compute constants
	    (function () {
	        function isPrime(n) {
	            var sqrtN = Math.sqrt(n);
	            for (var factor = 2; factor <= sqrtN; factor++) {
	                if (!(n % factor)) {
	                    return false;
	                }
	            }

	            return true;
	        }

	        function getFractionalBits(n) {
	            return ((n - (n | 0)) * 0x100000000) | 0;
	        }

	        var n = 2;
	        var nPrime = 0;
	        while (nPrime < 64) {
	            if (isPrime(n)) {
	                if (nPrime < 8) {
	                    H[nPrime] = getFractionalBits(Math.pow(n, 1 / 2));
	                }
	                K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3));

	                nPrime++;
	            }

	            n++;
	        }
	    }());

	    // Reusable object
	    var W = [];

	    /**
	     * SHA-256 hash algorithm.
	     */
	    var SHA256 = C_algo.SHA256 = Hasher.extend({
	        _doReset: function () {
	            this._hash = new WordArray.init(H.slice(0));
	        },

	        _doProcessBlock: function (M, offset) {
	            // Shortcut
	            var H = this._hash.words;

	            // Working variables
	            var a = H[0];
	            var b = H[1];
	            var c = H[2];
	            var d = H[3];
	            var e = H[4];
	            var f = H[5];
	            var g = H[6];
	            var h = H[7];

	            // Computation
	            for (var i = 0; i < 64; i++) {
	                if (i < 16) {
	                    W[i] = M[offset + i] | 0;
	                } else {
	                    var gamma0x = W[i - 15];
	                    var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^
	                                  ((gamma0x << 14) | (gamma0x >>> 18)) ^
	                                   (gamma0x >>> 3);

	                    var gamma1x = W[i - 2];
	                    var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^
	                                  ((gamma1x << 13) | (gamma1x >>> 19)) ^
	                                   (gamma1x >>> 10);

	                    W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];
	                }

	                var ch  = (e & f) ^ (~e & g);
	                var maj = (a & b) ^ (a & c) ^ (b & c);

	                var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));
	                var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));

	                var t1 = h + sigma1 + ch + K[i] + W[i];
	                var t2 = sigma0 + maj;

	                h = g;
	                g = f;
	                f = e;
	                e = (d + t1) | 0;
	                d = c;
	                c = b;
	                b = a;
	                a = (t1 + t2) | 0;
	            }

	            // Intermediate hash value
	            H[0] = (H[0] + a) | 0;
	            H[1] = (H[1] + b) | 0;
	            H[2] = (H[2] + c) | 0;
	            H[3] = (H[3] + d) | 0;
	            H[4] = (H[4] + e) | 0;
	            H[5] = (H[5] + f) | 0;
	            H[6] = (H[6] + g) | 0;
	            H[7] = (H[7] + h) | 0;
	        },

	        _doFinalize: function () {
	            // Shortcuts
	            var data = this._data;
	            var dataWords = data.words;

	            var nBitsTotal = this._nDataBytes * 8;
	            var nBitsLeft = data.sigBytes * 8;

	            // Add padding
	            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);
	            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);
	            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;
	            data.sigBytes = dataWords.length * 4;

	            // Hash final blocks
	            this._process();

	            // Return final computed hash
	            return this._hash;
	        },

	        clone: function () {
	            var clone = Hasher.clone.call(this);
	            clone._hash = this._hash.clone();

	            return clone;
	        }
	    });

	    /**
	     * Shortcut function to the hasher's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     *
	     * @return {WordArray} The hash.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hash = CryptoJS.SHA256('message');
	     *     var hash = CryptoJS.SHA256(wordArray);
	     */
	    C.SHA256 = Hasher._createHelper(SHA256);

	    /**
	     * Shortcut function to the HMAC's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     * @param {WordArray|string} key The secret key.
	     *
	     * @return {WordArray} The HMAC.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hmac = CryptoJS.HmacSHA256(message, key);
	     */
	    C.HmacSHA256 = Hasher._createHmacHelper(SHA256);
	}(Math));


	return CryptoJS.SHA256;

}));
},{"./core":1}],5:[function(require,module,exports){
;(function (root, factory, undef) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"), require("./x64-core"));
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define(["./core", "./x64-core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function () {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var Hasher = C_lib.Hasher;
	    var C_x64 = C.x64;
	    var X64Word = C_x64.Word;
	    var X64WordArray = C_x64.WordArray;
	    var C_algo = C.algo;

	    function X64Word_create() {
	        return X64Word.create.apply(X64Word, arguments);
	    }

	    // Constants
	    var K = [
	        X64Word_create(0x428a2f98, 0xd728ae22), X64Word_create(0x71374491, 0x23ef65cd),
	        X64Word_create(0xb5c0fbcf, 0xec4d3b2f), X64Word_create(0xe9b5dba5, 0x8189dbbc),
	        X64Word_create(0x3956c25b, 0xf348b538), X64Word_create(0x59f111f1, 0xb605d019),
	        X64Word_create(0x923f82a4, 0xaf194f9b), X64Word_create(0xab1c5ed5, 0xda6d8118),
	        X64Word_create(0xd807aa98, 0xa3030242), X64Word_create(0x12835b01, 0x45706fbe),
	        X64Word_create(0x243185be, 0x4ee4b28c), X64Word_create(0x550c7dc3, 0xd5ffb4e2),
	        X64Word_create(0x72be5d74, 0xf27b896f), X64Word_create(0x80deb1fe, 0x3b1696b1),
	        X64Word_create(0x9bdc06a7, 0x25c71235), X64Word_create(0xc19bf174, 0xcf692694),
	        X64Word_create(0xe49b69c1, 0x9ef14ad2), X64Word_create(0xefbe4786, 0x384f25e3),
	        X64Word_create(0x0fc19dc6, 0x8b8cd5b5), X64Word_create(0x240ca1cc, 0x77ac9c65),
	        X64Word_create(0x2de92c6f, 0x592b0275), X64Word_create(0x4a7484aa, 0x6ea6e483),
	        X64Word_create(0x5cb0a9dc, 0xbd41fbd4), X64Word_create(0x76f988da, 0x831153b5),
	        X64Word_create(0x983e5152, 0xee66dfab), X64Word_create(0xa831c66d, 0x2db43210),
	        X64Word_create(0xb00327c8, 0x98fb213f), X64Word_create(0xbf597fc7, 0xbeef0ee4),
	        X64Word_create(0xc6e00bf3, 0x3da88fc2), X64Word_create(0xd5a79147, 0x930aa725),
	        X64Word_create(0x06ca6351, 0xe003826f), X64Word_create(0x14292967, 0x0a0e6e70),
	        X64Word_create(0x27b70a85, 0x46d22ffc), X64Word_create(0x2e1b2138, 0x5c26c926),
	        X64Word_create(0x4d2c6dfc, 0x5ac42aed), X64Word_create(0x53380d13, 0x9d95b3df),
	        X64Word_create(0x650a7354, 0x8baf63de), X64Word_create(0x766a0abb, 0x3c77b2a8),
	        X64Word_create(0x81c2c92e, 0x47edaee6), X64Word_create(0x92722c85, 0x1482353b),
	        X64Word_create(0xa2bfe8a1, 0x4cf10364), X64Word_create(0xa81a664b, 0xbc423001),
	        X64Word_create(0xc24b8b70, 0xd0f89791), X64Word_create(0xc76c51a3, 0x0654be30),
	        X64Word_create(0xd192e819, 0xd6ef5218), X64Word_create(0xd6990624, 0x5565a910),
	        X64Word_create(0xf40e3585, 0x5771202a), X64Word_create(0x106aa070, 0x32bbd1b8),
	        X64Word_create(0x19a4c116, 0xb8d2d0c8), X64Word_create(0x1e376c08, 0x5141ab53),
	        X64Word_create(0x2748774c, 0xdf8eeb99), X64Word_create(0x34b0bcb5, 0xe19b48a8),
	        X64Word_create(0x391c0cb3, 0xc5c95a63), X64Word_create(0x4ed8aa4a, 0xe3418acb),
	        X64Word_create(0x5b9cca4f, 0x7763e373), X64Word_create(0x682e6ff3, 0xd6b2b8a3),
	        X64Word_create(0x748f82ee, 0x5defb2fc), X64Word_create(0x78a5636f, 0x43172f60),
	        X64Word_create(0x84c87814, 0xa1f0ab72), X64Word_create(0x8cc70208, 0x1a6439ec),
	        X64Word_create(0x90befffa, 0x23631e28), X64Word_create(0xa4506ceb, 0xde82bde9),
	        X64Word_create(0xbef9a3f7, 0xb2c67915), X64Word_create(0xc67178f2, 0xe372532b),
	        X64Word_create(0xca273ece, 0xea26619c), X64Word_create(0xd186b8c7, 0x21c0c207),
	        X64Word_create(0xeada7dd6, 0xcde0eb1e), X64Word_create(0xf57d4f7f, 0xee6ed178),
	        X64Word_create(0x06f067aa, 0x72176fba), X64Word_create(0x0a637dc5, 0xa2c898a6),
	        X64Word_create(0x113f9804, 0xbef90dae), X64Word_create(0x1b710b35, 0x131c471b),
	        X64Word_create(0x28db77f5, 0x23047d84), X64Word_create(0x32caab7b, 0x40c72493),
	        X64Word_create(0x3c9ebe0a, 0x15c9bebc), X64Word_create(0x431d67c4, 0x9c100d4c),
	        X64Word_create(0x4cc5d4be, 0xcb3e42b6), X64Word_create(0x597f299c, 0xfc657e2a),
	        X64Word_create(0x5fcb6fab, 0x3ad6faec), X64Word_create(0x6c44198c, 0x4a475817)
	    ];

	    // Reusable objects
	    var W = [];
	    (function () {
	        for (var i = 0; i < 80; i++) {
	            W[i] = X64Word_create();
	        }
	    }());

	    /**
	     * SHA-512 hash algorithm.
	     */
	    var SHA512 = C_algo.SHA512 = Hasher.extend({
	        _doReset: function () {
	            this._hash = new X64WordArray.init([
	                new X64Word.init(0x6a09e667, 0xf3bcc908), new X64Word.init(0xbb67ae85, 0x84caa73b),
	                new X64Word.init(0x3c6ef372, 0xfe94f82b), new X64Word.init(0xa54ff53a, 0x5f1d36f1),
	                new X64Word.init(0x510e527f, 0xade682d1), new X64Word.init(0x9b05688c, 0x2b3e6c1f),
	                new X64Word.init(0x1f83d9ab, 0xfb41bd6b), new X64Word.init(0x5be0cd19, 0x137e2179)
	            ]);
	        },

	        _doProcessBlock: function (M, offset) {
	            // Shortcuts
	            var H = this._hash.words;

	            var H0 = H[0];
	            var H1 = H[1];
	            var H2 = H[2];
	            var H3 = H[3];
	            var H4 = H[4];
	            var H5 = H[5];
	            var H6 = H[6];
	            var H7 = H[7];

	            var H0h = H0.high;
	            var H0l = H0.low;
	            var H1h = H1.high;
	            var H1l = H1.low;
	            var H2h = H2.high;
	            var H2l = H2.low;
	            var H3h = H3.high;
	            var H3l = H3.low;
	            var H4h = H4.high;
	            var H4l = H4.low;
	            var H5h = H5.high;
	            var H5l = H5.low;
	            var H6h = H6.high;
	            var H6l = H6.low;
	            var H7h = H7.high;
	            var H7l = H7.low;

	            // Working variables
	            var ah = H0h;
	            var al = H0l;
	            var bh = H1h;
	            var bl = H1l;
	            var ch = H2h;
	            var cl = H2l;
	            var dh = H3h;
	            var dl = H3l;
	            var eh = H4h;
	            var el = H4l;
	            var fh = H5h;
	            var fl = H5l;
	            var gh = H6h;
	            var gl = H6l;
	            var hh = H7h;
	            var hl = H7l;

	            // Rounds
	            for (var i = 0; i < 80; i++) {
	                // Shortcut
	                var Wi = W[i];

	                // Extend message
	                if (i < 16) {
	                    var Wih = Wi.high = M[offset + i * 2]     | 0;
	                    var Wil = Wi.low  = M[offset + i * 2 + 1] | 0;
	                } else {
	                    // Gamma0
	                    var gamma0x  = W[i - 15];
	                    var gamma0xh = gamma0x.high;
	                    var gamma0xl = gamma0x.low;
	                    var gamma0h  = ((gamma0xh >>> 1) | (gamma0xl << 31)) ^ ((gamma0xh >>> 8) | (gamma0xl << 24)) ^ (gamma0xh >>> 7);
	                    var gamma0l  = ((gamma0xl >>> 1) | (gamma0xh << 31)) ^ ((gamma0xl >>> 8) | (gamma0xh << 24)) ^ ((gamma0xl >>> 7) | (gamma0xh << 25));

	                    // Gamma1
	                    var gamma1x  = W[i - 2];
	                    var gamma1xh = gamma1x.high;
	                    var gamma1xl = gamma1x.low;
	                    var gamma1h  = ((gamma1xh >>> 19) | (gamma1xl << 13)) ^ ((gamma1xh << 3) | (gamma1xl >>> 29)) ^ (gamma1xh >>> 6);
	                    var gamma1l  = ((gamma1xl >>> 19) | (gamma1xh << 13)) ^ ((gamma1xl << 3) | (gamma1xh >>> 29)) ^ ((gamma1xl >>> 6) | (gamma1xh << 26));

	                    // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]
	                    var Wi7  = W[i - 7];
	                    var Wi7h = Wi7.high;
	                    var Wi7l = Wi7.low;

	                    var Wi16  = W[i - 16];
	                    var Wi16h = Wi16.high;
	                    var Wi16l = Wi16.low;

	                    var Wil = gamma0l + Wi7l;
	                    var Wih = gamma0h + Wi7h + ((Wil >>> 0) < (gamma0l >>> 0) ? 1 : 0);
	                    var Wil = Wil + gamma1l;
	                    var Wih = Wih + gamma1h + ((Wil >>> 0) < (gamma1l >>> 0) ? 1 : 0);
	                    var Wil = Wil + Wi16l;
	                    var Wih = Wih + Wi16h + ((Wil >>> 0) < (Wi16l >>> 0) ? 1 : 0);

	                    Wi.high = Wih;
	                    Wi.low  = Wil;
	                }

	                var chh  = (eh & fh) ^ (~eh & gh);
	                var chl  = (el & fl) ^ (~el & gl);
	                var majh = (ah & bh) ^ (ah & ch) ^ (bh & ch);
	                var majl = (al & bl) ^ (al & cl) ^ (bl & cl);

	                var sigma0h = ((ah >>> 28) | (al << 4))  ^ ((ah << 30)  | (al >>> 2)) ^ ((ah << 25) | (al >>> 7));
	                var sigma0l = ((al >>> 28) | (ah << 4))  ^ ((al << 30)  | (ah >>> 2)) ^ ((al << 25) | (ah >>> 7));
	                var sigma1h = ((eh >>> 14) | (el << 18)) ^ ((eh >>> 18) | (el << 14)) ^ ((eh << 23) | (el >>> 9));
	                var sigma1l = ((el >>> 14) | (eh << 18)) ^ ((el >>> 18) | (eh << 14)) ^ ((el << 23) | (eh >>> 9));

	                // t1 = h + sigma1 + ch + K[i] + W[i]
	                var Ki  = K[i];
	                var Kih = Ki.high;
	                var Kil = Ki.low;

	                var t1l = hl + sigma1l;
	                var t1h = hh + sigma1h + ((t1l >>> 0) < (hl >>> 0) ? 1 : 0);
	                var t1l = t1l + chl;
	                var t1h = t1h + chh + ((t1l >>> 0) < (chl >>> 0) ? 1 : 0);
	                var t1l = t1l + Kil;
	                var t1h = t1h + Kih + ((t1l >>> 0) < (Kil >>> 0) ? 1 : 0);
	                var t1l = t1l + Wil;
	                var t1h = t1h + Wih + ((t1l >>> 0) < (Wil >>> 0) ? 1 : 0);

	                // t2 = sigma0 + maj
	                var t2l = sigma0l + majl;
	                var t2h = sigma0h + majh + ((t2l >>> 0) < (sigma0l >>> 0) ? 1 : 0);

	                // Update working variables
	                hh = gh;
	                hl = gl;
	                gh = fh;
	                gl = fl;
	                fh = eh;
	                fl = el;
	                el = (dl + t1l) | 0;
	                eh = (dh + t1h + ((el >>> 0) < (dl >>> 0) ? 1 : 0)) | 0;
	                dh = ch;
	                dl = cl;
	                ch = bh;
	                cl = bl;
	                bh = ah;
	                bl = al;
	                al = (t1l + t2l) | 0;
	                ah = (t1h + t2h + ((al >>> 0) < (t1l >>> 0) ? 1 : 0)) | 0;
	            }

	            // Intermediate hash value
	            H0l = H0.low  = (H0l + al);
	            H0.high = (H0h + ah + ((H0l >>> 0) < (al >>> 0) ? 1 : 0));
	            H1l = H1.low  = (H1l + bl);
	            H1.high = (H1h + bh + ((H1l >>> 0) < (bl >>> 0) ? 1 : 0));
	            H2l = H2.low  = (H2l + cl);
	            H2.high = (H2h + ch + ((H2l >>> 0) < (cl >>> 0) ? 1 : 0));
	            H3l = H3.low  = (H3l + dl);
	            H3.high = (H3h + dh + ((H3l >>> 0) < (dl >>> 0) ? 1 : 0));
	            H4l = H4.low  = (H4l + el);
	            H4.high = (H4h + eh + ((H4l >>> 0) < (el >>> 0) ? 1 : 0));
	            H5l = H5.low  = (H5l + fl);
	            H5.high = (H5h + fh + ((H5l >>> 0) < (fl >>> 0) ? 1 : 0));
	            H6l = H6.low  = (H6l + gl);
	            H6.high = (H6h + gh + ((H6l >>> 0) < (gl >>> 0) ? 1 : 0));
	            H7l = H7.low  = (H7l + hl);
	            H7.high = (H7h + hh + ((H7l >>> 0) < (hl >>> 0) ? 1 : 0));
	        },

	        _doFinalize: function () {
	            // Shortcuts
	            var data = this._data;
	            var dataWords = data.words;

	            var nBitsTotal = this._nDataBytes * 8;
	            var nBitsLeft = data.sigBytes * 8;

	            // Add padding
	            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);
	            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 30] = Math.floor(nBitsTotal / 0x100000000);
	            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 31] = nBitsTotal;
	            data.sigBytes = dataWords.length * 4;

	            // Hash final blocks
	            this._process();

	            // Convert hash to 32-bit word array before returning
	            var hash = this._hash.toX32();

	            // Return final computed hash
	            return hash;
	        },

	        clone: function () {
	            var clone = Hasher.clone.call(this);
	            clone._hash = this._hash.clone();

	            return clone;
	        },

	        blockSize: 1024/32
	    });

	    /**
	     * Shortcut function to the hasher's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     *
	     * @return {WordArray} The hash.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hash = CryptoJS.SHA512('message');
	     *     var hash = CryptoJS.SHA512(wordArray);
	     */
	    C.SHA512 = Hasher._createHelper(SHA512);

	    /**
	     * Shortcut function to the HMAC's object interface.
	     *
	     * @param {WordArray|string} message The message to hash.
	     * @param {WordArray|string} key The secret key.
	     *
	     * @return {WordArray} The HMAC.
	     *
	     * @static
	     *
	     * @example
	     *
	     *     var hmac = CryptoJS.HmacSHA512(message, key);
	     */
	    C.HmacSHA512 = Hasher._createHmacHelper(SHA512);
	}());


	return CryptoJS.SHA512;

}));
},{"./core":1,"./x64-core":6}],6:[function(require,module,exports){
;(function (root, factory) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"));
	}
	else if (typeof define === "function" && define.amd) {
		// AMD
		define(["./core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function (undefined) {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var Base = C_lib.Base;
	    var X32WordArray = C_lib.WordArray;

	    /**
	     * x64 namespace.
	     */
	    var C_x64 = C.x64 = {};

	    /**
	     * A 64-bit word.
	     */
	    var X64Word = C_x64.Word = Base.extend({
	        /**
	         * Initializes a newly created 64-bit word.
	         *
	         * @param {number} high The high 32 bits.
	         * @param {number} low The low 32 bits.
	         *
	         * @example
	         *
	         *     var x64Word = CryptoJS.x64.Word.create(0x00010203, 0x04050607);
	         */
	        init: function (high, low) {
	            this.high = high;
	            this.low = low;
	        }

	        /**
	         * Bitwise NOTs this word.
	         *
	         * @return {X64Word} A new x64-Word object after negating.
	         *
	         * @example
	         *
	         *     var negated = x64Word.not();
	         */
	        // not: function () {
	            // var high = ~this.high;
	            // var low = ~this.low;

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Bitwise ANDs this word with the passed word.
	         *
	         * @param {X64Word} word The x64-Word to AND with this word.
	         *
	         * @return {X64Word} A new x64-Word object after ANDing.
	         *
	         * @example
	         *
	         *     var anded = x64Word.and(anotherX64Word);
	         */
	        // and: function (word) {
	            // var high = this.high & word.high;
	            // var low = this.low & word.low;

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Bitwise ORs this word with the passed word.
	         *
	         * @param {X64Word} word The x64-Word to OR with this word.
	         *
	         * @return {X64Word} A new x64-Word object after ORing.
	         *
	         * @example
	         *
	         *     var ored = x64Word.or(anotherX64Word);
	         */
	        // or: function (word) {
	            // var high = this.high | word.high;
	            // var low = this.low | word.low;

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Bitwise XORs this word with the passed word.
	         *
	         * @param {X64Word} word The x64-Word to XOR with this word.
	         *
	         * @return {X64Word} A new x64-Word object after XORing.
	         *
	         * @example
	         *
	         *     var xored = x64Word.xor(anotherX64Word);
	         */
	        // xor: function (word) {
	            // var high = this.high ^ word.high;
	            // var low = this.low ^ word.low;

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Shifts this word n bits to the left.
	         *
	         * @param {number} n The number of bits to shift.
	         *
	         * @return {X64Word} A new x64-Word object after shifting.
	         *
	         * @example
	         *
	         *     var shifted = x64Word.shiftL(25);
	         */
	        // shiftL: function (n) {
	            // if (n < 32) {
	                // var high = (this.high << n) | (this.low >>> (32 - n));
	                // var low = this.low << n;
	            // } else {
	                // var high = this.low << (n - 32);
	                // var low = 0;
	            // }

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Shifts this word n bits to the right.
	         *
	         * @param {number} n The number of bits to shift.
	         *
	         * @return {X64Word} A new x64-Word object after shifting.
	         *
	         * @example
	         *
	         *     var shifted = x64Word.shiftR(7);
	         */
	        // shiftR: function (n) {
	            // if (n < 32) {
	                // var low = (this.low >>> n) | (this.high << (32 - n));
	                // var high = this.high >>> n;
	            // } else {
	                // var low = this.high >>> (n - 32);
	                // var high = 0;
	            // }

	            // return X64Word.create(high, low);
	        // },

	        /**
	         * Rotates this word n bits to the left.
	         *
	         * @param {number} n The number of bits to rotate.
	         *
	         * @return {X64Word} A new x64-Word object after rotating.
	         *
	         * @example
	         *
	         *     var rotated = x64Word.rotL(25);
	         */
	        // rotL: function (n) {
	            // return this.shiftL(n).or(this.shiftR(64 - n));
	        // },

	        /**
	         * Rotates this word n bits to the right.
	         *
	         * @param {number} n The number of bits to rotate.
	         *
	         * @return {X64Word} A new x64-Word object after rotating.
	         *
	         * @example
	         *
	         *     var rotated = x64Word.rotR(7);
	         */
	        // rotR: function (n) {
	            // return this.shiftR(n).or(this.shiftL(64 - n));
	        // },

	        /**
	         * Adds this word with the passed word.
	         *
	         * @param {X64Word} word The x64-Word to add with this word.
	         *
	         * @return {X64Word} A new x64-Word object after adding.
	         *
	         * @example
	         *
	         *     var added = x64Word.add(anotherX64Word);
	         */
	        // add: function (word) {
	            // var low = (this.low + word.low) | 0;
	            // var carry = (low >>> 0) < (this.low >>> 0) ? 1 : 0;
	            // var high = (this.high + word.high + carry) | 0;

	            // return X64Word.create(high, low);
	        // }
	    });

	    /**
	     * An array of 64-bit words.
	     *
	     * @property {Array} words The array of CryptoJS.x64.Word objects.
	     * @property {number} sigBytes The number of significant bytes in this word array.
	     */
	    var X64WordArray = C_x64.WordArray = Base.extend({
	        /**
	         * Initializes a newly created word array.
	         *
	         * @param {Array} words (Optional) An array of CryptoJS.x64.Word objects.
	         * @param {number} sigBytes (Optional) The number of significant bytes in the words.
	         *
	         * @example
	         *
	         *     var wordArray = CryptoJS.x64.WordArray.create();
	         *
	         *     var wordArray = CryptoJS.x64.WordArray.create([
	         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),
	         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)
	         *     ]);
	         *
	         *     var wordArray = CryptoJS.x64.WordArray.create([
	         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),
	         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)
	         *     ], 10);
	         */
	        init: function (words, sigBytes) {
	            words = this.words = words || [];

	            if (sigBytes != undefined) {
	                this.sigBytes = sigBytes;
	            } else {
	                this.sigBytes = words.length * 8;
	            }
	        },

	        /**
	         * Converts this 64-bit word array to a 32-bit word array.
	         *
	         * @return {CryptoJS.lib.WordArray} This word array's data as a 32-bit word array.
	         *
	         * @example
	         *
	         *     var x32WordArray = x64WordArray.toX32();
	         */
	        toX32: function () {
	            // Shortcuts
	            var x64Words = this.words;
	            var x64WordsLength = x64Words.length;

	            // Convert
	            var x32Words = [];
	            for (var i = 0; i < x64WordsLength; i++) {
	                var x64Word = x64Words[i];
	                x32Words.push(x64Word.high);
	                x32Words.push(x64Word.low);
	            }

	            return X32WordArray.create(x32Words, this.sigBytes);
	        },

	        /**
	         * Creates a copy of this word array.
	         *
	         * @return {X64WordArray} The clone.
	         *
	         * @example
	         *
	         *     var clone = x64WordArray.clone();
	         */
	        clone: function () {
	            var clone = Base.clone.call(this);

	            // Clone "words" array
	            var words = clone.words = this.words.slice(0);

	            // Clone each X64Word object
	            var wordsLength = words.length;
	            for (var i = 0; i < wordsLength; i++) {
	                words[i] = words[i].clone();
	            }

	            return clone;
	        }
	    });
	}());


	return CryptoJS;

}));
},{"./core":1}],7:[function(require,module,exports){
'use strict'

var mergeDescriptors = require('merge-descriptors')
var isObject = require('is-object')
var hasOwnProperty = Object.prototype.hasOwnProperty

function fill (destination, source, merge) {
  if (destination && (isObject(source) || isFunction(source))) {
    merge(destination, source, false)
    if (isFunction(destination) && isFunction(source) && source.prototype) {
      merge(destination.prototype, source.prototype, false)
    }
  }
  return destination
}

exports = module.exports = function fillKeys (destination, source) {
  return fill(destination, source, mergeDescriptors)
}

exports.es3 = function fillKeysEs3 (destination, source) {
  return fill(destination, source, es3Merge)
}

function es3Merge (destination, source) {
  for (var key in source) {
    if (!hasOwnProperty.call(destination, key)) {
      destination[key] = source[key]
    }
  }
  return destination
}

function isFunction (value) {
  return typeof value === 'function'
}

},{"is-object":8,"merge-descriptors":9}],8:[function(require,module,exports){
"use strict";

module.exports = function isObject(x) {
	return typeof x === "object" && x !== null;
};

},{}],9:[function(require,module,exports){
/*!
 * merge-descriptors
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict'

/**
 * Module exports.
 * @public
 */

module.exports = merge

/**
 * Module variables.
 * @private
 */

var hasOwnProperty = Object.prototype.hasOwnProperty

/**
 * Merge the property descriptors of `src` into `dest`
 *
 * @param {object} dest Object to add descriptors to
 * @param {object} src Object to clone descriptors from
 * @param {boolean} [redefine=true] Redefine `dest` properties with `src` properties
 * @returns {object} Reference to dest
 * @public
 */

function merge(dest, src, redefine) {
  if (!dest) {
    throw new TypeError('argument dest is required')
  }

  if (!src) {
    throw new TypeError('argument src is required')
  }

  if (redefine === undefined) {
    // Default to true
    redefine = true
  }

  Object.getOwnPropertyNames(src).forEach(function forEachOwnPropertyName(name) {
    if (!redefine && hasOwnProperty.call(dest, name)) {
      // Skip desriptor
      return
    }

    // Copy descriptor
    var descriptor = Object.getOwnPropertyDescriptor(src, name)
    Object.defineProperty(dest, name, descriptor)
  })

  return dest
}

},{}],10:[function(require,module,exports){
'use strict'

module.exports = function createNotFoundError (path) {
  var err = new Error('Cannot find module \'' + path + '\'')
  err.code = 'MODULE_NOT_FOUND'
  return err
}

},{}],11:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],12:[function(require,module,exports){
'use strict';

var fillMissingKeys = require('fill-keys');
var moduleNotFoundError = require('module-not-found-error');

function ProxyquireifyError(msg) {
  this.name = 'ProxyquireifyError';
  Error.captureStackTrace(this, ProxyquireifyError);
  this.message = msg || 'An error occurred inside proxyquireify.';
}

function validateArguments(request, stubs) {
  var msg = (function getMessage() {
    if (!request)
      return 'Missing argument: "request". Need it to resolve desired module.';

    if (!stubs)
      return 'Missing argument: "stubs". If no stubbing is needed, use regular require instead.';

    if (typeof request != 'string')
      return 'Invalid argument: "request". Needs to be a requirable string that is the module to load.';

    if (typeof stubs != 'object')
      return 'Invalid argument: "stubs". Needs to be an object containing overrides e.g., {"path": { extname: function () { ... } } }.';
  })();

  if (msg) throw new ProxyquireifyError(msg);
}

var stubs;

function stub(stubs_) {
  stubs = stubs_;
  // This cache is used by the prelude as an alternative to the regular cache.
  // It is not read or written here, except to set it to an empty object when
  // adding stubs and to reset it to null when clearing stubs.
  module.exports._cache = {};
}

function reset() {
  stubs = undefined;
  module.exports._cache = null;
}

var proxyquire = module.exports = function (require_) {
  if (typeof require_ != 'function')
    throw new ProxyquireifyError(
        'It seems like you didn\'t initialize proxyquireify with the require in your test.\n'
      + 'Make sure to correct this, i.e.: "var proxyquire = require(\'proxyquireify\')(require);"'
    );

  reset();

  return function(request, stubs) {

    validateArguments(request, stubs);

    // set the stubs and require dependency
    // when stub require is invoked by the module under test it will find the stubs here
    stub(stubs);
    var dep = require_(request);
    reset();

    return dep;
  };
};

// Start with the default cache
proxyquire._cache = null;

proxyquire._proxy = function (require_, request) {
  function original() {
    return require_(request);
  }

  if (!stubs || !stubs.hasOwnProperty(request)) return original();

  var stub = stubs[request];

  if (stub === null) throw moduleNotFoundError(request)

  var stubWideNoCallThru = Boolean(stubs['@noCallThru']) && (stub == null || stub['@noCallThru'] !== false);
  var noCallThru = stubWideNoCallThru || (stub != null && Boolean(stub['@noCallThru']));
  return noCallThru ? stub : fillMissingKeys(stub, original());
};

if (require.cache) {
  // only used during build, so prevent browserify from including it
  var replacePreludePath = './lib/replace-prelude';
  var replacePrelude = require(replacePreludePath);
  proxyquire.browserify = replacePrelude.browserify;
  proxyquire.plugin = replacePrelude.plugin;
}

},{"fill-keys":7,"module-not-found-error":10}],13:[function(require,module,exports){
'use strict';

var has = Object.prototype.hasOwnProperty
  , undef;

/**
 * Decode a URI encoded string.
 *
 * @param {String} input The URI encoded string.
 * @returns {String|Null} The decoded string.
 * @api private
 */
function decode(input) {
  try {
    return decodeURIComponent(input.replace(/\+/g, ' '));
  } catch (e) {
    return null;
  }
}

/**
 * Attempts to encode a given input.
 *
 * @param {String} input The string that needs to be encoded.
 * @returns {String|Null} The encoded string.
 * @api private
 */
function encode(input) {
  try {
    return encodeURIComponent(input);
  } catch (e) {
    return null;
  }
}

/**
 * Simple query string parser.
 *
 * @param {String} query The query string that needs to be parsed.
 * @returns {Object}
 * @api public
 */
function querystring(query) {
  var parser = /([^=?&]+)=?([^&]*)/g
    , result = {}
    , part;

  while (part = parser.exec(query)) {
    var key = decode(part[1])
      , value = decode(part[2]);

    //
    // Prevent overriding of existing properties. This ensures that build-in
    // methods like `toString` or __proto__ are not overriden by malicious
    // querystrings.
    //
    // In the case if failed decoding, we want to omit the key/value pairs
    // from the result.
    //
    if (key === null || value === null || key in result) continue;
    result[key] = value;
  }

  return result;
}

/**
 * Transform a query string to an object.
 *
 * @param {Object} obj Object that should be transformed.
 * @param {String} prefix Optional prefix.
 * @returns {String}
 * @api public
 */
function querystringify(obj, prefix) {
  prefix = prefix || '';

  var pairs = []
    , value
    , key;

  //
  // Optionally prefix with a '?' if needed
  //
  if ('string' !== typeof prefix) prefix = '?';

  for (key in obj) {
    if (has.call(obj, key)) {
      value = obj[key];

      //
      // Edge cases where we actually want to encode the value to an empty
      // string instead of the stringified value.
      //
      if (!value && (value === null || value === undef || isNaN(value))) {
        value = '';
      }

      key = encodeURIComponent(key);
      value = encodeURIComponent(value);

      //
      // If we failed to encode the strings, we should bail out as we don't
      // want to add invalid strings to the query.
      //
      if (key === null || value === null) continue;
      pairs.push(key +'='+ value);
    }
  }

  return pairs.length ? prefix + pairs.join('&') : '';
}

//
// Expose the module.
//
exports.stringify = querystringify;
exports.parse = querystring;

},{}],14:[function(require,module,exports){
'use strict';

/**
 * Check if we're required to add a port number.
 *
 * @see https://url.spec.whatwg.org/#default-port
 * @param {Number|String} port Port number we need to check
 * @param {String} protocol Protocol we need to check against.
 * @returns {Boolean} Is it a default port for the given protocol
 * @api private
 */
module.exports = function required(port, protocol) {
  protocol = protocol.split(':')[0];
  port = +port;

  if (!port) return false;

  switch (protocol) {
    case 'http':
    case 'ws':
    return port !== 80;

    case 'https':
    case 'wss':
    return port !== 443;

    case 'ftp':
    return port !== 21;

    case 'gopher':
    return port !== 70;

    case 'file':
    return false;
  }

  return port !== 0;
};

},{}],15:[function(require,module,exports){
(function (setImmediate,clearImmediate){
var nextTick = require('process/browser.js').nextTick;
var apply = Function.prototype.apply;
var slice = Array.prototype.slice;
var immediateIds = {};
var nextImmediateId = 0;

// DOM APIs, for completeness

exports.setTimeout = function() {
  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
};
exports.setInterval = function() {
  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
};
exports.clearTimeout =
exports.clearInterval = function(timeout) { timeout.close(); };

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}
Timeout.prototype.unref = Timeout.prototype.ref = function() {};
Timeout.prototype.close = function() {
  this._clearFn.call(window, this._id);
};

// Does not start the time, just sets up the members needed.
exports.enroll = function(item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function(item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function(item) {
  clearTimeout(item._idleTimeoutId);

  var msecs = item._idleTimeout;
  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout)
        item._onTimeout();
    }, msecs);
  }
};

// That's not how node.js implements it but the exposed api is the same.
exports.setImmediate = typeof setImmediate === "function" ? setImmediate : function(fn) {
  var id = nextImmediateId++;
  var args = arguments.length < 2 ? false : slice.call(arguments, 1);

  immediateIds[id] = true;

  nextTick(function onNextTick() {
    if (immediateIds[id]) {
      // fn.call() is faster so we optimize for the common use-case
      // @see http://jsperf.com/call-apply-segu
      if (args) {
        fn.apply(null, args);
      } else {
        fn.call(null);
      }
      // Prevent ids from leaking
      exports.clearImmediate(id);
    }
  });

  return id;
};

exports.clearImmediate = typeof clearImmediate === "function" ? clearImmediate : function(id) {
  delete immediateIds[id];
};
}).call(this,require("timers").setImmediate,require("timers").clearImmediate)
},{"process/browser.js":11,"timers":15}],16:[function(require,module,exports){
(function (global){
'use strict';

var required = require('requires-port')
  , qs = require('querystringify')
  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\/\//
  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i
  , whitespace = '[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]'
  , left = new RegExp('^'+ whitespace +'+');

/**
 * Trim a given string.
 *
 * @param {String} str String to trim.
 * @public
 */
function trimLeft(str) {
  return (str ? str : '').toString().replace(left, '');
}

/**
 * These are the parse rules for the URL parser, it informs the parser
 * about:
 *
 * 0. The char it Needs to parse, if it's a string it should be done using
 *    indexOf, RegExp using exec and NaN means set as current value.
 * 1. The property we should set when parsing this value.
 * 2. Indication if it's backwards or forward parsing, when set as number it's
 *    the value of extra chars that should be split off.
 * 3. Inherit from location if non existing in the parser.
 * 4. `toLowerCase` the resulting value.
 */
var rules = [
  ['#', 'hash'],                        // Extract from the back.
  ['?', 'query'],                       // Extract from the back.
  function sanitize(address) {          // Sanitize what is left of the address
    return address.replace('\\', '/');
  },
  ['/', 'pathname'],                    // Extract from the back.
  ['@', 'auth', 1],                     // Extract from the front.
  [NaN, 'host', undefined, 1, 1],       // Set left over value.
  [/:(\d+)$/, 'port', undefined, 1],    // RegExp the back.
  [NaN, 'hostname', undefined, 1, 1]    // Set left over.
];

/**
 * These properties should not be copied or inherited from. This is only needed
 * for all non blob URL's as a blob URL does not include a hash, only the
 * origin.
 *
 * @type {Object}
 * @private
 */
var ignore = { hash: 1, query: 1 };

/**
 * The location object differs when your code is loaded through a normal page,
 * Worker or through a worker using a blob. And with the blobble begins the
 * trouble as the location object will contain the URL of the blob, not the
 * location of the page where our code is loaded in. The actual origin is
 * encoded in the `pathname` so we can thankfully generate a good "default"
 * location from it so we can generate proper relative URL's again.
 *
 * @param {Object|String} loc Optional default location object.
 * @returns {Object} lolcation object.
 * @public
 */
function lolcation(loc) {
  var globalVar;

  if (typeof window !== 'undefined') globalVar = window;
  else if (typeof global !== 'undefined') globalVar = global;
  else if (typeof self !== 'undefined') globalVar = self;
  else globalVar = {};

  var location = globalVar.location || {};
  loc = loc || location;

  var finaldestination = {}
    , type = typeof loc
    , key;

  if ('blob:' === loc.protocol) {
    finaldestination = new Url(unescape(loc.pathname), {});
  } else if ('string' === type) {
    finaldestination = new Url(loc, {});
    for (key in ignore) delete finaldestination[key];
  } else if ('object' === type) {
    for (key in loc) {
      if (key in ignore) continue;
      finaldestination[key] = loc[key];
    }

    if (finaldestination.slashes === undefined) {
      finaldestination.slashes = slashes.test(loc.href);
    }
  }

  return finaldestination;
}

/**
 * @typedef ProtocolExtract
 * @type Object
 * @property {String} protocol Protocol matched in the URL, in lowercase.
 * @property {Boolean} slashes `true` if protocol is followed by "//", else `false`.
 * @property {String} rest Rest of the URL that is not part of the protocol.
 */

/**
 * Extract protocol information from a URL with/without double slash ("//").
 *
 * @param {String} address URL we want to extract from.
 * @return {ProtocolExtract} Extracted information.
 * @private
 */
function extractProtocol(address) {
  address = trimLeft(address);
  var match = protocolre.exec(address);

  return {
    protocol: match[1] ? match[1].toLowerCase() : '',
    slashes: !!match[2],
    rest: match[3]
  };
}

/**
 * Resolve a relative URL pathname against a base URL pathname.
 *
 * @param {String} relative Pathname of the relative URL.
 * @param {String} base Pathname of the base URL.
 * @return {String} Resolved pathname.
 * @private
 */
function resolve(relative, base) {
  if (relative === '') return base;

  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))
    , i = path.length
    , last = path[i - 1]
    , unshift = false
    , up = 0;

  while (i--) {
    if (path[i] === '.') {
      path.splice(i, 1);
    } else if (path[i] === '..') {
      path.splice(i, 1);
      up++;
    } else if (up) {
      if (i === 0) unshift = true;
      path.splice(i, 1);
      up--;
    }
  }

  if (unshift) path.unshift('');
  if (last === '.' || last === '..') path.push('');

  return path.join('/');
}

/**
 * The actual URL instance. Instead of returning an object we've opted-in to
 * create an actual constructor as it's much more memory efficient and
 * faster and it pleases my OCD.
 *
 * It is worth noting that we should not use `URL` as class name to prevent
 * clashes with the global URL instance that got introduced in browsers.
 *
 * @constructor
 * @param {String} address URL we want to parse.
 * @param {Object|String} [location] Location defaults for relative paths.
 * @param {Boolean|Function} [parser] Parser for the query string.
 * @private
 */
function Url(address, location, parser) {
  address = trimLeft(address);

  if (!(this instanceof Url)) {
    return new Url(address, location, parser);
  }

  var relative, extracted, parse, instruction, index, key
    , instructions = rules.slice()
    , type = typeof location
    , url = this
    , i = 0;

  //
  // The following if statements allows this module two have compatibility with
  // 2 different API:
  //
  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments
  //    where the boolean indicates that the query string should also be parsed.
  //
  // 2. The `URL` interface of the browser which accepts a URL, object as
  //    arguments. The supplied object will be used as default values / fall-back
  //    for relative paths.
  //
  if ('object' !== type && 'string' !== type) {
    parser = location;
    location = null;
  }

  if (parser && 'function' !== typeof parser) parser = qs.parse;

  location = lolcation(location);

  //
  // Extract protocol information before running the instructions.
  //
  extracted = extractProtocol(address || '');
  relative = !extracted.protocol && !extracted.slashes;
  url.slashes = extracted.slashes || relative && location.slashes;
  url.protocol = extracted.protocol || location.protocol || '';
  address = extracted.rest;

  //
  // When the authority component is absent the URL starts with a path
  // component.
  //
  if (!extracted.slashes) instructions[3] = [/(.*)/, 'pathname'];

  for (; i < instructions.length; i++) {
    instruction = instructions[i];

    if (typeof instruction === 'function') {
      address = instruction(address);
      continue;
    }

    parse = instruction[0];
    key = instruction[1];

    if (parse !== parse) {
      url[key] = address;
    } else if ('string' === typeof parse) {
      if (~(index = address.indexOf(parse))) {
        if ('number' === typeof instruction[2]) {
          url[key] = address.slice(0, index);
          address = address.slice(index + instruction[2]);
        } else {
          url[key] = address.slice(index);
          address = address.slice(0, index);
        }
      }
    } else if ((index = parse.exec(address))) {
      url[key] = index[1];
      address = address.slice(0, index.index);
    }

    url[key] = url[key] || (
      relative && instruction[3] ? location[key] || '' : ''
    );

    //
    // Hostname, host and protocol should be lowercased so they can be used to
    // create a proper `origin`.
    //
    if (instruction[4]) url[key] = url[key].toLowerCase();
  }

  //
  // Also parse the supplied query string in to an object. If we're supplied
  // with a custom parser as function use that instead of the default build-in
  // parser.
  //
  if (parser) url.query = parser(url.query);

  //
  // If the URL is relative, resolve the pathname against the base URL.
  //
  if (
      relative
    && location.slashes
    && url.pathname.charAt(0) !== '/'
    && (url.pathname !== '' || location.pathname !== '')
  ) {
    url.pathname = resolve(url.pathname, location.pathname);
  }

  //
  // We should not add port numbers if they are already the default port number
  // for a given protocol. As the host also contains the port number we're going
  // override it with the hostname which contains no port number.
  //
  if (!required(url.port, url.protocol)) {
    url.host = url.hostname;
    url.port = '';
  }

  //
  // Parse down the `auth` for the username and password.
  //
  url.username = url.password = '';
  if (url.auth) {
    instruction = url.auth.split(':');
    url.username = instruction[0] || '';
    url.password = instruction[1] || '';
  }

  url.origin = url.protocol && url.host && url.protocol !== 'file:'
    ? url.protocol +'//'+ url.host
    : 'null';

  //
  // The href is just the compiled result.
  //
  url.href = url.toString();
}

/**
 * This is convenience method for changing properties in the URL instance to
 * insure that they all propagate correctly.
 *
 * @param {String} part          Property we need to adjust.
 * @param {Mixed} value          The newly assigned value.
 * @param {Boolean|Function} fn  When setting the query, it will be the function
 *                               used to parse the query.
 *                               When setting the protocol, double slash will be
 *                               removed from the final url if it is true.
 * @returns {URL} URL instance for chaining.
 * @public
 */
function set(part, value, fn) {
  var url = this;

  switch (part) {
    case 'query':
      if ('string' === typeof value && value.length) {
        value = (fn || qs.parse)(value);
      }

      url[part] = value;
      break;

    case 'port':
      url[part] = value;

      if (!required(value, url.protocol)) {
        url.host = url.hostname;
        url[part] = '';
      } else if (value) {
        url.host = url.hostname +':'+ value;
      }

      break;

    case 'hostname':
      url[part] = value;

      if (url.port) value += ':'+ url.port;
      url.host = value;
      break;

    case 'host':
      url[part] = value;

      if (/:\d+$/.test(value)) {
        value = value.split(':');
        url.port = value.pop();
        url.hostname = value.join(':');
      } else {
        url.hostname = value;
        url.port = '';
      }

      break;

    case 'protocol':
      url.protocol = value.toLowerCase();
      url.slashes = !fn;
      break;

    case 'pathname':
    case 'hash':
      if (value) {
        var char = part === 'pathname' ? '/' : '#';
        url[part] = value.charAt(0) !== char ? char + value : value;
      } else {
        url[part] = value;
      }
      break;

    default:
      url[part] = value;
  }

  for (var i = 0; i < rules.length; i++) {
    var ins = rules[i];

    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();
  }

  url.origin = url.protocol && url.host && url.protocol !== 'file:'
    ? url.protocol +'//'+ url.host
    : 'null';

  url.href = url.toString();

  return url;
}

/**
 * Transform the properties back in to a valid and full URL string.
 *
 * @param {Function} stringify Optional query stringify function.
 * @returns {String} Compiled version of the URL.
 * @public
 */
function toString(stringify) {
  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;

  var query
    , url = this
    , protocol = url.protocol;

  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';

  var result = protocol + (url.slashes ? '//' : '');

  if (url.username) {
    result += url.username;
    if (url.password) result += ':'+ url.password;
    result += '@';
  }

  result += url.host + url.pathname;

  query = 'object' === typeof url.query ? stringify(url.query) : url.query;
  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;

  if (url.hash) result += url.hash;

  return result;
}

Url.prototype = { set: set, toString: toString };

//
// Expose the URL parser and some additional properties that might be useful for
// others or testing.
//
Url.extractProtocol = extractProtocol;
Url.location = lolcation;
Url.trimLeft = trimLeft;
Url.qs = qs;

module.exports = Url;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"querystringify":13,"requires-port":14}],"/wrapper/pktf1/helpers/base-configs.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Utilities = require('./utilities');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var baseConfigs = {
    DfpAuto: {
        shortcuts: {
            gptLayer: 'Layers[0].configs',
            partners: 'Layers[4].configs.partners'
        },
        config: {
            DeviceTypeChecker: {
                method: 'USER_AGENT',
                configs: {}
            },
            htSlots: {
                htSlotDesktopA: {
                    id: 'htSlotDesktopAId',
                    divId: 'divIdA',
                    sizeMapping: {
                        '0x0': [[300, 250], [300, 600]]
                    },
                    deviceType: 'desktop',
                    type: 'BANNER'
                },
                htSlotDesktopB: {
                    id: 'htSlotDesktopBId',
                    divId: 'divIdB',
                    sizeMapping: {
                        '0x0': [[300, 250], [300, 600]]
                    },
                    deviceType: 'desktop',
                    type: 'BANNER'
                },
                htSlotMobileA: {
                    id: 'htSlotMobileAId',
                    divId: 'divIdA',
                    sizeMapping: {
                        '0x0': [[300, 250], [300, 600]]
                    },
                    deviceType: 'mobile',
                    type: 'BANNER'
                },
                htSlotMobileB: {
                    id: 'htSlotMobileBId',
                    divId: 'divIdB',
                    sizeMapping: {
                        '0x0': [[300, 250], [300, 600]]
                    },
                    deviceType: 'mobile',
                    type: 'BANNER'
                }
            },
            Services: {
                HeaderStatsService: {
                    siteId: '123456',
                    configId: '40832032590',
                    options: {
                        auctionCycle: true
                    }
                },
                EventsService: {},
                KeyValueService: {},
                RenderService: {},
                TimerService: {},
                ComplianceService: {
                    gdprAppliesDefault: false,
                    timeout: 0
                },
                PublisherSonarService: {}
            },
            Layers: [
                {
                    layerId: 'GptLayer',
                    configs: {
                        desktopGlobalTimeout: 100000,
                        mobileGlobalTimeout: 150000,
                        enableSingleRequest: false,
                        disableInitialLoad: false,
                        override: {
                            display: false,
                            refresh: false,
                            destroySlots: false,
                            enableSingleRequest: false,
                            disableInitialLoad: false
                        },
                        slotMapping: {
                            selectors: ['divId'],
                            filters: ['deviceType']
                        }
                    }
                },
                {
                    layerId: 'VideoInterfaceLayer',
                    configs: {
                        desktopVideoGlobalTimeout: 100000,
                        mobileVideoGlobalTimeout: 150000
                    }
                },
                {
                    layerId: 'MediationLayer',
                    configs: {
                        mediationLevel: 'NONE'
                    }

                },
                {
                    layerId: 'IdentityLayer',
                    configs: {
                        timeout: 0,
                        partners: {
                            AdserverOrgIp: {
                                enabled: false,
                                configs: {
                                    publisherId: 11111
                                }
                            }
                        }
                    }
                },
                {
                    layerId: 'PartnersLayer',
                    configs: {
                        bidTransformerTypes: {
                            video: {
                                floor: 0,
                                buckets: [
                                    {
                                        max: 200,
                                        step: 5
                                    },
                                    {
                                        max: 1000,
                                        step: 10
                                    },
                                    {
                                        max: 7000,
                                        step: 50
                                    }
                                ]
                            }
                        },
                        partners: {
                            DynamicPartnerLoader: {
                                enabled: true,
                                configs: {
                                    xSlots: {},
                                    mapping: {}
                                }
                            }
                        }
                    }
                }
            ]
        }
    },
    DfpManual: {},
    Universal: {},
    PostBid: {}
};

/**
 * Clones and returns a configuration object.
 *
 * @param  {base} base The config object to be cloned.
 *
 * @return {object} A cloned configuration object.
 */
function cloneConfig(base) {
    var configClone = Utilities.clonePlainObject(base.config);

    var out = {
        config: configClone
    };

    for (var shortcutName in base.shortcuts) {
        if (!base.shortcuts.hasOwnProperty(shortcutName)) {
            continue;
        }

        out[shortcutName] = Utilities.deepGet(
            configClone,
            base.shortcuts[shortcutName]
        );
    }

    return out;
}

fixture.setBase('pktf1/specs/wrapper-config'); // eslint-disable-line no-undef

/**
 * Clones and returns a named configuration object.
 *
 * @param  {string} configName The name of the configuration you want.
 *
 * @return {object}            A cloned configuration object.
 */
function getConfig(configName) {
    if (!baseConfigs.hasOwnProperty(configName)) {
        return null;
    }

    var base = baseConfigs[configName];

    return cloneConfig(base);
}

/**
 * Clones and returns a configuration object loaded from a file
 *
 * @param  {string} pathToFile The path of the file to be loaded.
 *
 * @return {object}            A cloned configuration object.
 */
function getConfigFromFixture(pathToFile) {
    var json = fixture.load(pathToFile); // eslint-disable-line no-undef

    return cloneConfig(json);
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    getConfig: getConfig,
    getConfigFromFixture: getConfigFromFixture
};

},{"./utilities":"/wrapper/pktf1/helpers/utilities.js"}],"/wrapper/pktf1/helpers/gpt-page-maker.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Utilities = require('./utilities');

// =============================================================================
// CONSTANTS ///////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var AD_UNIT_PATHS = {
    FRIENDLYFRAME_SIZE: '/62650033/pktf-ff-size',
    FRIENDLYFRAME_PRICE: '/62650033/pktf-ff-price',
    SAFEFRAME_SIZE: '/62650033/pktf-sf-size',
    SAFEFRAME_PRICE: '/77475840/pktf/sf-price',
    LEGACY_SIZE: '/62650033/pktf-ff-legacy-size'
};

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

function GptPageMaker(hostWindow, options) {
    var __window;
    var __readyPromise;
    var __gSlots;

    function unloadGpt() {
        __window.googletag.destroySlots();

        for (var divId in __gSlots) {
            if (!__gSlots.hasOwnProperty(divId)) {
                continue;
            }

            __gSlots[divId].div.parentNode.removeChild(__gSlots[divId].div);
        }

        __window.googletag = undefined;
    }

    function __loadGpt() {
        return new Promise(function (resolve) {
            // Setup window variables for GPT.
            __window.googletag = __window.googletag || {};
            __window.googletag.cmd = __window.googletag.cmd || [];

            // Push function to configure SRA/DIL and enable services as first
            // thing in the GPT command queue.
            __window.googletag.cmd.push(function () {
                if (options) {
                    if (options.disableInitialLoad) {
                        __window.googletag.pubads().disableInitialLoad();
                    }

                    if (options.enableSingleRequest) {
                        __window.googletag.pubads().enableSingleRequest();
                    }
                }

                __window.googletag.enableServices();

                resolve(__window.googletag);
            });

            // Create a new script tag pointing to the GPT library and append
            // it to the DOM.
            var script = __window.document.createElement('script');
            script.type = 'text/javascript';
            script.async = true;
            script.src = (__window.document.location.protocol === 'https:' ? 'https:' : 'http:')
            + '//www.googletagservices.com/tag/js/gpt.js';

            __window.document.head.appendChild(script);
        });
    }

    function getGpt() {
        return __window.googletag;
    }

    function getSlots() {
        return __window.googletag.pubads()
            .getSlots()
            .slice();
    }

    function getSlotsMap() {
        var map = {};

        var gSlots = getSlots();

        for (var i = 0; i < gSlots.length; i++) {
            map[gSlots[i].getSlotElementId()] = gSlots[i];
        }

        return map;
    }

    function addGSlot(configs) {
        // Create a div element for the g-slot.
        var gDiv = __window.document.createElement('div');
        gDiv.setAttribute('id', configs.divId);

        // Add the div element to the body.
        __window.document.body.appendChild(gDiv);

        // Create and register the g-slot.
        var gSlot = __window.googletag.defineSlot(
            configs.adUnitPath,
            configs.sizes,
            configs.divId
        );
        gSlot.addService(__window.googletag.pubads());

        __window.googletag.enableServices();

        __gSlots[configs.divId] = {
            div: gDiv,
            gSlot: gSlot
        };

        return gSlot;
    }

    function ready() {
        return __readyPromise;
    }

    function setPageLevelTargeting(key, value) {
        if (Utilities.getType(value) === 'string') {
            value = [value];
        }

        __window.googletag.pubads().setTargeting(key, value);
    }

    (function __constructor() {
        __window = hostWindow;
        __readyPromise = __loadGpt();
        __gSlots = {};
    })();

    return {
        unloadGpt: unloadGpt,
        getGpt: getGpt,
        getSlots: getSlots,
        getSlotsMap: getSlotsMap,
        addGSlot: addGSlot,
        ready: ready,
        setPageLevelTargeting: setPageLevelTargeting
    };
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

GptPageMaker.AD_UNIT_PATHS = AD_UNIT_PATHS;

module.exports = GptPageMaker;

},{"./utilities":"/wrapper/pktf1/helpers/utilities.js"}],"/wrapper/pktf1/helpers/hacks.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var SpaceCamp = require('space-camp.js');
var Utilities = require('./utilities');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

function resetSpaceCamp() {
    SpaceCamp = Utilities.mergeObjects(SpaceCamp, {
        services: {},
        htSlots: [],
        htSlotsMap: {},
        DeviceTypeChecker: {},
        initQueue: [],
        globalTimeout: null,
        instanceId: null
    });
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    resetSpaceCamp: resetSpaceCamp
};

},{"./utilities":"/wrapper/pktf1/helpers/utilities.js","space-camp.js":"/wrapper/src/space-camp.js"}],"/wrapper/pktf1/helpers/header-stats-auditor.js":[function(require,module,exports){
'use strict';

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

function parse(rawData) {
    rawData = JSON.parse(rawData);

    var parsedData = {
        htSlotStats: {}
    };

    for (var i = 0; i < rawData.sl.length; i++) {
        var htSlotStats = rawData.sl[i];

        if (!parsedData.htSlotStats.hasOwnProperty(htSlotStats.s)) {
            parsedData.htSlotStats[htSlotStats.s] = {};
        }

        for (var partnerName in htSlotStats.xslots) {
            if (!htSlotStats.xslots.hasOwnProperty(partnerName)) {
                continue;
            }

            if (!parsedData.htSlotStats[htSlotStats.s].hasOwnProperty(partnerName)) {
                parsedData.htSlotStats[htSlotStats.s][partnerName] = {
                    brq: 0,
                    brs: 0,
                    bp: 0,
                    bt: 0,
                    be: 0
                };
            }

            for (var eventName in htSlotStats.xslots[partnerName]) {
                if (!htSlotStats.xslots[partnerName].hasOwnProperty(eventName)) {
                    continue;
                }

                for (var eventType in htSlotStats.xslots[partnerName][eventName]) {
                    if (htSlotStats.xslots[partnerName][eventName].hasOwnProperty(eventType)
                    && parsedData.htSlotStats[htSlotStats.s][partnerName]
                        .hasOwnProperty(eventType)) {
                        parsedData.htSlotStats[htSlotStats.s][partnerName][eventType]++;
                    }
                }
            }
        }
    }

    return parsedData;
}

function isBalanced(rawData) {
    var htSlotStats = parse(rawData).htSlotStats;

    for (var htSlotId in htSlotStats) {
        if (!htSlotStats.hasOwnProperty(htSlotId)) {
            continue;
        }

        for (var partnerStatsId in htSlotStats[htSlotId]) {
            if (!htSlotStats[htSlotId].hasOwnProperty(partnerStatsId)) {
                continue;
            }

            var stat = htSlotStats[htSlotId][partnerStatsId];
            var balance = stat.brq
                - stat.brs
                - stat.bp
                - stat.bt
                - stat.be;

            if (balance !== 0) {
                return false;
            }
        }
    }

    return true;
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    parse: parse,
    isBalanced: isBalanced
};

},{}],"/wrapper/pktf1/helpers/identity-partner-factory-loader.js":[function(require,module,exports){
/* proxyquireify injected requires to make browserify include dependencies in the bundle */ /* istanbul ignore next */; (function __makeBrowserifyIncludeModule__() { require('identity-partner-factory.js');});'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Proxyquireify = require('proxyquireify')(require);

var StubLoader = require('./stub-loader');
var TestUtilities = require('./utilities.js');
var Utilities = require('utilities');

var Network = StubLoader.stub('network.js');
var Browser = StubLoader.stub('browser.js');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

/**
 * Factory constructor with mocked dependencies
 * This is useful when testing the factory itself
 * note that as space-camp.js is mocked, event based calls will not work (e.g. retrieve())
 */
var factory = Proxyquireify(
    'identity-partner-factory.js',
    StubLoader.load([
        'space-camp.js',
        'cache.js',
        'network.js'
    ])
);

/**
 * Returns a fresh instance of a mocked partner API object
 * This is useful when calling a partner module directly
 *
 * @return {object} a fresh API object of which properties can be overwritten
 */
function getMockApi() {
    // Tracks registered events so they can be triggered
    var registeredHandlers = {
        retrieve: [],
        result: []
    };

    return {
        Utilities: {
            /* Shared Pub-Kit utilities */
            buildUrl: Network.buildUrl,
            getPageUrl: Browser.getPageUrl,
            getProtocol: Browser.getProtocol,
            getReferrer: Browser.getReferrer,
            getTime: (new Date()).getTime(),
            getType: Utilities.getType,
            isArray: Utilities.isArray,
            isEmpty: Utilities.isEmpty,
            isFunction: Utilities.isFunction,
            isInteger: Utilities.isInteger,
            isNumeric: Utilities.isNumeric,
            isString: Utilities.isString,
            isObject: Utilities.isObject,
            isTopFrame: Browser.isTopFrame,
            isXhrSupported: Network.isXhrSupported,

            /* Custom identity utilties */
            ajax: Network.ajax,
            getIdentityResultFrom: function () {
                return null;
            },
            getPublisherSonarData: function () {
                return {};
            },
            getConsent: function () {
                return {
                    applies: false,
                    consentString: ''
                };
            }
        },

        /* Events */
        onRetrieve: function (cb) {
            registeredHandlers.retrieve.push(cb);
        },
        onResult: function (cb) {
            registeredHandlers.result.push(cb);
        },

        /* Data registers */
        registerMatch: function () {},
        registerPass: function () {},
        registerError: function () {},
        registerEbTargeting: function () {},

        /* Config object */
        configs: {},

        /* Used by tests */
        __triggerEvent: {
            retrieve: function () {
                registeredHandlers.retrieve.forEach(function (e) {
                    e();
                });
            },
            result: function () {
                registeredHandlers.result.forEach(function (e) {
                    e();
                });
            }
        }
    };
}

/**
 * Returns a fresh instance of a base mocked partner module
 * This is useful when constructing a mock factory instance directly
 *
 * @param {object} customizations modifications to the base module
 * @return {object} a fresh partner module of which properties can be overwritten
 */
function getMockModule(customizations) {
    return TestUtilities.deepMergeObjects({
        type: 'identity',
        api: '1',
        main: function () {},
        profile: {
            partnerId: 'MockModuleIp',
            statsId: 'MOCK',
            version: '1.0.0',
            source: 'mock.module.ip',
            cacheExpiry: {
                match: 1000,
                pass: 2000,
                error: 3000
            },
            targetingKeys: {
                exchangeBidding: 'mock_module_tgt'
            }
        }
    }, customizations);
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    factory: factory,
    getMockApi: getMockApi,
    getMockModule: getMockModule
};

},{"./stub-loader":"/wrapper/pktf1/helpers/stub-loader.js","./utilities.js":"/wrapper/pktf1/helpers/utilities.js","identity-partner-factory.js":"/wrapper/src/modules/identity-layer/identity-partner-factory.js","proxyquireify":12,"utilities":"/wrapper/src/libs/utilities.js"}],"/wrapper/pktf1/helpers/mock-data.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var XHRFilter = require('./xhr-filter');

var UrlParse = require('url-parse');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var responseTimes = {
    minTimeout: {
        prt: [
            {
                sId: 'TT6px1Qs',
                rt: {
                    IndexExchangeHtb: [100],
                    PubMaticHtb: [50]
                }
            }
        ]
    },
    maxTimeout: {
        prt: [
            {
                sId: 'TT6px1Qs',
                rt: {
                    IndexExchangeHtb: [6000],
                    PubMaticHtb: [50]
                }
            }
        ]
    },
    normalTimeout: {
        prt: [
            {
                sId: '1',
                rt: {
                    IndexExchangeHtb: [1200],
                    PubMaticHtb: [50]
                }
            },
            {
                sId: '2',
                rt: {
                    IndexExchangeHtb: [500]
                }
            },
            {
                sId: '3',
                rt: {
                    IndexExchangeHtb: [500, 1999],
                    PubMaticHtb: [200]
                }
            },
            {
                sId: '4',
                rt: {
                    IndexExchangeHtb: [250]
                }
            },
            {
                sId: '5',
                rt: {
                    IndexExchangeHtb: [1800]
                }
            }
        ]
    }
};

function getOpenMarketBidResponse(r, options) {
    var creative = 'please sir, can I have an ad please?';
    if (options) {
        if (options.hasOwnProperty('creative')) {
            creative = options.creative;
        }
    }

    return {
        cur: 'USD',
        id: r.id,
        seatbid: [
            {
                bid: [
                    {
                        adid: '1487603',
                        adm: creative,
                        adomain: ['www.indexexchange.com'],
                        ext: {
                            advbrand: 'IX',
                            advbrandid: '25661',
                            pricelevel: '200'
                        },
                        id: 567841330,
                        impid: '1',
                        price: '200'
                    },
                    {
                        adid: '1487603',
                        adm: creative,
                        adomain: ['www.indexexchange.com'],
                        ext: {
                            advbrand: 'IX',
                            advbrandid: '25661',
                            pricelevel: '100'
                        },
                        id: 567841330,
                        impid: '2',
                        price: '100'
                    },
                    {
                        adid: '3464673',
                        adm: creative,
                        adomain: ['www.indexexchange.com'],
                        ext: {
                            advbrand: 'IX',
                            advbrandid: '25661',
                            pricelevel: '100'
                        },
                        id: 567841330,
                        impid: '3',
                        price: '100'
                    },
                    {
                        adid: '1487603',
                        adm: creative,
                        adomain: ['www.indexexchange.com'],
                        ext: {
                            advbrand: 'IX',
                            advbrandid: '25661',
                            pricelevel: '200'
                        },
                        id: 567841330,
                        impid: '4',
                        price: '200'
                    }
                ],
                seat: '2439'
            }
        ]
    };
}

function getMockIndexExchangeBidResponse(server) {
    server.respondWith(XHRFilter.filters.IndexExchangeHtb.cygnus.urlRegex,
        function (xhr) {
            // Parse request URL into a manageable object.
            var request = UrlParse(xhr.url, true);
            var r = JSON.parse(request.query.r);
            var response = getOpenMarketBidResponse(r);

            xhr.respond(
                200,
                '',
                'headertag.IndexExchangeHtb.adResponseCallback('
                    + JSON.stringify(response)
                    + ')'
            );
        });
}

function getMockAdserverOrgIpResponse(server) {
    server.respondWith(XHRFilter.filters.AdserverOrgIp.endpoint.urlRegex,
        function (xhr) {
            var response = {
                QWER: 'TYUIOP',
                TDID: 'boffo'
            };

            xhr.respond(200, '', JSON.stringify(response));
        });
}

function getMockMerkleIpResponse(server) {
    server.respondWith(XHRFilter.filters.MerkleIp.endpoint.urlRegex,
        function (xhr) {
            var response = {
                ppid: {
                    id: 'SecretMessageFromMerkle'
                },
                pam_id: {
                    id: 'EvenSecreterMessageFromMerkleEncrypted==',
                    keyID: 5
                }
            };
            xhr.respond(200, '', JSON.stringify(response));
        });
}

function getMockMerkleIpResponseDelay(server, time) {
    server.respondWith(XHRFilter.filters.MerkleIp.endpoint.urlRegex,
        function (xhr) {
            var response = {
                ppid: {
                    id: 'SecretMessageFromMerkle'
                },
                pam_id: {
                    id: 'EvenSecreterMessageFromMerkleEncrypted==',
                    keyID: 5
                }
            };
            setTimeout(function () {
                // Workaround to allow sinon.fakeHTTP to process the response
                xhr.readyState = 1;
                xhr.respond(200, '', JSON.stringify(response));
            }, time);
        });
}

function getMockMerkleIpWithPassResponse(server) {
    server.respondWith(XHRFilter.filters.MerkleIp.endpoint.urlRegex,
        function (xhr) {
            xhr.respond(404, '', '');
        });
}

function getMockMerkleIpResponseWithError(server) {
    server.respondWith(XHRFilter.filters.MerkleIp.endpoint.urlRegex,
        function (xhr) {
            xhr.respond(500, '', '{}');
        });
}

var testSessionTypes = {
    DISPLAY: 'display',
    VIDEO: 'video'
};

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    getMockIndexExchangeBidResponse: getMockIndexExchangeBidResponse,
    getMockAdserverOrgIpResponse: getMockAdserverOrgIpResponse,
    getMockMerkleIpResponse: getMockMerkleIpResponse,
    getMockMerkleIpResponseDelay: getMockMerkleIpResponseDelay,
    getMockMerkleIpWithPassResponse: getMockMerkleIpWithPassResponse,
    getMockMerkleIpResponseWithError: getMockMerkleIpResponseWithError,
    getOpenMarketBidResponse: getOpenMarketBidResponse,
    responseTimes: responseTimes,
    testSessionTypes: testSessionTypes
};

},{"./xhr-filter":"/wrapper/pktf1/helpers/xhr-filter.js","url-parse":16}],"/wrapper/pktf1/helpers/polyfills/promise.js":[function(require,module,exports){
(function (process,global){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */

(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    (global.ES6Promise = factory());
}(this, (function () { 'use strict';

function objectOrFunction(x) {
  var type = typeof x;
  return x !== null && (type === 'object' || type === 'function');
}

function isFunction(x) {
  return typeof x === 'function';
}



var _isArray = void 0;
if (Array.isArray) {
  _isArray = Array.isArray;
} else {
  _isArray = function (x) {
    return Object.prototype.toString.call(x) === '[object Array]';
  };
}

var isArray = _isArray;

var len = 0;
var vertxNext = void 0;
var customSchedulerFn = void 0;

var asap = function asap(callback, arg) {
  queue[len] = callback;
  queue[len + 1] = arg;
  len += 2;
  if (len === 2) {
    // If len is 2, that means that we need to schedule an async flush.
    // If additional callbacks are queued before the queue is flushed, they
    // will be processed by this flush that we are scheduling.
    if (customSchedulerFn) {
      customSchedulerFn(flush);
    } else {
      scheduleFlush();
    }
  }
};

function setScheduler(scheduleFn) {
  customSchedulerFn = scheduleFn;
}

function setAsap(asapFn) {
  asap = asapFn;
}

var browserWindow = typeof window !== 'undefined' ? window : undefined;
var browserGlobal = browserWindow || {};
var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;
var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';

// test for web worker but not in IE10
var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';

// node
function useNextTick() {
  // node version 0.10.x displays a deprecation warning when nextTick is used recursively
  // see https://github.com/cujojs/when/issues/410 for details
  return function () {
    return process.nextTick(flush);
  };
}

// vertx
function useVertxTimer() {
  if (typeof vertxNext !== 'undefined') {
    return function () {
      vertxNext(flush);
    };
  }

  return useSetTimeout();
}

function useMutationObserver() {
  var iterations = 0;
  var observer = new BrowserMutationObserver(flush);
  var node = document.createTextNode('');
  observer.observe(node, { characterData: true });

  return function () {
    node.data = iterations = ++iterations % 2;
  };
}

// web worker
function useMessageChannel() {
  var channel = new MessageChannel();
  channel.port1.onmessage = flush;
  return function () {
    return channel.port2.postMessage(0);
  };
}

function useSetTimeout() {
  // Store setTimeout reference so es6-promise will be unaffected by
  // other code modifying setTimeout (like sinon.useFakeTimers())
  var globalSetTimeout = setTimeout;
  return function () {
    return globalSetTimeout(flush, 1);
  };
}

var queue = new Array(1000);
function flush() {
  for (var i = 0; i < len; i += 2) {
    var callback = queue[i];
    var arg = queue[i + 1];

    callback(arg);

    queue[i] = undefined;
    queue[i + 1] = undefined;
  }

  len = 0;
}

function attemptVertx() {
  try {
    var vertx = Function('return this')().require('vertx');
    vertxNext = vertx.runOnLoop || vertx.runOnContext;
    return useVertxTimer();
  } catch (e) {
    return useSetTimeout();
  }
}

var scheduleFlush = void 0;
// Decide what async method to use to triggering processing of queued callbacks:
if (isNode) {
  scheduleFlush = useNextTick();
} else if (BrowserMutationObserver) {
  scheduleFlush = useMutationObserver();
} else if (isWorker) {
  scheduleFlush = useMessageChannel();
} else if (browserWindow === undefined && typeof require === 'function') {
  scheduleFlush = attemptVertx();
} else {
  scheduleFlush = useSetTimeout();
}

function then(onFulfillment, onRejection) {
  var parent = this;

  var child = new this.constructor(noop);

  if (child[PROMISE_ID] === undefined) {
    makePromise(child);
  }

  var _state = parent._state;


  if (_state) {
    var callback = arguments[_state - 1];
    asap(function () {
      return invokeCallback(_state, child, callback, parent._result);
    });
  } else {
    subscribe(parent, child, onFulfillment, onRejection);
  }

  return child;
}

/**
  `Promise.resolve` returns a promise that will become resolved with the
  passed `value`. It is shorthand for the following:

  ```javascript
  let promise = new Promise(function(resolve, reject){
    resolve(1);
  });

  promise.then(function(value){
    // value === 1
  });
  ```

  Instead of writing the above, your code now simply becomes the following:

  ```javascript
  let promise = Promise.resolve(1);

  promise.then(function(value){
    // value === 1
  });
  ```

  @method resolve
  @static
  @param {Any} value value that the returned promise will be resolved with
  Useful for tooling.
  @return {Promise} a promise that will become fulfilled with the given
  `value`
*/
function resolve$1(object) {
  /*jshint validthis:true */
  var Constructor = this;

  if (object && typeof object === 'object' && object.constructor === Constructor) {
    return object;
  }

  var promise = new Constructor(noop);
  resolve(promise, object);
  return promise;
}

var PROMISE_ID = Math.random().toString(36).substring(2);

function noop() {}

var PENDING = void 0;
var FULFILLED = 1;
var REJECTED = 2;

var TRY_CATCH_ERROR = { error: null };

function selfFulfillment() {
  return new TypeError("You cannot resolve a promise with itself");
}

function cannotReturnOwn() {
  return new TypeError('A promises callback cannot return that same promise.');
}

function getThen(promise) {
  try {
    return promise.then;
  } catch (error) {
    TRY_CATCH_ERROR.error = error;
    return TRY_CATCH_ERROR;
  }
}

function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {
  try {
    then$$1.call(value, fulfillmentHandler, rejectionHandler);
  } catch (e) {
    return e;
  }
}

function handleForeignThenable(promise, thenable, then$$1) {
  asap(function (promise) {
    var sealed = false;
    var error = tryThen(then$$1, thenable, function (value) {
      if (sealed) {
        return;
      }
      sealed = true;
      if (thenable !== value) {
        resolve(promise, value);
      } else {
        fulfill(promise, value);
      }
    }, function (reason) {
      if (sealed) {
        return;
      }
      sealed = true;

      reject(promise, reason);
    }, 'Settle: ' + (promise._label || ' unknown promise'));

    if (!sealed && error) {
      sealed = true;
      reject(promise, error);
    }
  }, promise);
}

function handleOwnThenable(promise, thenable) {
  if (thenable._state === FULFILLED) {
    fulfill(promise, thenable._result);
  } else if (thenable._state === REJECTED) {
    reject(promise, thenable._result);
  } else {
    subscribe(thenable, undefined, function (value) {
      return resolve(promise, value);
    }, function (reason) {
      return reject(promise, reason);
    });
  }
}

function handleMaybeThenable(promise, maybeThenable, then$$1) {
  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {
    handleOwnThenable(promise, maybeThenable);
  } else {
    if (then$$1 === TRY_CATCH_ERROR) {
      reject(promise, TRY_CATCH_ERROR.error);
      TRY_CATCH_ERROR.error = null;
    } else if (then$$1 === undefined) {
      fulfill(promise, maybeThenable);
    } else if (isFunction(then$$1)) {
      handleForeignThenable(promise, maybeThenable, then$$1);
    } else {
      fulfill(promise, maybeThenable);
    }
  }
}

function resolve(promise, value) {
  if (promise === value) {
    reject(promise, selfFulfillment());
  } else if (objectOrFunction(value)) {
    handleMaybeThenable(promise, value, getThen(value));
  } else {
    fulfill(promise, value);
  }
}

function publishRejection(promise) {
  if (promise._onerror) {
    promise._onerror(promise._result);
  }

  publish(promise);
}

function fulfill(promise, value) {
  if (promise._state !== PENDING) {
    return;
  }

  promise._result = value;
  promise._state = FULFILLED;

  if (promise._subscribers.length !== 0) {
    asap(publish, promise);
  }
}

function reject(promise, reason) {
  if (promise._state !== PENDING) {
    return;
  }
  promise._state = REJECTED;
  promise._result = reason;

  asap(publishRejection, promise);
}

function subscribe(parent, child, onFulfillment, onRejection) {
  var _subscribers = parent._subscribers;
  var length = _subscribers.length;


  parent._onerror = null;

  _subscribers[length] = child;
  _subscribers[length + FULFILLED] = onFulfillment;
  _subscribers[length + REJECTED] = onRejection;

  if (length === 0 && parent._state) {
    asap(publish, parent);
  }
}

function publish(promise) {
  var subscribers = promise._subscribers;
  var settled = promise._state;

  if (subscribers.length === 0) {
    return;
  }

  var child = void 0,
      callback = void 0,
      detail = promise._result;

  for (var i = 0; i < subscribers.length; i += 3) {
    child = subscribers[i];
    callback = subscribers[i + settled];

    if (child) {
      invokeCallback(settled, child, callback, detail);
    } else {
      callback(detail);
    }
  }

  promise._subscribers.length = 0;
}

function tryCatch(callback, detail) {
  try {
    return callback(detail);
  } catch (e) {
    TRY_CATCH_ERROR.error = e;
    return TRY_CATCH_ERROR;
  }
}

function invokeCallback(settled, promise, callback, detail) {
  var hasCallback = isFunction(callback),
      value = void 0,
      error = void 0,
      succeeded = void 0,
      failed = void 0;

  if (hasCallback) {
    value = tryCatch(callback, detail);

    if (value === TRY_CATCH_ERROR) {
      failed = true;
      error = value.error;
      value.error = null;
    } else {
      succeeded = true;
    }

    if (promise === value) {
      reject(promise, cannotReturnOwn());
      return;
    }
  } else {
    value = detail;
    succeeded = true;
  }

  if (promise._state !== PENDING) {
    // noop
  } else if (hasCallback && succeeded) {
    resolve(promise, value);
  } else if (failed) {
    reject(promise, error);
  } else if (settled === FULFILLED) {
    fulfill(promise, value);
  } else if (settled === REJECTED) {
    reject(promise, value);
  }
}

function initializePromise(promise, resolver) {
  try {
    resolver(function resolvePromise(value) {
      resolve(promise, value);
    }, function rejectPromise(reason) {
      reject(promise, reason);
    });
  } catch (e) {
    reject(promise, e);
  }
}

var id = 0;
function nextId() {
  return id++;
}

function makePromise(promise) {
  promise[PROMISE_ID] = id++;
  promise._state = undefined;
  promise._result = undefined;
  promise._subscribers = [];
}

function validationError() {
  return new Error('Array Methods must be provided an Array');
}

var Enumerator = function () {
  function Enumerator(Constructor, input) {
    this._instanceConstructor = Constructor;
    this.promise = new Constructor(noop);

    if (!this.promise[PROMISE_ID]) {
      makePromise(this.promise);
    }

    if (isArray(input)) {
      this.length = input.length;
      this._remaining = input.length;

      this._result = new Array(this.length);

      if (this.length === 0) {
        fulfill(this.promise, this._result);
      } else {
        this.length = this.length || 0;
        this._enumerate(input);
        if (this._remaining === 0) {
          fulfill(this.promise, this._result);
        }
      }
    } else {
      reject(this.promise, validationError());
    }
  }

  Enumerator.prototype._enumerate = function _enumerate(input) {
    for (var i = 0; this._state === PENDING && i < input.length; i++) {
      this._eachEntry(input[i], i);
    }
  };

  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {
    var c = this._instanceConstructor;
    var resolve$$1 = c.resolve;


    if (resolve$$1 === resolve$1) {
      var _then = getThen(entry);

      if (_then === then && entry._state !== PENDING) {
        this._settledAt(entry._state, i, entry._result);
      } else if (typeof _then !== 'function') {
        this._remaining--;
        this._result[i] = entry;
      } else if (c === Promise$2) {
        var promise = new c(noop);
        handleMaybeThenable(promise, entry, _then);
        this._willSettleAt(promise, i);
      } else {
        this._willSettleAt(new c(function (resolve$$1) {
          return resolve$$1(entry);
        }), i);
      }
    } else {
      this._willSettleAt(resolve$$1(entry), i);
    }
  };

  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {
    var promise = this.promise;


    if (promise._state === PENDING) {
      this._remaining--;

      if (state === REJECTED) {
        reject(promise, value);
      } else {
        this._result[i] = value;
      }
    }

    if (this._remaining === 0) {
      fulfill(promise, this._result);
    }
  };

  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {
    var enumerator = this;

    subscribe(promise, undefined, function (value) {
      return enumerator._settledAt(FULFILLED, i, value);
    }, function (reason) {
      return enumerator._settledAt(REJECTED, i, reason);
    });
  };

  return Enumerator;
}();

/**
  `Promise.all` accepts an array of promises, and returns a new promise which
  is fulfilled with an array of fulfillment values for the passed promises, or
  rejected with the reason of the first passed promise to be rejected. It casts all
  elements of the passed iterable to promises as it runs this algorithm.

  Example:

  ```javascript
  let promise1 = resolve(1);
  let promise2 = resolve(2);
  let promise3 = resolve(3);
  let promises = [ promise1, promise2, promise3 ];

  Promise.all(promises).then(function(array){
    // The array here would be [ 1, 2, 3 ];
  });
  ```

  If any of the `promises` given to `all` are rejected, the first promise
  that is rejected will be given as an argument to the returned promises's
  rejection handler. For example:

  Example:

  ```javascript
  let promise1 = resolve(1);
  let promise2 = reject(new Error("2"));
  let promise3 = reject(new Error("3"));
  let promises = [ promise1, promise2, promise3 ];

  Promise.all(promises).then(function(array){
    // Code here never runs because there are rejected promises!
  }, function(error) {
    // error.message === "2"
  });
  ```

  @method all
  @static
  @param {Array} entries array of promises
  @param {String} label optional string for labeling the promise.
  Useful for tooling.
  @return {Promise} promise that is fulfilled when all `promises` have been
  fulfilled, or rejected if any of them become rejected.
  @static
*/
function all(entries) {
  return new Enumerator(this, entries).promise;
}

/**
  `Promise.race` returns a new promise which is settled in the same way as the
  first passed promise to settle.

  Example:

  ```javascript
  let promise1 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 1');
    }, 200);
  });

  let promise2 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 2');
    }, 100);
  });

  Promise.race([promise1, promise2]).then(function(result){
    // result === 'promise 2' because it was resolved before promise1
    // was resolved.
  });
  ```

  `Promise.race` is deterministic in that only the state of the first
  settled promise matters. For example, even if other promises given to the
  `promises` array argument are resolved, but the first settled promise has
  become rejected before the other promises became fulfilled, the returned
  promise will become rejected:

  ```javascript
  let promise1 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 1');
    }, 200);
  });

  let promise2 = new Promise(function(resolve, reject){
    setTimeout(function(){
      reject(new Error('promise 2'));
    }, 100);
  });

  Promise.race([promise1, promise2]).then(function(result){
    // Code here never runs
  }, function(reason){
    // reason.message === 'promise 2' because promise 2 became rejected before
    // promise 1 became fulfilled
  });
  ```

  An example real-world use case is implementing timeouts:

  ```javascript
  Promise.race([ajax('foo.json'), timeout(5000)])
  ```

  @method race
  @static
  @param {Array} promises array of promises to observe
  Useful for tooling.
  @return {Promise} a promise which settles in the same way as the first passed
  promise to settle.
*/
function race(entries) {
  /*jshint validthis:true */
  var Constructor = this;

  if (!isArray(entries)) {
    return new Constructor(function (_, reject) {
      return reject(new TypeError('You must pass an array to race.'));
    });
  } else {
    return new Constructor(function (resolve, reject) {
      var length = entries.length;
      for (var i = 0; i < length; i++) {
        Constructor.resolve(entries[i]).then(resolve, reject);
      }
    });
  }
}

/**
  `Promise.reject` returns a promise rejected with the passed `reason`.
  It is shorthand for the following:

  ```javascript
  let promise = new Promise(function(resolve, reject){
    reject(new Error('WHOOPS'));
  });

  promise.then(function(value){
    // Code here doesn't run because the promise is rejected!
  }, function(reason){
    // reason.message === 'WHOOPS'
  });
  ```

  Instead of writing the above, your code now simply becomes the following:

  ```javascript
  let promise = Promise.reject(new Error('WHOOPS'));

  promise.then(function(value){
    // Code here doesn't run because the promise is rejected!
  }, function(reason){
    // reason.message === 'WHOOPS'
  });
  ```

  @method reject
  @static
  @param {Any} reason value that the returned promise will be rejected with.
  Useful for tooling.
  @return {Promise} a promise rejected with the given `reason`.
*/
function reject$1(reason) {
  /*jshint validthis:true */
  var Constructor = this;
  var promise = new Constructor(noop);
  reject(promise, reason);
  return promise;
}

function needsResolver() {
  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');
}

function needsNew() {
  throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
}

/**
  Promise objects represent the eventual result of an asynchronous operation. The
  primary way of interacting with a promise is through its `then` method, which
  registers callbacks to receive either a promise's eventual value or the reason
  why the promise cannot be fulfilled.

  Terminology
  -----------

  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.
  - `thenable` is an object or function that defines a `then` method.
  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).
  - `exception` is a value that is thrown using the throw statement.
  - `reason` is a value that indicates why a promise was rejected.
  - `settled` the final resting state of a promise, fulfilled or rejected.

  A promise can be in one of three states: pending, fulfilled, or rejected.

  Promises that are fulfilled have a fulfillment value and are in the fulfilled
  state.  Promises that are rejected have a rejection reason and are in the
  rejected state.  A fulfillment value is never a thenable.

  Promises can also be said to *resolve* a value.  If this value is also a
  promise, then the original promise's settled state will match the value's
  settled state.  So a promise that *resolves* a promise that rejects will
  itself reject, and a promise that *resolves* a promise that fulfills will
  itself fulfill.


  Basic Usage:
  ------------

  ```js
  let promise = new Promise(function(resolve, reject) {
    // on success
    resolve(value);

    // on failure
    reject(reason);
  });

  promise.then(function(value) {
    // on fulfillment
  }, function(reason) {
    // on rejection
  });
  ```

  Advanced Usage:
  ---------------

  Promises shine when abstracting away asynchronous interactions such as
  `XMLHttpRequest`s.

  ```js
  function getJSON(url) {
    return new Promise(function(resolve, reject){
      let xhr = new XMLHttpRequest();

      xhr.open('GET', url);
      xhr.onreadystatechange = handler;
      xhr.responseType = 'json';
      xhr.setRequestHeader('Accept', 'application/json');
      xhr.send();

      function handler() {
        if (this.readyState === this.DONE) {
          if (this.status === 200) {
            resolve(this.response);
          } else {
            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));
          }
        }
      };
    });
  }

  getJSON('/posts.json').then(function(json) {
    // on fulfillment
  }, function(reason) {
    // on rejection
  });
  ```

  Unlike callbacks, promises are great composable primitives.

  ```js
  Promise.all([
    getJSON('/posts'),
    getJSON('/comments')
  ]).then(function(values){
    values[0] // => postsJSON
    values[1] // => commentsJSON

    return values;
  });
  ```

  @class Promise
  @param {Function} resolver
  Useful for tooling.
  @constructor
*/

var Promise$2 = function () {
  function Promise(resolver) {
    this[PROMISE_ID] = nextId();
    this._result = this._state = undefined;
    this._subscribers = [];

    if (noop !== resolver) {
      typeof resolver !== 'function' && needsResolver();
      this instanceof Promise ? initializePromise(this, resolver) : needsNew();
    }
  }

  /**
  The primary way of interacting with a promise is through its `then` method,
  which registers callbacks to receive either a promise's eventual value or the
  reason why the promise cannot be fulfilled.
   ```js
  findUser().then(function(user){
    // user is available
  }, function(reason){
    // user is unavailable, and you are given the reason why
  });
  ```
   Chaining
  --------
   The return value of `then` is itself a promise.  This second, 'downstream'
  promise is resolved with the return value of the first promise's fulfillment
  or rejection handler, or rejected if the handler throws an exception.
   ```js
  findUser().then(function (user) {
    return user.name;
  }, function (reason) {
    return 'default name';
  }).then(function (userName) {
    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it
    // will be `'default name'`
  });
   findUser().then(function (user) {
    throw new Error('Found user, but still unhappy');
  }, function (reason) {
    throw new Error('`findUser` rejected and we're unhappy');
  }).then(function (value) {
    // never reached
  }, function (reason) {
    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.
    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.
  });
  ```
  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.
   ```js
  findUser().then(function (user) {
    throw new PedagogicalException('Upstream error');
  }).then(function (value) {
    // never reached
  }).then(function (value) {
    // never reached
  }, function (reason) {
    // The `PedgagocialException` is propagated all the way down to here
  });
  ```
   Assimilation
  ------------
   Sometimes the value you want to propagate to a downstream promise can only be
  retrieved asynchronously. This can be achieved by returning a promise in the
  fulfillment or rejection handler. The downstream promise will then be pending
  until the returned promise is settled. This is called *assimilation*.
   ```js
  findUser().then(function (user) {
    return findCommentsByAuthor(user);
  }).then(function (comments) {
    // The user's comments are now available
  });
  ```
   If the assimliated promise rejects, then the downstream promise will also reject.
   ```js
  findUser().then(function (user) {
    return findCommentsByAuthor(user);
  }).then(function (comments) {
    // If `findCommentsByAuthor` fulfills, we'll have the value here
  }, function (reason) {
    // If `findCommentsByAuthor` rejects, we'll have the reason here
  });
  ```
   Simple Example
  --------------
   Synchronous Example
   ```javascript
  let result;
   try {
    result = findResult();
    // success
  } catch(reason) {
    // failure
  }
  ```
   Errback Example
   ```js
  findResult(function(result, err){
    if (err) {
      // failure
    } else {
      // success
    }
  });
  ```
   Promise Example;
   ```javascript
  findResult().then(function(result){
    // success
  }, function(reason){
    // failure
  });
  ```
   Advanced Example
  --------------
   Synchronous Example
   ```javascript
  let author, books;
   try {
    author = findAuthor();
    books  = findBooksByAuthor(author);
    // success
  } catch(reason) {
    // failure
  }
  ```
   Errback Example
   ```js
   function foundBooks(books) {
   }
   function failure(reason) {
   }
   findAuthor(function(author, err){
    if (err) {
      failure(err);
      // failure
    } else {
      try {
        findBoooksByAuthor(author, function(books, err) {
          if (err) {
            failure(err);
          } else {
            try {
              foundBooks(books);
            } catch(reason) {
              failure(reason);
            }
          }
        });
      } catch(error) {
        failure(err);
      }
      // success
    }
  });
  ```
   Promise Example;
   ```javascript
  findAuthor().
    then(findBooksByAuthor).
    then(function(books){
      // found books
  }).catch(function(reason){
    // something went wrong
  });
  ```
   @method then
  @param {Function} onFulfilled
  @param {Function} onRejected
  Useful for tooling.
  @return {Promise}
  */

  /**
  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same
  as the catch block of a try/catch statement.
  ```js
  function findAuthor(){
  throw new Error('couldn't find that author');
  }
  // synchronous
  try {
  findAuthor();
  } catch(reason) {
  // something went wrong
  }
  // async with promises
  findAuthor().catch(function(reason){
  // something went wrong
  });
  ```
  @method catch
  @param {Function} onRejection
  Useful for tooling.
  @return {Promise}
  */


  Promise.prototype.catch = function _catch(onRejection) {
    return this.then(null, onRejection);
  };

  /**
    `finally` will be invoked regardless of the promise's fate just as native
    try/catch/finally behaves

    Synchronous example:

    ```js
    findAuthor() {
      if (Math.random() > 0.5) {
        throw new Error();
      }
      return new Author();
    }

    try {
      return findAuthor(); // succeed or fail
    } catch(error) {
      return findOtherAuther();
    } finally {
      // always runs
      // doesn't affect the return value
    }
    ```

    Asynchronous example:

    ```js
    findAuthor().catch(function(reason){
      return findOtherAuther();
    }).finally(function(){
      // author was either found, or not
    });
    ```

    @method finally
    @param {Function} callback
    @return {Promise}
  */


  Promise.prototype.finally = function _finally(callback) {
    var promise = this;
    var constructor = promise.constructor;

    return promise.then(function (value) {
      return constructor.resolve(callback()).then(function () {
        return value;
      });
    }, function (reason) {
      return constructor.resolve(callback()).then(function () {
        throw reason;
      });
    });
  };

  return Promise;
}();

Promise$2.prototype.then = then;
Promise$2.all = all;
Promise$2.race = race;
Promise$2.resolve = resolve$1;
Promise$2.reject = reject$1;
Promise$2._setScheduler = setScheduler;
Promise$2._setAsap = setAsap;
Promise$2._asap = asap;

/*global self*/
function polyfill() {
  var local = void 0;

  if (typeof global !== 'undefined') {
    local = global;
  } else if (typeof self !== 'undefined') {
    local = self;
  } else {
    try {
      local = Function('return this')();
    } catch (e) {
      throw new Error('polyfill failed because global object is unavailable in this environment');
    }
  }

  var P = local.Promise;

  if (P) {
    var promiseToString = null;
    try {
      promiseToString = Object.prototype.toString.call(P.resolve());
    } catch (e) {
      // silently ignored
    }

    if (promiseToString === '[object Promise]' && !P.cast) {
      return;
    }
  }

  local.Promise = Promise$2;
}

// Strange compat..
Promise$2.polyfill = polyfill;
Promise$2.Promise = Promise$2;

Promise$2.polyfill();

return Promise$2;

})));

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":11}],"/wrapper/pktf1/helpers/render-checker.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Utilities = require('./utilities');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

function dfpFriendlyFrameRender(expectedRenders) {
    expectedRenders = expectedRenders || 1;
    var actualRenders = 0;

    var fnName = '_' + Utilities.generateUniqueId();

    var promise = new Promise(function (resolve) {
        window[fnName] = function () {
            actualRenders++;

            if (actualRenders !== expectedRenders) {
                return;
            }

            resolve();

            delete window[fnName];
        };
    });

    return {
        // eslint-disable-next-line max-len
        adm: '<script>var context=window;while(true){if(context.' + fnName + '){context.' + fnName + '()}if(context.frameElement===null){break}context=context.parent}</script><div style="background-color: #32CD32; width: 100%; height: 100%; border: 2px solid #000000"><h1>DfpFriendlyFrameRender</h1></div>',
        promise: promise
    };
}

function dfpPostMessageRender(expectedRenders) {
    expectedRenders = expectedRenders || 1;
    var actualRenders = 0;

    var uniqueId = Utilities.generateUniqueId();

    var promise = new Promise(function (resolve) {
        function dfpMostMessageListener(ev) {
            if (Utilities.getType(ev.data) !== 'string' || ev.data !== uniqueId) {
                return;
            }

            actualRenders++;

            if (actualRenders !== expectedRenders) {
                return;
            }

            resolve();

            window.removeEventListener('message', dfpMostMessageListener, false);
        }

        window.addEventListener('message', dfpMostMessageListener, false);
    });

    return {
        // eslint-disable-next-line max-len
        adm: '<script>var context=window;while(true){context.parent.postMessage(\'' + uniqueId + '\', \'*\');if(context.frameElement===null){break}context=context.parent}</script><div style="background-color: #32CD32; width: 100%; height: 100%; border: 2px solid #000000"><h1>DfpPostMessageRender</h1></div>',
        promise: promise
    };
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    dfpPostMessageRender: dfpPostMessageRender,
    dfpFriendlyFrameRender: dfpFriendlyFrameRender
};

},{"./utilities":"/wrapper/pktf1/helpers/utilities.js"}],"/wrapper/pktf1/helpers/stub-loader.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Utilities = require('./utilities');

// =============================================================================
// CONSTANTS ///////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

/**
 * A list of all the stub objects. Cannot be loaded during runtime because of
 * the way Browserify packages all the times, and lack of NodeJS `fs` library
 * access.
 *
 * @type {object[]}
 */
var ALL_STUBS = [
    require('../stubs/space-camp.stub.js'),
    require('../stubs/libs/browser.stub.js'),
    require('../stubs/libs/cache.stub.js'),
    require('../stubs/libs/utilities.stub.js'),
    require('../stubs/libs/size.stub.js'),
    require('../stubs/libs/network.stub.js')
];

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

// Combine all the preloaded stubs into a single object for easy access.
var stubs = {};

for (var i = 0; i < ALL_STUBS.length; i++) {
    var singleStub = ALL_STUBS[i];
    stubs = Utilities.mergeObjects(stubs, singleStub);
}

/**
 * Merges the specified stubs into a single Proxyquireify-compatible stub
 * object.
 *
 * @param  {string[]}   stubNames   A list dependencies to get stubs for.
 *
 * @return {object}                 An object containing all the requested
 *                                  stubs.
 */
function load(stubNames) {
    var loadedStubs = {};

    for (var j = 0; j < stubNames.length; j++) {
        var stubName = stubNames[j];

        if (!stubs.hasOwnProperty(stubName)) {
            throw Error('Stub with name ' + stubName + ' does not exist');
        }

        loadedStubs[stubName] = stubs[stubName];
    }

    return loadedStubs;
}

/**
 * Retrieves the instance of the stub object used in the loader.
 *
 * @param  {string[]}   stubName    Name of stub to retrieve.
 *
 * @return {any}                    The stub used for this specific object.
 */
function stub(stubName) {
    if (!stubs.hasOwnProperty(stubName)) {
        throw Error('Stub with name ' + stubName + ' does not exist');
    }

    return stubs[stubName];
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    load: load,
    stub: stub
};

},{"../stubs/libs/browser.stub.js":"/wrapper/pktf1/stubs/libs/browser.stub.js","../stubs/libs/cache.stub.js":"/wrapper/pktf1/stubs/libs/cache.stub.js","../stubs/libs/network.stub.js":"/wrapper/pktf1/stubs/libs/network.stub.js","../stubs/libs/size.stub.js":"/wrapper/pktf1/stubs/libs/size.stub.js","../stubs/libs/utilities.stub.js":"/wrapper/pktf1/stubs/libs/utilities.stub.js","../stubs/space-camp.stub.js":"/wrapper/pktf1/stubs/space-camp.stub.js","./utilities":"/wrapper/pktf1/helpers/utilities.js"}],"/wrapper/pktf1/helpers/utilities.js":[function(require,module,exports){
'use strict';

// =============================================================================
// CONSTANTS ///////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var REGEX_TYPE = /\s([a-zA-Z]+)/;
var REGEX_ARRAY_ACCESS = /^(.*)\[(\d+)\]$/;

var CHARACTER_SETS = {
    ALPHANUM: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',
    ALPHA: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',
    ALPHA_UPPER: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
    ALPHA_LOWER: 'abcdefghijklmnopqrstuvwxyz',
    HEX: '0123456789abcdef',
    NUM: '0123456789'
};

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

/**
 * Returns the type of any entity as all lowercase. Handles edge-cases such as
 * `typeof null === 'object'`, by returning `'null'` instead of `'object'`.
 *
 * @param  {any}    entity  The object to enumerate the type for.
 *
 * @return {string}         A lowercase string containing the type of `entity`.
 */
function getType(entity) {
    if (typeof entity === 'undefined') {
        return 'undefined';
    }

    return {}.toString.call(entity).match(REGEX_TYPE)[1].toLowerCase();
}

/**
 * Appends elements from `source` to the end of `target`.
 *
 * @param  {any[]}  target  The array to append the elements to.
 * @param  {any[]}  source  The array to append the elements from.
 *
 * @return {any[]}          A pointer to `target`.
 */
function appendToArray(target, source) {
    Array.prototype.push.apply(target, source);

    return target;
}

/**
 * Shallow copies all the top-level items in `source` to `target`. Items from
 * `source` overwrite those in `target` if they have the same property name.
 *
 * @param  {object} target  The object to copy to.
 * @param  {object} source  The object to copy from.
 *
 * @return {object}         A pointer to `target`.
 */
function mergeObjects(target, source) {
    for (var prop in source) {
        if (!source.hasOwnProperty(prop)) {
            continue;
        }

        target[prop] = source[prop];
    }

    return target;
}

/**
 * Deep copies all items in `source` to `target`. Items from `source` overwrite
 * those in `target` if they have the same property name, and the item in
 * `target` is not an object (inlcluding null), regardless of depth. Note that
 * as a result of this, the returned object will always have equal number or
 * or more properties than `target`, for all depth levels.
 *
 * @param  {object} target  The object to copy to.
 * @param  {object} source  The object to copy from.
 *
 * @return {object}         A pointer to `target`.
 */
function deepMergeObjects(target, source) {
    for (var prop in source) {
        if (!source.hasOwnProperty(prop)) {
            continue;
        }

        if (getType(target[prop]) === 'object') {
            if (getType(source[prop]) === 'object') {
                deepMergeObjects(target[prop], source[prop]);
            }
        } else {
            target[prop] = source[prop];
        }
    }

    return target;
}

/**
 * Deep clones an object.
 *
 * @param  {object} original The object to be cloned.
 *
 * @return {object}          A clone of `original`.
 */
function clonePlainObject(original) {
    return JSON.parse(JSON.stringify(original));
}

/**
 * Attempts to get a value from an object based on the provided path. If the
 * path does not exists, undefined is returned.
 *
 * @param  {object} obj  The object you want to get a value from.
 * @param  {string} path The path in the object to look for said value.
 *
 * @return {any}         If the path is valid, then the value of that node is
 *                       returned. Otherwise, `undefined`.
 */
function deepGet(obj, path) {
    var parts = path.split('.');

    var curLocation = obj;

    while (parts.length) {
        var part = parts.shift();

        var index = null;
        var matchResult = part.match(REGEX_ARRAY_ACCESS);
        if (matchResult !== null) {
            part = matchResult[1];
            index = matchResult[2];
        }

        if (!curLocation.hasOwnProperty(part)
            || (index !== null && getType(curLocation[part][index]) === 'undefined')) {
            return undefined;
        }

        curLocation = index === null ? curLocation[part] : curLocation[part][index];
    }

    return curLocation;
}

/**
 * Set value at an arbitrary location in an object. If the location does not
 * exist, it will be created.
 *
 * @param  {object} obj   The object you want to set a value in.
 * @param  {string} path  The path you want to set the value at.
 * @param  {any}    value The value you want to set at the path.
 *
 * @return {object}       Returns a reference to `obj`.
 */
function deepSet(obj, path, value) {
    var parts = path.split('.');

    var curLocation = obj;

    while (parts.length) {
        var part = parts.shift();
        var matchResult = part.match(REGEX_ARRAY_ACCESS);

        if (matchResult !== null) {
            var index = matchResult[2];
            part = matchResult[1];

            if (!curLocation.hasOwnProperty(part)) {
                curLocation[part] = [];
                curLocation[part][index] = {};
            } else if (curLocation.hasOwnProperty(part)
                && getType(curLocation[part][index]) === 'undefined') {
                curLocation[part][index] = {};
            }

            if (parts.length > 0) {
                curLocation = curLocation[part][index];
            } else {
                curLocation[part][index] = value;
            }
        } else {
            if (!curLocation.hasOwnProperty(part)
                || typeof curLocation[part] !== 'object') {
                curLocation[part] = {};
            }

            if (parts.length > 0) {
                curLocation = curLocation[part];
            } else {
                curLocation[part] = value;
            }
        }
    }

    return obj;
}

/**
 * Returns a defer-style promise. Use should be minimized as normal Promises
 * are favored.
 *
 * @return {object} An object containing the promise, and its resolve/reject
 *                  functions.
 */
function defer() {
    var deferred = {};

    deferred.promise = new Promise(function (resolve, reject) {
        deferred.resolve = resolve;
        deferred.reject = reject;
    });

    return deferred;
}

function generateUniqueId(len, charSet) {
    len = len || 8;
    charSet = charSet || 'ALPHANUM';

    var uid = '';
    for (var i = 0; i < len; i++) {
        uid += CHARACTER_SETS[charSet].charAt(
            Math.floor(Math.random() * CHARACTER_SETS[charSet].length)
        );
    }

    return uid;
}

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = {
    getType: getType,
    appendToArray: appendToArray,
    mergeObjects: mergeObjects,
    deepMergeObjects: deepMergeObjects,
    clonePlainObject: clonePlainObject,
    deepGet: deepGet,
    deepSet: deepSet,
    defer: defer,
    generateUniqueId: generateUniqueId
};

},{}],"/wrapper/pktf1/helpers/xhr-filter.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var Utilities = require('./utilities');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var filters = {
    GooglePublisherTag: {
        ads: {
            method: 'GET',
            urlRegex: /.*securepubads\.g\.doubleclick\.net\/gampad\/ads.*/
        }
    },
    IndexExchangeHtb: {
        cygnus: {
            method: 'GET',
            urlRegex: /.*as(-sec)?\.casalemedia\.com\/cygnus.*/
        },
        headerstats: {
            method: 'POST',
            urlRegex: /.*as(-sec)?\.casalemedia\.com\/headerstats.*/
        },
        asedge: {
            method: 'GET',
            urlRegex: /.*htlb\.casalemedia\.com\/cygnus.*/
        }
    },
    IndexExchangeVideoHtb: {
        cygnus: {
            method: 'GET',
            urlRegex: /.*as(-sec)?\.casalemedia\.com\/cygnus\?v=8.1.*/
        }
    },
    RoundelVideoHtb: {
        cygnus: {
            method: 'GET',
            urlRegex: /.*as(-sec)?\.casalemedia\.com\/cygnus\?v=8.1.*/
        }
    },
    TrustXHtb: {
        endpoint: {
            method: 'GET',
            urlRegex: /.*sofia\.trustx\.org.*/
        }
    },
    OpenXHtb: {
        endpoint: {
            method: 'GET',
            urlRegex: /.*oxdemo-d\.openx\.net.*/
        }
    },
    AdserverOrgIp: {
        endpoint: {
            method: 'GET',
            urlRegex: /.*match\.adsrvr\.org\/track\/rid.*/
        }
    },
    LiveRampIp: {
        endpoint: {
            method: 'GET',
            urlRegex: /.*api\.rlcdn\.com\/api\/identity.*/
        }
    },
    MerkleIp: {
        endpoint: {
            method: 'GET',
            urlRegex: /.*mid\.rkdms\.com\/ids.*/
        }
    }
};

function XhrFilter() {
    var __enabledFilters;

    function run(method, url) {
        for (var fName in __enabledFilters) {
            if (!__enabledFilters.hasOwnProperty(fName)) {
                continue;
            }

            if (!__enabledFilters.hasOwnProperty(fName)
                || __enabledFilters[fName] === false) {
                continue;
            }

            var filter = Utilities.deepGet(filters, fName);

            if (filter.method === method
                && filter.urlRegex.test(url) === true) {
                return false;
            }
        }

        return true;
    }

    function capture(filterNames) {
        if (Utilities.getType(filterNames) === 'string') {
            filterNames = [filterNames];
        }

        for (var i = 0; i < filterNames.length; i++) {
            var fName = filterNames[i];

            if (Utilities.deepGet(filters, fName) === undefined) {
                throw Error('Unrecognized filter "' + fName + '"');
            }

            __enabledFilters[fName] = true;
        }
    }

    function register(partnerId, requestName, requestRegex) {
        if (!filters.hasOwnProperty(partnerId)) {
            filters[partnerId] = {};
        }
        filters[partnerId][requestName] = requestRegex;
    }

    (function __constructor() {
        __enabledFilters = {};
    })();

    return {
        run: run,
        capture: capture,
        register: register
    };
}

XhrFilter.install = function (fakeXMLHttpRequest) {
    var xhrFilter = XhrFilter();

    fakeXMLHttpRequest.useFilters = true;
    fakeXMLHttpRequest.addFilter(xhrFilter.run);

    return xhrFilter;
};

XhrFilter.filters = filters;

// =============================================================================
// EXPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

module.exports = XhrFilter;

},{"./utilities":"/wrapper/pktf1/helpers/utilities.js"}],17:[function(require,module,exports){
// Device.js
// (c) 2014 Matthew Hudson
// Device.js is freely distributable under the MIT license.
// For all details and documentation:
// http://matthewhudson.me/projects/device.js/

'use strict';

var device;
var userAgent;

// Private Utility Functions
// -------------------------

// Simple UA string search
function uaFind(needle) {
    return userAgent.indexOf(needle) !== -1;
}

device = {};

// The client user agent string.
// Lowercase, so we can use the more efficient indexOf(), instead of Regex
userAgent = window.navigator.userAgent.toLowerCase();

// Main functions
// --------------

device.ios = function () {
    return device.iphone() || device.ipod() || device.ipad();
};

device.iphone = function () {
    return !device.windows() && uaFind('iphone');
};

device.ipod = function () {
    return uaFind('ipod');
};

device.ipad = function () {
    return uaFind('ipad');
};

device.android = function () {
    return !device.windows() && uaFind('android');
};

device.androidPhone = function () {
    return device.android() && uaFind('mobile');
};

device.androidTablet = function () {
    return device.android() && !uaFind('mobile');
};

device.blackberry = function () {
    return uaFind('blackberry') || uaFind('bb10') || uaFind('rim');
};

device.blackberryPhone = function () {
    return device.blackberry() && !uaFind('tablet');
};

device.blackberryTablet = function () {
    return device.blackberry() && uaFind('tablet');
};

device.windows = function () {
    return uaFind('windows');
};

device.windowsPhone = function () {
    return device.windows() && uaFind('phone');
};

device.windowsTablet = function () {
    return device.windows() && (uaFind('touch') && !device.windowsPhone());
};

device.fxos = function () {
    return (uaFind('(mobile;') || uaFind('(tablet;')) && uaFind('; rv:');
};

device.fxosPhone = function () {
    return device.fxos() && uaFind('mobile');
};

device.fxosTablet = function () {
    return device.fxos() && uaFind('tablet');
};

device.meego = function () {
    return uaFind('meego');
};

device.mobile = function () {
    return device.androidPhone() || device.iphone() || device.ipod()
    || device.windowsPhone() || device.blackberryPhone() || device.fxosPhone() || device.meego();
};

device.tablet = function () {
    return device.ipad() || device.androidTablet() || device.blackberryTablet()
    || device.windowsTablet() || device.fxosTablet();
};

device.desktop = function () {
    return !device.tablet() && !device.mobile();
};

module.exports = device;

},{}],"/wrapper/pktf1/specs/system/dfp-auto/partners/partner.spec.js":[function(require,module,exports){
'use strict';

// =============================================================================
// IMPORTS /////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

var UrlParse = require('url-parse');

var BaseConfigs = require('../../../../helpers/base-configs');
var Device = require('../../../../libs/external/device');
var GptPageMaker = require('../../../../helpers/gpt-page-maker');
var Hacks = require('../../../../helpers/hacks');
var HeaderStatsAuditor = require('../../../../helpers/header-stats-auditor');
var RenderChecker = require('../../../../helpers/render-checker');
var XhrFilter = require('../../../../helpers/xhr-filter');
var Utility = require('../../../../helpers/utilities');
var PreGptShell = require('pre-gpt-shell.js');

// =============================================================================
// MAIN ////////////////////////////////////////////////////////////////////////
// -----------------------------------------------------------------------------

describe('System Tests: Partner', function () {

    var server = null;
    var xhrFilter = null;
    var gptPage = null;
    var baseConfig = null;
    var partnerId = window.testCases.getPartnerId();
    var callbackType = window.testCases.getCallbackType();
    var architecture = window.testCases.getArchitecture();
    var defaultCreative = '<div id="default-creative"></div>';

    var partner = null;

    if (Device.mobile()) {

        partner = {
            getStatsId: window.testCases.getStatsIdMobile || window.testCases.getStatsId,
            getConfig: window.testCases.getConfigMobile || window.testCases.getConfig,
            getBidRequestRegex: window.testCases.getBidRequestRegexMobile || window.testCases.getBidRequestRegex,
            validateBidRequest: window.testCases.validateBidRequestMobile || window.testCases.validateBidRequest,
            getValidResponse: window.testCases.getValidResponseMobile || window.testCases.getValidResponse,
            getPassResponse: window.testCases.getPassResponseMobile || window.testCases.getPassResponse,
            getValidResponseWithDeal: window.testCases.getValidResponseWithDealMobile
                || window.testCases.getValidResponseWithDeal,
            validateBidRequestWithPrivacy: window.testCases.validateBidRequestWithPrivacyMobile
                || window.testCases.validateBidRequestWithPrivacy,
            validateBidRequestWithGdpr: window.testCases.validateBidRequestWithGdprMobile
                || window.testCases.validateBidRequestWithGdpr,
            validateBidRequestWithUspapi: window.testCases.validateBidRequestWithUspapiMobile
                || window.testCases.validateBidRequestWithUspapi,
            validateBidRequestWithTcf2: window.testCases.validateBidRequestWithTcf2Mobile
            || window.testCases.validateBidRequestWithTcf2,
            validateBidRequestWithAdSrvrOrg: window.testCases.validateBidRequestWithAdSrvrOrgMobile
                || window.testCases.validateBidRequestWithAdSrvrOrg
        };

    } else {

        partner = {
            getStatsId: window.testCases.getStatsId,
            getConfig: window.testCases.getConfig,
            getBidRequestRegex: window.testCases.getBidRequestRegex,
            validateBidRequest: window.testCases.validateBidRequest,
            getValidResponse: window.testCases.getValidResponse,
            getPassResponse: window.testCases.getPassResponse,
            getValidResponseWithDeal: window.testCases.getValidResponseWithDeal,
            validateBidRequestWithPrivacy: window.testCases.validateBidRequestWithPrivacy,
            validateBidRequestWithGdpr: window.testCases.validateBidRequestWithGdpr,
            validateBidRequestWithUspapi: window.testCases.validateBidRequestWithUspapi,
            validateBidRequestWithTcf2: window.testCases.validateBidRequestWithTcf2,
            validateBidRequestWithAdSrvrOrg: window.testCases.validateBidRequestWithAdSrvrOrg
        };

    }

    var statsId = partner.getStatsId();
    var config = partner.getConfig();
    var bidRequestRegex = partner.getBidRequestRegex();

    function checkPrivacyTestExists() {

        if (partner.validateBidRequestWithPrivacy
             || partner.validateBidRequestWithGdpr
              || partner.validateBidRequestWithUspapi
               || partner.validateBidRequestWithTcf2) {

            return true;

        }

        return false;

    }

    if (architecture === 'MRA') {

        if (Device.mobile()) {

            config.mapping = {
                htSlotMobileA: ['1']
            };

        } else {

            config.mapping = {
                htSlotDesktopA: ['1']
            };

        }

    } else {

        if (Device.mobile()) {

            config.mapping = {
                htSlotMobileA: ['1', '2']
            };

        } else {

            config.mapping = {
                htSlotDesktopA: ['1', '2']
            };

        }

    }

    function setUpGSlots() {

        gptPage.addGSlot({
            adUnitPath: GptPageMaker.AD_UNIT_PATHS.SAFEFRAME_PRICE,
            sizes: [[1, 1]],
            divId: 'divIdA'
        });

    }

    beforeEach(function () {

        // Create a Sinon fake server. This is a high-level approach to managing
        // Sinon's fake XHR. By invoking this functions, both a management
        // interface (i.e. the server) is created, and the XHR is taken over.
        server = sinon.createFakeServer();
        server.autoRespond = true;

        // Add the filtering mechanism to the server's fake XHR instance so that
        // it only captures and fakes explicitly configured URLs.
        xhrFilter = XhrFilter.install(server.xhr);
        xhrFilter.register(partnerId, 'bidRequest', bidRequestRegex);

        // SpaceCamp needs to be reset on every instantiation of the wrapper
        // because it is just an object. It carries values between test
        // cases.
        Hacks.resetSpaceCamp();

        // Clear localStorage artifacts from previous tests do not affect new ones.
        localStorage.clear();

        // Clear any CMP related data.
        delete window.__cmp;
        delete window.__tcfapi;

        // Load the DfpAuto base configs for each test case.
        baseConfig = BaseConfigs.getConfig('DfpAuto');

        // Set the SRA/DIL flags explicitly for all the tests in this suite.
        baseConfig.gptLayer.enableSingleRequest = true;
        baseConfig.gptLayer.disableInitialLoad = false;

        // Set `window.configs` to point to the config because that is where the
        // wrapper loads the config from.
        window.configs = baseConfig.config;

        // Create a new instance of GPT for each test case.
        gptPage = GptPageMaker(window, {
            enableSingleRequest: true,
            disableInitialLoad: false
        });

        gptPage.ready().then(function () {

            gptPage.setPageLevelTargeting('PARTNER_ID', partnerId);
            gptPage.setPageLevelTargeting('EXPECTED_PRICE', '200');

        });

        // Block network requests that partner doesn't want to reach production endpoint
        if (window.testCases.getRequestsToBlock) {

            var requestsToBlock = window.testCases.getRequestsToBlock();
            for (var request in requestsToBlock) {

                if (!requestsToBlock.hasOwnProperty(request)) {

                    continue;

                }

                xhrFilter.register(partnerId, request, requestsToBlock[request]);
                xhrFilter.capture(partnerId + '.' + request);

                server.respondWith(requestsToBlock[request].method,
                    requestsToBlock[request].urlRegex, function (xhr) {

                        xhr.respond(
                            200,
                            '',
                            '{}'
                        );

                    });

            }

        }

        // Explicitly select requests that should be captured and handled by the
        // internal fake server.
        xhrFilter.capture(partnerId + '.bidRequest');
        xhrFilter.capture('IndexExchangeHtb.headerstats');

        // Prevent headerstats requests going to production endpoint
        server.respondWith(XhrFilter.filters.IndexExchangeHtb.headerstats.method,
            XhrFilter.filters.IndexExchangeHtb.headerstats.urlRegex, function (xhr) {

                xhr.respond(
                    200,
                    '',
                    '{}'
                );

            });

        // Update the base configs for this test.
        baseConfig.partners.DynamicPartnerLoader.enabled = true;

        window.adapter = window.adapter || {};
        window.adapter.configs = config;

        // Instantiate wrapper.
        window.headertag = PreGptShell();

    });

    afterEach(function (done) {

        setTimeout(function () {

            // Clean up Sinon's fake server. Also explicitly reset
            // `server.xhr.filters` as otherwise the filters persist between tests.
            server.xhr.filters = [];
            server.restore();

            // Clean up any instantiated wrapper.
            window.headertag = null;

            // Clean up the GPT instance and any slots that were created in the DOM.
            gptPage.ready().then(function () {

                gptPage.unloadGpt();
                done();

            });

        }, 1000);

    });

    afterAll(function () {

        delete window.testCases;

    });

    it('should instantiate correctly', function () {

        expect(window.headertag[partnerId]).toBeDefined();

        // Check for bid callback function.
        if (callbackType === 'ID') {

            expect(window.headertag[partnerId].adResponseCallback).toBeDefined();

        } else if (callbackType === 'NAME') {

            expect(window.headertag[partnerId].adResponseCallbacks).toBeDefined();

        }

    });

    it('should construct bid request correctly', function (done) {

        // Load GPT library.
        gptPage.ready().then(function () {

            // Setup g-slots on the page.
            setUpGSlots();

            // Setup how the server handles the requests that are being filtered.
            server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                    // Parse request URL into a manageable object.
                    var request = UrlParse(xhr.url, true);
                    request.body = xhr.requestBody;

                    partner.validateBidRequest(request);

                    done();

                });

            // Start the bidding process.
            window.headertag.display('divIdA');

        });

    });

    if (checkPrivacyTestExists()) {

        describe('Privacy APIs JS', function () {

            // Before the update, partners have been using validateBidRequestWithPrivacy for their tests
            // Going forward, We do not expect partners to implement both test and
            // validateBidRequestWithGdpr should be implemented instead.
            // Added this check is in place for Partners that have not migrated to the new function
            if (partner.validateBidRequestWithPrivacy || partner.validateBidRequestWithGdpr) {

                it('should construct bid with GDPR privacy data correctly', function (done) {

                    window.__cmp = function (a, b, cb) {

                        cb({
                            gdprApplies: true,
                            consentData: 'TEST_GDPR_CONSENT_STRING'
                        });

                    };

                    // CMP data is only read on load. Since the wrapper is loaded in the
                    // `beforeEach`, it misses the `__cmp` that is set in this section,
                    // so the wrapper needs to be re-instantiated.
                    Hacks.resetSpaceCamp();
                    window.headertag = PreGptShell();

                    // Load GPT library.
                    gptPage.ready().then(function () {

                        // Setup g-slots on the page.
                        setUpGSlots();

                        // Setup how the server handles the requests that are being filtered.
                        server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                            XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                                // Parse request URL into a manageable object.
                                var request = UrlParse(xhr.url, true);
                                request.body = xhr.requestBody;

                                if (partner.validateBidRequestWithPrivacy) {

                                    partner.validateBidRequestWithPrivacy(request);

                                } else if (partner.validateBidRequestWithGdpr) {

                                    partner.validateBidRequestWithGdpr(request);

                                }

                                done();

                            });

                        // Start the bidding process.
                        window.headertag.display('divIdA');

                    });

                });

            }

            if (partner.validateBidRequestWithTcf2) {

                it('should construct bid with TCF2 privacy data correctly', function (done) {

                    window.__tcfapi = function (cmd, ver, cb) {

                        cb({
                            tcfPolicyVersion: 2,
                            tcString: 'TEST_TCF2_CONSENT_STRING',
                            gdprApplies: true
                        }, true);

                    };

                    Hacks.resetSpaceCamp();
                    window.headertag = PreGptShell();

                    // Load GPT library.
                    gptPage.ready().then(function () {

                        // Setup g-slots on the page.
                        setUpGSlots();

                        // Setup how the server handles the requests that are being filtered.
                        server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                            XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                                // Parse request URL into a manageable object.
                                var request = UrlParse(xhr.url, true);
                                request.body = xhr.requestBody;

                                partner.validateBidRequestWithTcf2(request);

                                done();

                            });

                        // Start the bidding process.
                        window.headertag.display('divIdA');

                    });

                });

            }

            if (partner.validateBidRequestWithUspapi) {

                it('should construct bid with USPAPI privacy data correctly', function (done) {

                    window.__uspapi = function (cmd, ver, cb) {

                        cb({
                            version: 1,
                            uspString: 'TEST_USPAPI_CONSENT_STRING'
                        }, true);

                    };

                    Hacks.resetSpaceCamp();
                    window.headertag = PreGptShell();

                    // Load GPT library.
                    gptPage.ready().then(function () {

                        // Setup g-slots on the page.
                        setUpGSlots();

                        // Setup how the server handles the requests that are being filtered.
                        server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                            XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                                // Parse request URL into a manageable object.
                                var request = UrlParse(xhr.url, true);
                                request.body = xhr.requestBody;

                                partner.validateBidRequestWithUspapi(request);

                                done();

                            });

                        // Start the bidding process.
                        window.headertag.display('divIdA');

                    });

                });

            }

        });

    }

    if (partner.validateBidRequestWithAdSrvrOrg) {

        it('should construct bid with adsrvr.org data correctly', function (done) {

            // Setup adsrvr.org identity data.
            var now = (new Date()).getTime();
            localStorage.setItem(
                'IXWRAPPERAdserverOrgIp',
                JSON.stringify({
                    t: now,
                    d: {
                        version: 'lolwut',
                        response: 'match',
                        data: {
                            TDID: 'TEST_ADSRVR_ORG_STRING',
                            source: 'adserver.org',
                            uids: [
                                {
                                    id: 'TEST_ADSRVR_ORG_STRING',
                                    ext: {
                                        rtiPartner: 'TDID'
                                    }
                                }
                            ]
                        }
                    },
                    e: now + 604800000
                })
            );

            // Base config has `AdserverOrgIp` disabled and wrapper is already
            // by this point, so we need to enable it and reload the wrapper.
            baseConfig.config.Layers[3].configs.partners.AdserverOrgIp.enabled = true;

            Hacks.resetSpaceCamp();
            window.headertag = PreGptShell();

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        // Parse request URL into a manageable object.
                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;

                        partner.validateBidRequestWithAdSrvrOrg(request);

                        done();

                    });

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

    }

    describe('Open Market Bids', function () {

        it('should set targeting correctly', function (done) {

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        // Parse request URL into a manageable object.
                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;
                        var response = partner.getValidResponse(request, defaultCreative);

                        xhr.respond(
                            200,
                            '',
                            response
                        );

                    });

                // Overwrite the `googletag.display` function to use as a trigger to know when
                // to start the check for the targeting.
                window.googletag.display = function () {

                    var gSlots = gptPage.getSlotsMap();

                    window.testCases.validateTargeting(gSlots.divIdA.getTargetingMap());

                    done();

                };

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

        it('should render ads correctly (SAFEFRAME_PRICE)', function (done) {

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Set up render checking mechanism that will trigger when two ads have rendered
                // using the post message method.
                var checker = RenderChecker.dfpPostMessageRender(1);
                checker.promise.then(function () {

                    done();

                });

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        // Parse request URL into a manageable object.
                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;

                        // Respond to the request.
                        var response = partner.getValidResponse(request, checker.adm);

                        xhr.respond(
                            200,
                            '',
                            response
                        );

                    });

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

        if (window.testCases.getPixelRequests) {

            it('should fire render pixel correctly', function (done) {

                // Load GPT library.
                gptPage.ready().then(function () {

                    // Setup g-slots on the page.
                    setUpGSlots();

                    // Setup how the server handles the requests that are being filtered.
                    server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                        XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                            // Parse request URL into a manageable object.
                            var request = UrlParse(xhr.url, true);
                            request.body = xhr.requestBody;

                            // Respond to the request.
                            var response = partner.getValidResponse(request, defaultCreative);

                            xhr.respond(
                                200,
                                '',
                                response
                            );

                        });

                    var pixelRequests = window.testCases.getPixelRequests();
                    var promises = [];

                    for (var pixelRequest in pixelRequests) {

                        if (pixelRequests.hasOwnProperty(pixelRequest)) {

                            continue;

                        }

                        xhrFilter.register(partnerId, pixelRequest, pixelRequests[pixelRequest]);
                        xhrFilter.capture(partnerId + '.' + pixelRequest);

                        (function () {

                            var defer = Utility.defer();
                            server.respondWith(XhrFilter.filters[partnerId][pixelRequest].method,
                                XhrFilter.filters[partnerId][pixelRequest].urlRegex, function (xhr) {

                                    // Parse request URL into a manageable object.
                                    var pixel = UrlParse(xhr.url, true);

                                    defer.resolve(pixel);

                                });

                            promises.push(defer.promise);

                        })();

                    }

                    Promise.all(promises).then(function (values) {

                        window.testCases.validatePixelRequests(values);

                        done();

                    });

                    // Start the bidding process.
                    window.headertag.display('divIdA');

                });

            });

        }

        it('should log headerstats events correctly for a valid response', function (done) {

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        // Parse request URL into a manageable object.
                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;
                        var response = partner.getValidResponse(request, defaultCreative);

                        xhr.respond(
                            200,
                            '',
                            response
                        );

                    });

                server.respondWith(XhrFilter.filters.IndexExchangeHtb.headerstats.method,
                    XhrFilter.filters.IndexExchangeHtb.headerstats.urlRegex, function (xhr) {

                        // Check to see bid requests out is equal to bid responses/passes/errors/timeouts.
                        expect(HeaderStatsAuditor.isBalanced(xhr.requestBody)).toBe(true);

                        // Check to see that the correct HeaderStats events are set for this specific case.
                        var htSlotStats = HeaderStatsAuditor.parse(xhr.requestBody).htSlotStats;
                        var count = 0;

                        for (var key in htSlotStats) {

                            // Data and identity are special slot-level properties, where this is expecting htSlotIds;
                            // See https://confluence.indexexchange.com/display/WRAP/Headerstats+-+Live
                            if (!htSlotStats.hasOwnProperty(key) || key === 'data' || key === 'identity') {

                                continue;

                            }

                            count = config.mapping[key.slice(0, -2)].length;

                            expect(htSlotStats[key][statsId].brq).toBe(count);
                            expect(htSlotStats[key][statsId].brs).toBe(count);

                        }

                        done();

                    });

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

    });

    if (partner.getValidResponseWithDeal) {

        describe('Private Market Bids', function () {

            it('should set targeting correctly', function (done) {

                // Load GPT library.
                gptPage.ready().then(function () {

                    // Setup g-slots on the page.
                    setUpGSlots();

                    // Setup how the server handles the requests that are being filtered.
                    server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                        XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                            // Parse request URL into a manageable object.
                            var request = UrlParse(xhr.url, true);
                            request.body = xhr.requestBody;
                            var response = partner.getValidResponseWithDeal(request, defaultCreative);

                            xhr.respond(
                                200,
                                '',
                                response
                            );

                        });

                    // Overwrite the `googletag.display` function to use as a trigger to know when
                    // to start the check for the targeting.
                    window.googletag.display = function () {

                        var gSlots = gptPage.getSlotsMap();

                        window.testCases.validateTargetingWithDeal(gSlots.divIdA.getTargetingMap());

                        done();

                    };

                    // Start the bidding process.
                    window.headertag.display('divIdA');

                });

            });

        });

    }

    describe('Passes', function () {

        it('should not set targeting', function (done) {

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;
                        var response = partner.getPassResponse(request);

                        xhr.respond(
                            200,
                            '',
                            response
                        );

                    });

                // Overwrite the `googletag.display` function to use as a trigger to know when
                // to start the check for the targeting.
                window.googletag.display = function () {

                    var gSlots = gptPage.getSlotsMap();

                    expect(gSlots.divIdA.getTargetingMap()).toEqual({});

                    done();

                };

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

        it('should log headerstats events correctly for a pass response', function (done) {

            // Load GPT library.
            gptPage.ready().then(function () {

                // Setup g-slots on the page.
                setUpGSlots();

                // Setup how the server handles the requests that are being filtered.
                server.respondWith(XhrFilter.filters[partnerId].bidRequest.method,
                    XhrFilter.filters[partnerId].bidRequest.urlRegex, function (xhr) {

                        var request = UrlParse(xhr.url, true);
                        request.body = xhr.requestBody;
                        var response = partner.getPassResponse(request);

                        xhr.respond(
                            200,
                            '',
                            response
                        );

                    });

                server.respondWith(XhrFilter.filters.IndexExchangeHtb.headerstats.method,
                    XhrFilter.filters.IndexExchangeHtb.headerstats.urlRegex, function (xhr) {

                        // Check to see bid requests out is equal to bid responses/passes/errors/timeouts.
                        expect(HeaderStatsAuditor.isBalanced(xhr.requestBody)).toBe(true);

                        // Check to see that the correct HeaderStats events are set for this specific case.
                        var htSlotStats = HeaderStatsAuditor.parse(xhr.requestBody).htSlotStats;
                        var count = 0;

                        for (var key in htSlotStats) {

                            // Data and identity are special slot-level properties, where this is expecting htSlotIds;
                            // See https://confluence.indexexchange.com/display/WRAP/Headerstats+-+Live
                            if (!htSlotStats.hasOwnProperty(key) || key === 'data' || key === 'identity') {

                                continue;

                            }

                            count = config.mapping[key.slice(0, -2)].length;

                            expect(htSlotStats[key][statsId].brq).toBe(count);
                            expect(htSlotStats[key][statsId].bp).toBe(count);

                        }

                        done();

                    });

                // Start the bidding process.
                window.headertag.display('divIdA');

            });

        });

    });

});

},{"../../../../helpers/base-configs":"/wrapper/pktf1/helpers/base-configs.js","../../../../helpers/gpt-page-maker":"/wrapper/pktf1/helpers/gpt-page-maker.js","../../../../helpers/hacks":"/wrapper/pktf1/helpers/hacks.js","../../../../helpers/header-stats-auditor":"/wrapper/pktf1/helpers/header-stats-auditor.js","../../../../helpers/render-checker":"/wrapper/pktf1/helpers/render-checker.js","../../../../helpers/utilities":"/wrapper/pktf1/helpers/utilities.js","../../../../helpers/xhr-filter":"/wrapper/pktf1/helpers/xhr-filter.js","../../../../libs/external/device":17,"pre-gpt-shell.js":"/wrapper/src/shells/pre-gpt-shell.js","url-parse":16}],"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js":[function(require,module,exports){

},{}],"/wrapper/pktf1/stubs/libs/browser.stub.js":[function(require,module,exports){
'use strict';

module.exports = {
    'browser.js': {
        getPageUrl: function () {
            return '';
        },
        getProtocol: function () {
            return 'http:';
        },
        getReferrer: function () {
            return '';
        },
        isTopFrame: function () {
            return true;
        }
    }
};

},{}],"/wrapper/pktf1/stubs/libs/cache.stub.js":[function(require,module,exports){
'use strict';

module.exports = {
    'cache.js': {
        getEntry: function () {
            return null;
        },
        deleteData: function () {
            return true;
        },
        getData: function () {
            return null;
        },
        setData: function () {
            return true;
        }
    }
};

},{}],"/wrapper/pktf1/stubs/libs/classify.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/command-queue.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/config-validators.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/constants.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/device-type-checker.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/gpt-helper.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/header-tag-slot.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/ht-slot-mapper.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/network.stub.js":[function(require,module,exports){
'use strict';

var System = require('system.js');

module.exports = {
    'network.js': {
        ajax: function (args) {
            if (typeof args.onSuccess === 'function') {
                args.onSuccess(null, System.now(), false);
            }

            return System.now();
        },
        buildUrl: function () {
            return '';
        },
        isXhrSupported: function () {
            return true;
        }
    }
};

},{"system.js":"/wrapper/src/libs/system.js"}],"/wrapper/pktf1/stubs/libs/openrtb.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/openrtb2_5.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/scribe.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/size.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/system.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/libs/utilities.stub.js":[function(require,module,exports){
'use strict';

module.exports = {
    'utilities.js': {
        isArray: function () {
            return true;
        }
    }
};

},{}],"/wrapper/pktf1/stubs/libs/whoopsie.stub.js":[function(require,module,exports){
arguments[4]["/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"][0].apply(exports,arguments)
},{"dup":"/wrapper/pktf1/stubs/libs/bid-transformer.stub.js"}],"/wrapper/pktf1/stubs/space-camp.stub.js":[function(require,module,exports){
'use strict';

module.exports = {
    'space-camp.js': {
        services: {
            PublisherSonarService: require('publisher-sonar-service.stub.js')(),
            EventsService: require('events-service.stub.js')(),
            ComplianceService: require('compliance-service.stub.js')(),
            RenderService: {
                registerPartner: function () {},
                registerAd: function () {}
            },
            TimerService: {
                addTimerCallback: function () {}
            }
        }
    }
};

},{"compliance-service.stub.js":"/wrapper/src/services/stubs/compliance-service.stub.js","events-service.stub.js":"/wrapper/src/services/stubs/events-service.stub.js","publisher-sonar-service.stub.js":"/wrapper/src/services/stubs/publisher-sonar-service.stub.js"}],"/wrapper/src/layers/direct-bidding-layer.js":[function(require,module,exports){
"use strict";function DirectBiddingLayer(e){function t(e,t){for(var s=[],o=0;o<e.length;o++){for(var n=!1,p=0;p<SpaceCamp.htSlots.length;p++)if(SpaceCamp.htSlots[p].getType()===HeaderTagSlot.SlotTypes.BANNER&&e[o].htSlotName===SpaceCamp.htSlots[p].getName()){n=!0;var c={htSlot:SpaceCamp.htSlots[p],ref:""};e[o].hasOwnProperty("firstPartyData")&&(c.firstPartyData=e[o].firstPartyData),s.push(c)}n||EventsService.emit("error","unrecognized header tag slot name "+e[o].htSlotName+" in call to retrieveDemand")}if(0===s.length)return EventsService.emit("warning","no valid header tag slots found in call to retrieveDemand"),{sessionId:"",promise:Prms.resolve({})};var m=r;if("undefined"!==Utilities.getType(t)&&t.hasOwnProperty("timeout"))m=t.timeout;else{"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(m=i);try{m=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(m)}catch(e){}}SpaceCamp.globalTimeout=m;var l=TimerService.createTimer(m,!0);return EventsService.emit("hs_session_start",{sessionId:l,timeout:m,sessionType:HeaderStatsService.SessionTypes.DISPLAY}),TimerService.addTimerCallback(l,function(){EventsService.emit("global_timeout_reached",{sessionId:l})}),{promise:a._executeNext(l,s).then(function(e){EventsService.emit("hs_session_end",{sessionId:l});for(var t={slot:{},page:[]},r=0;r<e.length;r++)if(!e[r].pass&&Utilities.isObject(e[r].targeting)&&!Utilities.isEmpty(e[r].targeting))if("slot"===e[r].targetingType){var i=e[r].htSlot.getName();t.slot.hasOwnProperty(i)||(t.slot[i]=[]),t.slot[i].push({targeting:e[r].targeting,price:e[r].price?e[r].price:0,adm:e[r].adm?e[r].adm:"",size:e[r].size?e[r].size:[],partnerId:e[r].partnerId?e[r].partnerId:"",winNotice:e[r].winNotice?e[r].winNotice:System.noOp})}else if("page"===e[r].targetingType){var a={targeting:e[r].targeting,partnerId:e[r].partnerId?e[r].partnerId:""};e.hasOwnProperty("price")&&(a.price=e[r].price),e.hasOwnProperty("adm")&&(a.adm=e[r].adm),t.page.push(a)}return t}),sessionId:l}}var r,i,a=Layer();!function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,r=e.desktopGlobalTimeout,i=e.mobileGlobalTimeout,"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()?SpaceCamp.globalTimeout=i:SpaceCamp.globalTimeout=r,a._setDirectInterface("DirectBiddingLayer",{retrieveDemand:t})}();var s={retrieveDemand:t};return Classify.derive(a,s)}var Classify=require("classify.js"),HeaderTagSlot=require("header-tag-slot.js"),Layer=require("layer.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),System=require("system.js"),HeaderStatsService=require("header-stats-service.js"),EventsService,TimerService;module.exports=DirectBiddingLayer;
},{"classify.js":"/wrapper/src/libs/classify.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","header-tag-slot.js":"/wrapper/src/libs/header-tag-slot.js","layer.js":"/wrapper/src/layers/layer.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/gpt-layer.js":[function(require,module,exports){
"use strict";function GptLayer(e){var t,r,__directInterface,s,i;return function(){t=Layer(),s=e.desktopGlobalTimeout,i=e.mobileGlobalTimeout,"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()?SpaceCamp.globalTimeout=i:SpaceCamp.globalTimeout=s,r={slotDemandHistory:{},desktopGlobalTimeout:s,mobileGlobalTimeout:i},__directInterface={};for(var a=0;a<GptLayerModules.length;a++)__directInterface=Utilities.mergeObjects(__directInterface,GptLayerModules[a](e,r,t._executeNext));t._setDirectInterface("GptLayer",__directInterface)}(),Classify.derive(t,{__baseClass:t,__state:r,__directInterface:__directInterface})}var Classify=require("classify.js"),Layer=require("layer.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),GptLayerModules=[require("gpt-set-targeting.js"),require("gpt-clear-targeting.js"),require("gpt-map-slots.js"),require("gpt-display.js"),require("gpt-refresh.js"),require("gpt-destroy-slots.js"),require("gpt-options.js")];module.exports=GptLayer;
},{"classify.js":"/wrapper/src/libs/classify.js","gpt-clear-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-clear-targeting.js","gpt-destroy-slots.js":"/wrapper/src/modules/gpt-layer/gpt-destroy-slots.js","gpt-display.js":"/wrapper/src/modules/gpt-layer/gpt-display.js","gpt-map-slots.js":"/wrapper/src/modules/gpt-layer/gpt-map-slots.js","gpt-options.js":"/wrapper/src/modules/gpt-layer/gpt-options.js","gpt-refresh.js":"/wrapper/src/modules/gpt-layer/gpt-refresh.js","gpt-set-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js","layer.js":"/wrapper/src/layers/layer.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/identity-layer.js":[function(require,module,exports){
"use strict";function IdentityLayer(e){function t(e,t){return f[e]=m.IN_PROGRESS,new Prms(function(r){t.instance.retrieve().then(function(){t.enableSetTargeting&&Utilities.isFunction(t.instance.getTargets)&&SpaceCamp.services.GptService.setIdentityTargeting(t.instance.getTargets())}).then(function(){f[e]=m.COMPLETE,r()}).catch(function(t){f[e]=m.COMPLETE,r()})})}function r(){for(var e=[],r=Prms.defer(),n=Object.keys(v);n.length;){var i=Utilities.randomSplice(n),s=v[i];if(s.enabled)try{e.push(t(i,s))}catch(e){}}return Prms.all(e).then(function(){r.resolve()}),r}function n(){for(var e in f)f.hasOwnProperty(e)&&f[e]!==m.COMPLETE&&EventsService.emit("hs_identity_timeout",{statsId:v[e].instance.getStatsId()})}function i(){var e={};for(var t in v)if(v.hasOwnProperty(t)){var r=v[t];if(r.enabled){var n=r.instance.getResults();n&&(e[t]={data:n})}}return e}function s(){l===m.NOT_STARTED&&(y=r(),l=m.IN_PROGRESS,y.promise.then(function(){n(),l=m.COMPLETE}),0===d?y.resolve():T||(T=TimerService.createTimer(d,!1,function(){y.resolve()})))}function a(){return l===m.NOT_STARTED?Prms.resolve(null):(l!==m.COMPLETE&&T&&TimerService.startTimer(T),y.promise.then(function(){return i()}))}function c(e,t){return a().then(function(r){if(r&&!Utilities.isEmpty(r))for(var n=0;n<t.length;n++)t[n].identityData=r;return u._executeNext(e,t)})}function o(){var e={};for(var t in v)if(v.hasOwnProperty(t)){var r=v[t];if(r.enabled){var n=r.instance.getResults();f[t]===m.COMPLETE?(e[t]=n?{data:n}:{data:{}},e[t].responsePending=!1):e[t]={data:{},responsePending:!0}}}return e}var u,v,l,f,d,T,y,m={NOT_STARTED:0,IN_PROGRESS:1,COMPLETE:2};return function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,u=Layer(),l=m.NOT_STARTED,f={},v=e.partners,d=e.timeout,EventsService.emit("hs_define_identity_timeout",{timeout:d});for(var t=Object.keys(v),n=t.length-1;n>=0;n--){var i=Utilities.randomSplice(t),T=v[i];if(T.enabled)try{var y=IdentityPartnerConstructors[i];if(Utilities.isObject(y)?T.instance=IdentityPartnerFactory(y,T.configs):T.instance=y(T.configs),!T.instance){T.enabled=!1;continue}f[i]=m.NOT_STARTED}catch(e){T.enabled=!1}}u._setDirectInterface("IdentityLayer",{retrieve:s,getResult:a,getIdentityResults:o,invokeAllPartners:r}),u._setExecutor(c)}(),Classify.derive(u,{__EnumStatuses:m,retrieve:s,getResult:a,__executor:c,__sendStatsTimeouts:n,__getAllPartnerResults:i,invokeAllPartners:r,__partnerCaller:t})}var Classify=require("classify.js"),Layer=require("layer.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),IdentityPartnerFactory=require("identity-partner-factory"),IdentityPartnerConstructors={AdserverOrgIp:require("adserver-org-ip.js")},EventsService,TimerService;module.exports=IdentityLayer;
},{"adserver-org-ip.js":"/wrapper/src/modules/identity-layer/adserver-org-ip/adserver-org-ip.js","classify.js":"/wrapper/src/libs/classify.js","identity-partner-factory":"/wrapper/src/modules/identity-layer/identity-partner-factory.js","layer.js":"/wrapper/src/layers/layer.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/layers/layer.js":[function(require,module,exports){
"use strict";function Layer(){function e(e,r){return Prms.resolve(r)}function r(e,r){__directInterface={},__directInterface[e]=r}function t(e){i=e}function n(){return __directInterface}function u(e){s=e}function o(e,r){return s(e,r)}function c(e,r){return Prms.resolve().then(function(){return i(e,r)})}var __directInterface,i,s;return function(){__directInterface=null,i=e,s=e}(),{__layerLoopBack:e,_setDirectInterface:r,_setExecutor:t,_executeNext:o,setNext:u,getDirectInterface:n,execute:c}}var Prms=require("prms.js"),Whoopsie=require("whoopsie.js");module.exports=Layer;
},{"prms.js":"/wrapper/src/libs/external/prms.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/mediation-layer.js":[function(require,module,exports){
"use strict";function MediationLayer(e){function t(e,t){return r._executeNext(e,t).then(function(t){for(var r={slot:{},partner:{}},i=[],a=t.slice();t.length;){var n=Utilities.randomSplice(t);if(n.htSlot){var o=n.htSlot.getName();n.pass||(n.hasOwnProperty("price")&&Utilities.isNumber(n.price)?(r.slot.hasOwnProperty(o)?r.slot[o].price<n.price&&(r.slot[o]=n):r.slot[o]=n,s===Constants.MediationLevels.PARTNER&&(r.partner[o]=r.partner[o]||{},r.partner[o].hasOwnProperty(n.partnerId)?r.partner[o][n.partnerId].price<n.price&&(r.partner[o][n.partnerId]=n):r.partner[o][n.partnerId]=n)):s===Constants.MediationLevels.PARTNER&&i.push(n))}}for(var p in r.slot)if(r.slot.hasOwnProperty(p)){var l=r.slot[p];if(EventsService.emit("hs_slot_highest_bid",{sessionId:e,statsId:l.partnerStatsId,htSlotId:l.htSlot.getId(),requestId:l.requestId,xSlotNames:[l.xSlotName]}),s===Constants.MediationLevels.HT_SLOT)i.push(l);else if(s===Constants.MediationLevels.PARTNER)for(var c in r.partner[p])r.partner[p].hasOwnProperty(c)&&i.push(r.partner[p][c])}return s===Constants.MediationLevels.NONE?a:i})}var r,s;return function(){EventsService=SpaceCamp.services.EventsService,r=Layer(),r._setExecutor(t),s=Constants.MediationLevels[e.mediationLevel]}(),Classify.derive(r,{__executor:t})}var Classify=require("classify.js"),Layer=require("layer.js"),Constants=require("constants.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),SpaceCamp=require("space-camp.js"),EventsService;module.exports=MediationLayer;
},{"classify.js":"/wrapper/src/libs/classify.js","constants.js":"/wrapper/src/libs/constants.js","layer.js":"/wrapper/src/layers/layer.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/partners-layer.js":[function(require,module,exports){
"use strict";function PartnersLayer(r){function e(r){var e=[];for(var t in r)if(r.hasOwnProperty(t)){var i=r[t].priority;Utilities.isInteger(i)||(i=Constants.DEFAULT_PARTNER_PRIORITY),e[i]=e[i]||[],e[i].push(t)}var n=[];return e.forEach(function(r){Utilities.shuffle(r),r.forEach(function(r){n.push(r)})}),n}function t(r,e,t,i,n){if(n&&t.getPrefetchDisabled())return[];var s=i.slice(),a=[],o=t.retrieve(r,s),c=o.map(function(r){var e=Prms.defer();return r.then(function(r){e.resolve(r)}).catch(function(r){e.resolve([])}),e});return Utilities.appendToArray(a,c),a}function i(r,i,n){for(var s={defers:[],promises:[]},a=e(o),c=0;c<a.length;c++){var f=a[c],u=o[f];if(u.enabled)try{for(var l=t(r,f,u.instance,i,n),p=0;p<l.length;p++)s.defers.push(l[p]),s.promises.push(l[p].promise)}catch(r){}}return s}function n(r){for(var e in r)if(r.hasOwnProperty(e)&&c.hasOwnProperty(e))for(var t=c[e],i=0;i<t.length;i++){var n=t[i];o.hasOwnProperty(n)&&o[n].instance.setFirstPartyData(r[e])}}function s(r,e){var t=i(r,e);return TimerService.addTimerCallback(r,function(){for(var r=0;r<t.defers.length;r++)t.defers[r].resolve([])}),Prms.all(t.promises).then(function(e){return TimerService.clearTimer(r),e?Utilities.mergeArrays.apply(null,e):[]})}var a,o,c={rubicon:["RubiconHtb","RubiconExtHtb"]};return function(){TimerService=SpaceCamp.services.TimerService,a=Layer(),o=r.partners;for(var t={},i=e(o),c=0;c<i.length;c++){var f=i[c],u=o[f];if(u.enabled){u.configs.bidTransformerTypes={};try{if(r.hasOwnProperty("bidTransformerTypes")&&(u.configs.bidTransformerTypes=Utilities.deepCopy(r.bidTransformerTypes)),u.instance=PartnerConstructors[f](u.configs,f),!u.instance){u.enabled=!1;continue}u.instance.getDirectInterface()&&(t=Utilities.mergeObjects(t,u.instance.getDirectInterface()))}catch(r){u.enabled=!1}}}var l={Partners:t,setFirstPartyData:n};a._setDirectInterface("PartnersLayer",l),a._setExecutor(s)}(),Classify.derive(a,{__partners:o,__partnerCaller:t})}var Classify=require("classify.js"),Layer=require("layer.js"),Constants=require("constants.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),PartnerConstructors={DynamicPartnerLoader:require("dynamic-partner-loader.js")},TimerService;module.exports=PartnersLayer;
},{"classify.js":"/wrapper/src/libs/classify.js","constants.js":"/wrapper/src/libs/constants.js","dynamic-partner-loader.js":"/wrapper/src/modules/partners-layer/dynamic-partner-loader/dynamic-partner-loader.js","layer.js":"/wrapper/src/layers/layer.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/post-gpt-layer.js":[function(require,module,exports){
"use strict";function PostGptLayer(e){function t(e){var t=System.generateUniqueId(),i=document.createElement("div");i.id=t,document.body.appendChild(i);var s=GptHelper.loadGpt();s.cmd.push(function(){window.parent.googletag.pubads().getTargetingKeys().map(function(e){s.pubads().setTargeting(e,window.parent.googletag.pubads().getTargeting(e))});var i=e.getAdUnitPath(),a=[];e.getSizes().map(function(e){a.push([e.getWidth(),e.getHeight()])});var n=e.getTargetingMap(),o=s.defineSlot(i,a,t).addService(s.pubads());for(var p in n)n.hasOwnProperty(p)&&o.setTargeting(p,n[p]);o.setTargeting(r.key,r.value),s.enableServices(),s.display(t)})}function i(e,i,r){return Prms.resolve().then(function(){var p=a;"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(p=n);try{p=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(p)}catch(e){}SpaceCamp.globalTimeout=p;var c=TimerService.createTimer(p,!0);TimerService.addTimerCallback(c,function(){EventsService.emit("global_timeout_reached",{sessionId:c})});var g=SpaceCamp.htSlots,l=[{reference:e}];l[0].divId=e.getSlotElementId();for(var m={},u=e.getTargetingKeys(),v=0;v<u.length;v++)m[u[v]]=e.getTargeting(u[v]);var d=[],S=e.getSizes(Browser.getViewportWidth(),Browser.getViewportHeight())||e.getSizes();if(!S)return new Prms(function(i){t(e),i()});for(var h=0;h<S.length;h++)d.push([S[h].getWidth(),S[h].getHeight()]);l[0].sizes=d,l[0].targeting=m,l[0].adUnitPath=e.getAdUnitPath();var y=s.filter(g,l),T=s.select(y,l);return Utilities.isEmpty(T)?new Prms(function(i){t(e),i()}):(EventsService.emit("hs_session_start",{sessionId:c,timeout:p,sessionType:HeaderStatsService.SessionTypes.DISPLAY}),o._executeNext(c,T).then(function(s){if(EventsService.emit("hs_session_end",{sessionId:c}),0===s.length)return void t(e,c);i.width=s[0].size[0],i.height=s[0].size[1],i.removeAttribute("style"),r.width=s[0].size[0],r.height=s[0].size[1],SpaceCamp.services.RenderService.render(i.contentDocument,s[0].targeting.pubKitAdId)}))})}var r,s,a,n,o=Layer();!function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,r=e.lineItemDisablerTargeting,a=e.desktopGlobalTimeout,n=e.mobileGlobalTimeout,"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()?SpaceCamp.globalTimeout=n:SpaceCamp.globalTimeout=a,s=HtSlotMapper(e.slotMapping),o._setDirectInterface("PostGptLayer",{display:i})}();var p={__htSlotMapper:s,__lineItemDisablerTargeting:r,display:i,__displayFallbackAd:t};return Classify.derive(o,p)}var Browser=require("browser.js"),Classify=require("classify.js"),GptHelper=require("gpt-helper.js"),HtSlotMapper=require("ht-slot-mapper.js"),Layer=require("layer.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),HeaderStatsService=require("header-stats-service.js"),EventsService,TimerService;module.exports=PostGptLayer;
},{"browser.js":"/wrapper/src/libs/browser.js","classify.js":"/wrapper/src/libs/classify.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","ht-slot-mapper.js":"/wrapper/src/libs/ht-slot-mapper.js","layer.js":"/wrapper/src/layers/layer.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/layers/video-interface-layer.js":[function(require,module,exports){
"use strict";function VideoInterfaceLayer(e){function t(e,t){if(!Utilities.isObject(e))throw new Error("htSlotsParams must be an object");if(!Utilities.isObject(t))throw new Error("demandObjs must be an object");var r={},i=["iu","description_url","cust_params","sz"];for(var s in e)if(e.hasOwnProperty(s)){var a=e[s];if(!Utilities.isObject(a))throw new Error("htSlotsParams."+s+" must be an object");if(!a.hasOwnProperty("iu")||!Utilities.isString(a.iu)||Utilities.isEmpty(a.iu))throw new Error("htSlotsParams."+s+".iu must exist and must be a non empty string");if(!a.hasOwnProperty("description_url")||!Utilities.isString(a.description_url)||Utilities.isEmpty(a.description_url))throw new Error("htSlotsParams."+s+".description_url must exist and must be a non empty string");if(a.hasOwnProperty("sz")&&!Size.isSize(a.sz)&&!Size.isSizes(a.sz))throw new Error("htSlotsParams."+s+".sz must be in the format [width, height] or [[width, height], [width, height], ...]");if(a.hasOwnProperty("cust_params")){if(!Utilities.isObject(a.cust_params))throw new Error("htSlotsParams."+s+".cust_params must be an object");var o=a.cust_params;for(var n in o)if(o.hasOwnProperty(n)&&!Utilities.isArray(o[n],"string"))throw new Error("htSlotsParams."+s+".cust_params."+n+" must be an array of string")}for(var m in a)if(a.hasOwnProperty(m)&&-1===i.indexOf(m)){if(!Utilities.isString(a[m])&&!Utilities.isNumber(a[m]))throw new Error("htSlotsParams."+s+"."+m+" must be a string or number");if(Utilities.isString(a[m])&&Utilities.isEmpty(a[m]))throw new Error("htSlotsParams."+s+"."+m+" must be a non empty string or number")}var l=[];if(t.hasOwnProperty(s)){var u=t[s];if(!Utilities.isArray(u,"object"))throw new Error("demandObjs."+s+" must be an array of objects");for(var c=0;c<u.length;c++){if(!u[c].hasOwnProperty("size")||!Size.isSize(u[c].size))throw new Error("demandObjs."+s+"["+c+"].size must exist and must be an array of 2 numbers");if(u[c].hasOwnProperty("targeting")&&!Utilities.isObject(u[c].targeting))throw new Error("demandObjs."+s+"["+c+"].targeting must be an object")}try{l=Mvt.mediateVideoBids(u)}catch(e){}}else{var d=SpaceCamp.htSlotsMap;if(!d.hasOwnProperty(s)||d[s].getType()!==HeaderTagSlot.SlotTypes.INSTREAM_VIDEO)throw new Error("htSlotName "+s+" does not exist");l=[{size:d[s].getSizes(Browser.getViewportWidth(),Browser.getViewportHeight())[0]}]}try{r[s]=Mvt.buildDfpMvt(a,l)}catch(e){}}return r}function r(e,t,r){if(!Utilities.isFunction(t))throw new Error("callback must be a function");if(!Utilities.isArray(e,"object"))return t({},new Error("htSlotVideoDemandObjs must be an array of objects")),!1;for(var i=0;i<e.length;i++){var s=e[i];if(!s.hasOwnProperty("htSlotName"))return t({},new Error("htSlotVideoDemandObjs["+i+"]: members must contain the htSlotName property")),!1;if(!Utilities.isString(s.htSlotName))return t({},new Error("htSlotVideoDemandObjs["+i+"]: htSlotName must be a string")),!1}if("undefined"!==Utilities.getType(r)){if(!Utilities.isObject(r))return t({},new Error("options must be an object")),!1;if(r.hasOwnProperty("timeout")&&(!Utilities.isInteger(r.timeout)||r.timeout<0))return t({},new Error("options.timeout must be an integer greater than 0")),!1}return!0}function i(e,t){for(var r=[],i=0;i<e.length;i++){for(var s=!1,m=0;m<SpaceCamp.htSlots.length;m++)if(SpaceCamp.htSlots[m].getType()===HeaderTagSlot.SlotTypes.INSTREAM_VIDEO&&e[i].htSlotName===SpaceCamp.htSlots[m].getName()){s=!0;var l={htSlot:SpaceCamp.htSlots[m],ref:""};r.push(l)}s||EventsService.emit("error","unrecognized header tag slot name "+e[i].htSlotName+" in call to retrieveVideoDemand")}if(0===r.length)return EventsService.emit("warning","no valid header tag slots found in call to retrieveVideoDemand"),{sessionId:"",promise:Prms.resolve({})};var u=a;if("undefined"!==Utilities.getType(t)&&t.hasOwnProperty("timeout"))u=t.timeout;else{"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(u=o);try{u=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(u)}catch(e){}}SpaceCamp.globalTimeout=u;var c=TimerService.createTimer(u,!0);return EventsService.emit("hs_session_start",{sessionId:c,timeout:u,sessionType:HeaderStatsService.SessionTypes.VIDEO}),TimerService.addTimerCallback(c,function(){EventsService.emit("global_timeout_reached",{sessionId:c})}),{promise:n._executeNext(c,r).then(function(e){EventsService.emit("hs_session_end",{sessionId:c});for(var t={},r=0;r<e.length;r++)if(!e[r].pass&&Utilities.isObject(e[r].targeting)&&!Utilities.isEmpty(e[r].targeting)&&"slot"!==!e[r].targetingType){var i={targeting:e[r].targeting,price:e[r].price?e[r].price:0,size:e[r].size?e[r].size:[],partnerId:e[r].partnerId?e[r].partnerId:"",adm:e[r].adm?e[r].adm:""};e[r].hasOwnProperty("dealId")&&(i.dealId=e[r].dealId);var s=e[r].htSlot.getName();t.hasOwnProperty(s)||(t[s]=[]),t[s].push(i)}return t}),sessionId:c}}function s(e,t){return n._executeNext(e,t)}var a,o,n=Layer();!function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,a=e.desktopVideoGlobalTimeout,o=e.mobileVideoGlobalTimeout,n._setExecutor(s),n._setDirectInterface("VideoInterfaceLayer",{buildGamMvt:t,retrieveVideoDemand:i,retrieveVideoDemandValidation:r})}();var m={buildGamMvt:t,retrieveVideoDemand:i,retrieveVideoDemandValidation:r};return Classify.derive(n,m)}var Classify=require("classify.js"),HeaderTagSlot=require("header-tag-slot.js"),Layer=require("layer.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),Mvt=require("mvt.js"),HeaderStatsService=require("header-stats-service.js"),Size=require("size.js"),Browser=require("browser.js"),EventsService,TimerService;module.exports=VideoInterfaceLayer;
},{"browser.js":"/wrapper/src/libs/browser.js","classify.js":"/wrapper/src/libs/classify.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","header-tag-slot.js":"/wrapper/src/libs/header-tag-slot.js","layer.js":"/wrapper/src/layers/layer.js","mvt.js":"/wrapper/src/libs/mvt.js","prms.js":"/wrapper/src/libs/external/prms.js","size.js":"/wrapper/src/libs/size.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/bid-transformer.js":[function(require,module,exports){
"use strict";function BidTransformer(e){function t(t){return e.roundingType===BidTransformer.RoundingTypes.FLOOR?Math.floor(t):t}function r(r){var o=0,s=1,u=r.toString(),a=u.indexOf(".");if(a>-1&&(o=u.length-a-1,u=u.slice(0,a)+u.slice(a+1)),o>=i)o-=i;else{var l=i-o;o=0,u=Utilities.padEnd(u,u.length+l,"0")}u.length>9&&(o-=u.length-9,u=u.slice(0,9)),s=Math.pow(10,o),u=Number(u);var p=e.buckets.length;if(u<e.floor*s)u=0;else if(u>=e.buckets[p-1].max*s)u=e.buckets[p-1].max*s;else{for(var d,c=e.floor,f=0;f<p&&(d=e.buckets[f],!(u<=d.max*s));f++)c=d.max;e.roundingType!==BidTransformer.RoundingTypes.NONE&&(u-=c*s,u/=d.step*s,u=t(u),u*=d.step*s,u+=c*s)}u=u.toString(),o+=n;var g=u.length-o;g<1&&(u=Utilities.padStart(u,u.length+(1-g),"0"),g=1);var h=u.slice(0,g);return 0!==e.outputPrecision&&(h=h+"."+u.slice(g),e.outputPrecision>0&&(h=o<e.outputPrecision?Utilities.padEnd(h,g+e.outputPrecision+1,"0"):h.slice(0,g+e.outputPrecision+1))),h}var i,n,o={floor:0,buckets:[{max:1/0,step:1}]};return function(){i=Math.round(Math.log(e.bidUnitInCents)*Math.LOG10E),n=Math.round(Math.log(e.outputCentsDivisor)*Math.LOG10E),e.roundingType=BidTransformer.RoundingTypes[e.roundingType];for(var t=["floor","buckets"],r=0;r<t.length;r++){var s=t[r];e.hasOwnProperty(s)||(e[s]=o[s])}}(),{apply:r}}var Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js");BidTransformer.RoundingTypes={NONE:0,FLOOR:1},module.exports=BidTransformer;
},{"utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/browser.js":[function(require,module,exports){
"use strict";function Browser(){function t(t,e){return t=t||"http:",e=e||"https:","https:"===document.location.protocol?e:t}function e(){return("CSS1Compat"===w.document.compatMode?w.document.documentElement:w.document.body).clientWidth}function n(){return("CSS1Compat"===w.document.compatMode?w.document.documentElement:w.document.body).clientHeight}function r(){return w.screen.width}function o(){return w.screen.height}function i(){return document.referrer}function a(){return w.location.hostname}function u(){return navigator.userAgent}function c(){return navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage}function l(){return w.location.pathname}function s(){try{return window.top===window.self}catch(t){return!1}}function g(){return s()?location.href:document.referrer||location.href}function d(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(t){return!1}}function h(t,e,n,r){try{for(var o,i=window,a=0;;)if(!(n&&a<n)){if(r&&a>r)break;if(t&&(o=t(i)))return o;var u;try{u=i.frameElement}catch(t){u=null}if(null===u){if(e&&(o=e(i)))return o;break}i=i.parent,a++}}catch(t){}return null}function m(t){return h(function(e){return e.hasOwnProperty(t)?e[t]:null})}function f(t,e){var n=e||w,r=n.document.createElement("iframe");return t&&(r.src=t),r.width=0,r.height=0,r.scrolling="no",r.marginWidth=0,r.marginHeight=0,r.frameBorder=0,r.setAttribute("style","border: 0px; vertical-align: bottom; visibility: hidden; display: none;"),n.document.body.appendChild(r),r}function p(t){var e=t+"=",n=w.document.cookie.split(";");for(var r in n)if(n.hasOwnProperty(r)){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e))return o.substring(e.length,o.length)}return null}function v(){var t=!1;try{new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(t=!0)}catch(e){navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(t=!0)}return t}var w;return function(){w=h(null,function(t){return t})}(),{topWindow:w,getProtocol:t,isLocalStorageSupported:d,getViewportWidth:e,getViewportHeight:n,isTopFrame:s,getScreenWidth:r,getScreenHeight:o,getReferrer:i,getPageUrl:g,getHostname:a,getUserAgent:u,getLanguage:c,getPathname:l,getNearestEntity:m,traverseContextTree:h,createHiddenIFrame:f,readCookie:p,isFlashSupported:v}}var Whoopsie=require("whoopsie.js");module.exports=Browser();
},{"whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/cache.js":[function(require,module,exports){
"use strict";function Cache(){function t(t){if(!i)return!1;try{localStorage.removeItem(u+t)}catch(t){return!1}return!0}function e(e){if(!i)return null;var r;try{r=JSON.parse(localStorage.getItem(u+e))}catch(t){return null}return null===r?null:!r.e||r.e<System.now()?(t(e),null):Utilities.isObject(r.d)?{data:r.d,created:r.t,expires:r.e}:null}function r(t){var r=e(t);return r&&r.data}function n(t,e,r){if(!i)return!1;r>l&&(r=l);var n=System.now(),a={t:n,d:e,e:n+r};try{localStorage.setItem(u+t,JSON.stringify(a))}catch(t){return!1}return!0}function a(t){i=t}var i,u="IXWRAPPER",l=6048e5;return function(){i=Browser.isLocalStorageSupported()}(),{setLocalStorageAvailability:a,deleteData:t,getEntry:e,getData:r,setData:n}}var Browser=require("browser.js"),Utilities=require("utilities.js"),System=require("system.js");module.exports=Cache();
},{"browser.js":"/wrapper/src/libs/browser.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/libs/classify.js":[function(require,module,exports){
"use strict";function Classify(){function r(r){for(var e in r)r.hasOwnProperty(e)&&"_"===e[0]&&"__"!==e.slice(0,2)&&delete r[e];return r}function e(e,o){var n,s={};for(n in e)e.hasOwnProperty(n)&&(s[n]=e[n]);for(n in o)o.hasOwnProperty(n)&&(s[n]=o[n]);return r(s)}return{__removeProtectedMembers:r,derive:e}}var Whoopsie=require("whoopsie.js");module.exports=Classify();
},{"whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/command-queue.js":[function(require,module,exports){
"use strict";function CommandQueue(i){function t(i){if(Utilities.isFunction(i))try{i()}catch(i){}}return function(){if(Utilities.isArray(i))for(var t=0;t<i.length;t++)try{i[t]()}catch(i){}}(),{push:t}}var Utilities=require("utilities.js");module.exports=CommandQueue;
},{"utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/libs/config-validators.js":[function(require,module,exports){
"use strict";var Constants=require("./constants.js"),Inspector=require("./external/schema-inspector.js"),ConfigValidators={PostGptLayer:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{lineItemDisablerTargeting:{type:"object",properties:{key:{type:"string",minLength:1},value:{type:"array",minLength:1,items:{type:"string"}}}},desktopGlobalTimeout:{type:"integer",gte:0},mobileGlobalTimeout:{type:"integer",gte:0},slotMapping:{type:"object"}}},e);return t.valid?null:t.format()},GptLayer:function(e){var t=Inspector.validate({type:"object",properties:{desktopGlobalTimeout:{type:"integer",gte:0},mobileGlobalTimeout:{type:"integer",gte:0},enableSingleRequest:{type:"boolean",optional:!0},disableInitialLoad:{type:"boolean",optional:!0},slotMapping:{optional:!0,type:"object",properties:{selectors:{type:"array",items:{type:["array","string"],minLength:1,items:{type:"string",minLength:1}}},filters:{type:"array",items:{type:"string",minLength:1}}}}}},e);return t.valid?null:t.format()},IdentityLayer:function(e,t){var r=Inspector.validate({type:"object",strict:!0,properties:{timeout:{type:"integer",gte:0,optional:!0},partners:{type:"object",properties:{"*":{type:"object",properties:{configs:{type:"object"},enabled:{type:"boolean"},enableSetTargeting:{type:"boolean",optional:!0}}}}}}},e);if(!r.valid)return r.format();for(var n in e.partners)if(e.partners.hasOwnProperty(n)&&-1===t.indexOf(n))return'Identity partner ID "'+n+'" is unrecognized';return null},PartnersLayer:function(e,t){var r=Inspector.validate({type:"object",strict:!0,properties:{prefetchOnLoad:{optional:!0,type:"object",strict:!0,properties:{enabled:{type:"boolean"},configs:{optional:!0,type:"object",strict:!0,properties:{dynamic:{optional:!0,type:"object",strict:!0,properties:{var:{optional:!0,type:"string",minLength:1},slotMapping:{type:"object",strict:!0,properties:{style:{type:"string",eq:["ALL","SINGLE"]},selectors:{type:"array",minLength:1,items:{type:["array","string"],minLength:1,items:{type:"string",minLength:1}}},filters:{type:"array",items:{type:"string",minLength:1}}}}}},pageType:{optional:!0,type:"object",strict:!0,properties:{var:{optional:!0,type:"string",minLength:1},mapping:{type:"object",strict:!0,properties:{"*":{type:"array",items:{type:"string",minLength:1}}}}}},fixed:{optional:!0,type:"object",strict:!0,properties:{htSlotNames:{type:"array",items:{type:"string",minLength:1}}}}}}}},bidTransformerTypes:{type:"object",optional:!0,properties:{"*":{type:"object",exec:function(e,t){if(t){var r=ConfigValidators.bidTransformerConfig(t);null!==r&&this.report(r)}}}}},partners:{type:"object",properties:{"*":{type:"object",properties:{configs:{type:"object"},enabled:{type:"boolean"}}}}}}},e);if(!r.valid)return r.format();for(var n in e.partners)if(e.partners.hasOwnProperty(n)&&-1===t.indexOf(n))return'Partner ID "'+n+'" is unrecognized';return null},DirectBiddingLayer:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{desktopGlobalTimeout:{type:"integer",gte:0},mobileGlobalTimeout:{type:"integer",gte:0}}},e);return t.valid?null:t.format()},VideoInterfaceLayer:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{desktopVideoGlobalTimeout:{type:"integer",gte:0},mobileVideoGlobalTimeout:{type:"integer",gte:0}}},e);return t.valid?null:t.format()},MediationLayer:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{mediationLevel:{type:"string",eq:["NONE","HT_SLOT","PARTNER"]}}},e);return t.valid?null:t.format()},PreGptLayer:function(){return null},StorageLayer:function(){return null},ModuleLoader:function(e,t,r){var n=Inspector.validate({type:"object",properties:{htSlots:{type:"object",optional:!0},Services:{type:"object",properties:{"*":{type:"object"}}},Layers:{type:"array",minLength:1,items:{type:"object",properties:{layerId:{type:"string",minLength:1},configs:{type:"object"}}}}}},e);if(!n.valid)return n.format();for(var i in e.Services)if(-1===t.indexOf(i))return"members of `configs.Services` must be one of the predefined values in `ServiceConstructors`";for(var o=0;o<e.Layers.length;o++)if(-1===r.indexOf(e.Layers[o].layerId))return"`configs.Layers["+o+"].layerId` must be one of the predefined values in `LayerConstructors`";return null},HeaderTagSlot:function(e,t){var r=Inspector.validate({type:"object",strict:!0,properties:{id:{type:"string"},divId:{optional:!0,type:"string"},adUnitPath:{optional:!0,type:"string"},sizeMapping:{optional:!0,type:"object",properties:{"*":{type:"array",minLength:1,items:{type:"array",exactLength:2,items:{type:"integer",gte:0}}}}},targeting:{optional:!0,type:"array",items:{type:"object",properties:{"*":{type:"array",minLength:1,items:{type:"string",minLength:1}}}}},deviceType:{optional:!0,type:"string",minLength:1},position:{type:"string",eq:["atf","btf"],optional:!0},type:{type:"string",eq:["INSTREAM_VIDEO","BANNER"]}}},e);if(!r.valid)return"Invalid config: "+r.format();if(r=Inspector.validate({type:"string",minLength:1},t),!r.valid)return"Invalid ID: "+r.format();if(!e.hasOwnProperty("sizeMapping"))return'`config` must have property "sizeMapping"';var n=/^(\d+)x(\d+)$/,i=0;for(var o in e.sizeMapping)if(e.sizeMapping.hasOwnProperty(o)){if(!1===n.test(o))return"Keys of `config.sizeMapping` must be of form `widthxheight`";i++}return 0===i?"`config.sizeMapping` must not be empty":null},PartnerProfile:function(e,t,r){var n=Inspector.validate({type:"object",strict:!0,properties:{profile:{type:"object",strict:!0,properties:{partnerId:{type:"string",minLength:1},namespace:{type:"string",minLength:1},statsId:{type:"string",minLength:1},version:{type:"string",minLength:1,optional:!0},targetingType:{type:"string",eq:["page","slot"]},bidUnitInCents:{type:"number",gt:0,optional:!0,exec:function(e,t){(t>1&&t%10!=0||t<1&&!/^0\.0*1$/.test(t.toString()))&&this.report("must be a power of 10")}},enabledAnalytics:{type:"object",properties:{"*":{type:"boolean"}}},features:{type:"object",properties:{"*":{type:"object",strict:!0,properties:{enabled:{type:"boolean"},value:{type:"any"}}},prefetchDisabled:{optional:!0,type:"object",strict:!0,properties:{enabled:{type:"boolean"}}}}},targetingKeys:{type:"object",strict:!0,properties:{id:{optional:!0,type:"string",minLength:1},om:{optional:!0,type:"string",minLength:1},pm:{optional:!0,type:"string",minLength:1},pmid:{optional:!0,type:"string",minLength:1},bidderKey:{optional:!0,type:"string",minLength:1},ybot_ad:{optional:!0,type:"string",minLength:1},ybot_size:{optional:!0,type:"string",minLength:1},ybot_cpm:{optional:!0,type:"string",minLength:1},ybot_slot:{optional:!0,type:"string",minLength:1},retargeter:{optional:!0,type:"string",minLength:1}}},lineItemType:{type:"integer",exec:function(e,t){var r=!1;for(var n in Constants.LineItemTypes)if(Constants.LineItemTypes.hasOwnProperty(n)&&Constants.LineItemTypes[n]===t){r=!0;break}r||this.report("must be one of the predefined values in `Constants.LineItemTypes`")}},callbackType:{type:"integer"},architecture:{type:"integer"},parseAfterTimeout:{type:"boolean",optional:!0},requestType:{type:"integer"}}},requiredResources:{type:["array","null"],items:{type:"string",minLength:1}},fns:{type:"object",exec:function(e,t){for(var r in t)t.hasOwnProperty(r)&&"function"!=typeof t[r]&&this.report(r+" must be a function, is "+typeof t[r]);t.hasOwnProperty("retriever")?(t.hasOwnProperty("parseResponse")||t.hasOwnProperty("generateRequestObj")||t.hasOwnProperty("adResponseCallback"))&&this.report("must either have retriever or the other three."):t.hasOwnProperty("parseResponse")||t.hasOwnProperty("generateRequestObj")||this.report("must either have retriever or the other three.")}}}},{profile:e,requiredResources:t,fns:r});return n.valid?null:n.format()},IdentityPartnerProfile:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{partnerId:{type:"string",minLength:1},statsId:{type:"string",minLength:1},version:{type:"string",pattern:/^\d+\.\d+\.\d+$/},source:{type:"string",minLength:1},cacheExpiry:{type:"object",strict:!0,properties:{match:{type:"integer",gt:0},pass:{type:"integer",gt:0},error:{type:"integer",gt:0}}},targetingKeys:{type:"object",strict:!0,properties:{exchangeBidding:{type:"string",minLength:1}}},consent:{type:"object",optional:!0,strict:!0,properties:{gdpr:{type:"string",minLength:1,optional:!0}},exec:function(e,t){t&&!Object.keys(t)&&this.report("must declare at least one consent type")}},sonar:{type:"object",strict:!0,optional:!0,properties:{enabled:{type:"boolean"},entrypoints:{type:"array",optional:!0,minLength:1,items:{type:"object",strict:!0,properties:{key:{type:"string",minLength:1,optional:!0},filter:{type:"object",strict:!0,properties:{attr:{type:"integer",gt:0,optional:!0},algo:{type:"integer",gt:0,optional:!0},impl:{type:"integer",gt:0,optional:!0},prov:{type:"string",minLength:1,optional:!0},name:{type:"string",minLength:1,optional:!0}}}}}}}}}},e);return t.valid?null:t.format()},IdentityPartnerModule:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{type:{type:"string",eq:"identity"},api:{type:"string",minLength:1},main:{exec:function(e,t){"function"!=typeof t&&this.report("must be a function")}},profile:{type:"object",exec:function(e,t){var r=ConfigValidators.IdentityPartnerProfile(t);r&&this.report(r)}}}},e);return t.valid?null:t.format()},partnerBaseConfig:function(e){var t=Inspector.validate({type:"object",properties:{timeout:{optional:!0,type:"integer",gte:0},xSlots:{type:"object",properties:{"*":{type:"object"}}},mapping:{type:"object",properties:{"*":{type:"array",items:{type:"string",minLength:1,exec:function(e,t){this.origin.xSlots&&!this.origin.xSlots.hasOwnProperty(t)&&this.report("`configs.mapping` must map htSlotsNames to partner slots defined in `configs.xSlots`")}}}}},targetingKeyOverride:{optional:!0,type:"object",properties:{"*":{type:"string",minLength:1}}},lineItemType:{type:"string",optional:!0,exec:function(e,t){t&&!Constants.LineItemTypes.hasOwnProperty(t)&&this.report(t+" must be one of the predefined values in `Constants.LineItemTypes`")}},bidTransformer:{type:"object",optional:!0,exec:function(e,t){if(t){var r=ConfigValidators.bidTransformerConfig(t);null!==r&&this.report(r)}}}}},e);return t.valid?null:t.format()},rtiPartnerBaseConfig:function(){return null},bidTransformerConfig:function(e){var t=Inspector.validate({type:"object",optional:!0,strict:!0,properties:{bidUnitInCents:{type:"number",gt:0,optional:!0,exec:function(e,t){(t>1&&t%10!=0||t<1&&!/^0\.0*1$/.test(t.toString()))&&this.report("must be a power of 10")}},outputCentsDivisor:{type:"number",gt:0,optional:!0,exec:function(e,t){(t>1&&t%10!=0||t<1&&!/^0\.0*1$/.test(t.toString()))&&this.report("must be a power of 10")}},outputPrecision:{type:"integer",gte:-1,optional:!0},roundingType:{type:"string",eq:["NONE","FLOOR"],optional:!0},floor:{type:"integer",gte:0,optional:!0},buckets:{type:"array",minLenth:1,items:{type:"object",properties:{max:{type:["integer","string"],gt:0,exec:function(e,t){"string"==typeof t&&"infinity"!==t&&this.report('The only acceptable string for bucket max is "infinity". Please check your config.')}},step:{type:"integer",gt:0}}},optional:!0}},exec:function(e,t){if(t){if(t.hasOwnProperty("floor")&&!t.hasOwnProperty("buckets")||!t.hasOwnProperty("floor")&&t.hasOwnProperty("buckets"))return void this.report("`configs.floor` and `configs.buckets` must be configured together");if(t.hasOwnProperty("floor")&&t.hasOwnProperty("buckets"))for(var r=t.floor,n=0;n<t.buckets.length;n++){var i=t.buckets[n].max,o=t.buckets[n].step;if("infinity"===i&&(i=1/0),i<=r)return void this.report("`configs.buckets["+n+"].max` is not in ascending order");if(i!==1/0&&(i-r)%o!=0)return void this.report("`configs.buckets["+n+"].step` must evenly divide its range");r=i}}}},e);return t.valid?null:t.format()},EventsService:function(){return null},KeyValueService:function(){return null},GptService:function(){return null},PublisherSonarService:function(){return null},HeaderStatsService:function(e){var t=Inspector.validate({type:"object",properties:{siteId:{type:"string",minLength:1},configId:{type:"string",minLength:1},options:{type:"object",properties:{auctionCycle:{type:"boolean"}}}}},e);return t.valid?null:t.format()},RenderService:function(e){var t=Inspector.validate({type:"object",properties:{sizeRetargeting:{optional:!0,type:"object",properties:{"*":{type:"array",exactLength:2,items:{type:"integer"}}}}}},e);if(!t.valid)return t.format();if(e.sizeRetargeting)for(var r in e.sizeRetargeting)if(e.sizeRetargeting.hasOwnProperty(r)&&!/^[0-9]+x[0-9]+$/.test(r))return"Invalid sizeRetargeting key `"+r+"`, must be format `widthxheight`";return null},TimerService:function(){return null},ComplianceService:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{gdprAppliesDefault:{type:"boolean"},timeout:{type:"integer",gte:0},customFn:{type:"string",optional:!0}}},e);return t.valid?null:t.format()},AdaptiveTimeoutService:function(e){var t=Inspector.validate({type:"object"},e);return t.valid?null:t.format()},HtSlotMapper:function(e,t){var r=Inspector.validate({type:"object",properties:{selectors:{type:"array",minLength:1,items:{type:["array","string"],minLength:1,items:{type:"string",minLength:1}}},filters:{type:"array",items:{type:"string",minLength:1}}}},e);if(!r.valid)return r.format();for(var n=0;n<e.selectors.length;n++){var i=e.selectors[n];if("string"==typeof i){if(-1===t.indexOf(i))return"Unrecognized selector `"+i+"`"}else for(var o=0;o<i.length;o++){var p=i[o];if(-1===t.indexOf(p))return"Unrecognized selector `"+p+"`"}}for(var s=0;s<e.filters.length;s++){var a=e.filters[s];if(-1===t.indexOf(a))return"Unrecognized filter `"+a+"`"}return null},DeviceTypeChecker:function(e){var t=Inspector.validate({type:"object",strict:!0,properties:{method:{type:"string",eq:Object.keys(Constants.DeviceTypeMethods)},configs:{optional:!0,type:"object"}}},e);if(!t.valid)return t.format();if("REFERENCE"===e.method&&(t=Inspector.validate({type:"object",strict:!0,properties:{reference:{type:"string",minLength:1}}},e.configs)),"SIZE_MAPPING"===e.method&&(t=Inspector.validate({type:"object",strict:!0,properties:{sizeMapping:{type:"object",properties:{"*":{type:"string",minLength:1}}}}},e.configs),e.configs.hasOwnProperty("sizeMapping"))){var r=/^(\d+)x(\d+)$/,n=0;for(var i in e.configs.sizeMapping)if(e.configs.sizeMapping.hasOwnProperty(i)){if(!1===r.test(i))return"Keys of `configs.sizeMapping` must be of form `widthxheight`";n++}if(0===n)return"`configs.sizeMapping` must not be empty"}return t.valid?null:t.format()}};module.exports=ConfigValidators;
},{"./constants.js":"/wrapper/src/libs/constants.js","./external/schema-inspector.js":"/wrapper/src/libs/external/schema-inspector.js"}],"/wrapper/src/libs/constants.js":[function(require,module,exports){
"use strict";var Constants={DEFAULT_UID_LENGTH:8,MIN_BANNER_DIMENSION:1,MIN_BID_FLOOR:0,MIN_SITE_ID:0,DEFAULT_UID_CHARSET:"ALPHANUM",SESSION_ID_LENGTH:8,PUBKIT_AD_ID_LENGTH:16,RENDER_SERVICE_EXPIRY_SWEEP_TIMER:3e4,DEFAULT_PARTNER_PRIORITY:1,LineItemTypes:{ID_AND_SIZE:1,ID_AND_PRICE:2,CUSTOM:3},DeviceTypeMethods:{USER_AGENT:1,REFERENCE:2,SIZE_MAPPING:3},RequestArchitectures:{MRA:1,SRA:2},InitialLoadStates:{DISABLED:1,ENABLED:2},MediationLevels:{NONE:1,HT_SLOT:2,PARTNER:3}};module.exports=Constants;
},{}],"/wrapper/src/libs/device-type-checker.js":[function(require,module,exports){
"use strict";function DeviceTypeChecker(e){function i(){return Device.mobile()?DeviceTypeChecker.DeviceTypes.MOBILE:(Device.tablet(),DeviceTypeChecker.DeviceTypes.DESKTOP)}function t(){var i;try{i=eval(e.configs.reference)}catch(e){throw Whoopsie("INTERNAL_ERROR","DeviceTypeChecker: could not eval() `reference`.")}if(!Utilities.isFunction(i)){if(Utilities.isString(i))return i;throw Whoopsie("INVALID_TYPE","DeviceTypeChecker: `reference` must refer to a function or a string")}try{return i()}catch(e){throw Whoopsie("INTERNAL_ERROR","DeviceTypeChecker: could not execute `reference` function.")}}function c(){switch(r){case Constants.DeviceTypeMethods.USER_AGENT:return i();case Constants.DeviceTypeMethods.REFERENCE:return t();default:return i()}}var r;return function(){r=Constants.DeviceTypeMethods[e.method]||Constants.DeviceTypeMethods.USER_AGENT}(),{getDeviceType:c}}var Constants=require("constants.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),Device=require("device.js");DeviceTypeChecker.isValidDeviceType=function(e){for(var i in DeviceTypeChecker.DeviceTypes)if(DeviceTypeChecker.DeviceTypes.hasOwnProperty(i)&&"TABLET"!==i&&e===DeviceTypeChecker.DeviceTypes[i])return!0;return!1},DeviceTypeChecker.DeviceTypes={DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},module.exports=DeviceTypeChecker;
},{"constants.js":"/wrapper/src/libs/constants.js","device.js":"/wrapper/src/libs/external/device.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/external/async.js":[function(require,module,exports){
(function (process,global,setImmediate){
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.async=n.async||{})}(this,function(n){"use strict";function t(n){return n}function e(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}function r(n,t,r){return t=nt(void 0===t?n.length-1:t,0),function(){for(var u=arguments,o=-1,i=nt(u.length-t,0),c=Array(i);++o<i;)c[o]=u[t+o];o=-1;for(var f=Array(t+1);++o<t;)f[o]=u[o];return f[t]=r(c),e(n,this,f)}}function u(n){return function(){return n}}function o(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}function i(n){var t=o(n)?ot.call(n):"";return t==tt||t==et||t==rt}function c(n){return!!lt&&lt in n}function f(n){if(null!=n){try{return pt.call(n)}catch(n){}try{return n+""}catch(n){}}return""}function a(n){return!(!o(n)||c(n))&&(i(n)?bt:yt).test(f(n))}function l(n,t){return null==n?void 0:n[t]}function s(n,t){var e=l(n,t);return a(e)?e:void 0}function p(n,e){return xt(r(n,e,t),n+"")}function h(n){return p(function(t,e){var r=Et(function(e,r){var u=this;return n(t,function(n,t){n.apply(u,e.concat([t]))},r)});return e.length?r.apply(this,e):r})}function y(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=Lt}function v(n){return null!=n&&y(n.length)&&!i(n)}function d(){}function m(n){return function(){if(null!==n){var t=n;n=null,t.apply(this,arguments)}}}function g(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}function b(n){return null!=n&&"object"==typeof n}function j(n){return b(n)&&It.call(n)==Tt}function S(){return!1}function k(n,t){return!!(t=null==t?Wt:t)&&("number"==typeof n||Qt.test(n))&&n>-1&&n%1==0&&n<t}function O(n){return b(n)&&y(n.length)&&!!Gt[Jt.call(n)]}function w(n,t){var e=zt(n),r=!e&&Pt(n),u=!e&&!r&&Ct(n),o=!e&&!r&&!u&&ee(n),i=e||r||u||o,c=i?g(n.length,String):[],f=c.length;for(var a in n)!t&&!ue.call(n,a)||i&&("length"==a||u&&("offset"==a||"parent"==a)||o&&("buffer"==a||"byteLength"==a||"byteOffset"==a)||k(a,f))||c.push(a);return c}function x(n){var t=n&&n.constructor;return n===("function"==typeof t&&t.prototype||oe)}function E(n){if(!x(n))return ie(n);var t=[];for(var e in Object(n))fe.call(n,e)&&"constructor"!=e&&t.push(e);return t}function L(n){return v(n)?w(n):E(n)}function A(n){var t=-1,e=n.length;return function(){return++t<e?{value:n[t],key:t}:null}}function _(n){var t=-1;return function(){var e=n.next();return e.done?null:(t++,{value:e.value,key:t})}}function T(n){var t=L(n),e=-1,r=t.length;return function(){var u=t[++e];return e<r?{value:n[u],key:u}:null}}function F(n){if(v(n))return A(n);var t=_t(n);return t?_(t):T(n)}function I(n){return function(){if(null===n)throw new Error("Callback was already called.");var t=n;n=null,t.apply(this,arguments)}}function B(n){return function(t,e,r){function u(n,t){if(f-=1,n)c=!0,r(n);else{if(t===ae||c&&f<=0)return c=!0,r(null);o()}}function o(){for(;f<n&&!c;){var t=i();if(null===t)return c=!0,void(f<=0&&r(null));f+=1,e(t.value,t.key,I(u))}}if(r=m(r||d),n<=0||!t)return r(null);var i=F(t),c=!1,f=0;o()}}function $(n,t,e,r){B(t)(n,e,r)}function M(n,t){return function(e,r,u){return n(e,t,r,u)}}function P(n,t,e){function r(n){n?e(n):++o===i&&e(null)}e=m(e||d);var u=0,o=0,i=n.length;for(0===i&&e(null);u<i;u++)t(n[u],u,I(r))}function z(n){return function(t,e,r){return n(se,t,e,r)}}function R(n,t,e,r){r=m(r||d),t=t||[];var u=[],o=0;n(t,function(n,t,r){var i=o++;e(n,function(n,t){u[i]=t,r(n)})},function(n){r(n,u)})}function U(n){return function(t,e,r,u){return n(B(e),t,r,u)}}function V(n){return Et(function(t,e){var r;try{r=n.apply(this,t)}catch(n){return e(n)}o(r)&&"function"==typeof r.then?r.then(function(n){e(null,n)},function(n){e(n.message?n:new Error(n))}):e(null,r)})}function D(n,t){for(var e=-1,r=n?n.length:0;++e<r&&!1!==t(n[e],e,n););return n}function q(n,t){return n&&ge(n,t,L)}function C(n,t,e,r){for(var u=n.length,o=e+(r?1:-1);r?o--:++o<u;)if(t(n[o],o,n))return o;return-1}function W(n){return n!==n}function Q(n,t,e){for(var r=e-1,u=n.length;++r<u;)if(n[r]===t)return r;return-1}function G(n,t,e){return t===t?Q(n,t,e):C(n,W,e)}function N(n,t){for(var e=-1,r=n?n.length:0,u=Array(r);++e<r;)u[e]=t(n[e],e,n);return u}function H(n,t){var e=-1,r=n.length;for(t||(t=Array(r));++e<r;)t[e]=n[e];return t}function J(n){return"symbol"==typeof n||b(n)&&Oe.call(n)==Se}function K(n){if("string"==typeof n)return n;if(zt(n))return N(n,K)+"";if(J(n))return Ee?Ee.call(n):"";var t=n+"";return"0"==t&&1/n==-we?"-0":t}function X(n,t,e){var r=-1,u=n.length;t<0&&(t=-t>u?0:u+t),e=e>u?u:e,e<0&&(e+=u),u=t>e?0:e-t>>>0,t>>>=0;for(var o=Array(u);++r<u;)o[r]=n[r+t];return o}function Y(n,t,e){var r=n.length;return e=void 0===e?r:e,!t&&e>=r?n:X(n,t,e)}function Z(n,t){for(var e=n.length;e--&&G(t,n[e],0)>-1;);return e}function nn(n,t){for(var e=-1,r=n.length;++e<r&&G(t,n[e],0)>-1;);return e}function tn(n){return n.split("")}function en(n){return Le.test(n)}function rn(n){return n.match(Pe)||[]}function un(n){return en(n)?rn(n):tn(n)}function on(n){return null==n?"":K(n)}function cn(n,t,e){if((n=on(n))&&(e||void 0===t))return n.replace(ze,"");if(!n||!(t=K(t)))return n;var r=un(n),u=un(t);return Y(r,nn(r,u),Z(r,u)+1).join("")}function fn(n){return n=n.toString().replace(De,""),n=n.match(Re)[2].replace(" ",""),n=n?n.split(Ue):[],n=n.map(function(n){return cn(n.replace(Ve,""))})}function an(n,t){var e={};q(n,function(n,t){function r(t,e){var r=N(u,function(n){return t[n]});r.push(e),n.apply(null,r)}var u;if(zt(n))u=H(n),n=u.pop(),e[t]=u.concat(u.length>0?r:n);else if(1===n.length)e[t]=n;else{if(u=fn(n),0===n.length&&0===u.length)throw new Error("autoInject task functions require explicit parameters.");u.pop(),e[t]=u.concat(r)}}),be(e,t)}function ln(n){setTimeout(n,0)}function sn(n){return p(function(t,e){n(function(){t.apply(null,e)})})}function pn(){this.head=this.tail=null,this.length=0}function hn(n,t){n.length=1,n.head=n.tail=t}function yn(n,t,e){function r(n,t,e){if(null!=e&&"function"!=typeof e)throw new Error("task callback must be a function");if(c.started=!0,zt(n)||(n=[n]),0===n.length&&c.idle())return We(function(){c.drain()});for(var r=0,u=n.length;r<u;r++){var o={data:n[r],callback:e||d};t?c._tasks.unshift(o):c._tasks.push(o)}We(c.process)}function u(n){return p(function(t){o-=1;for(var e=0,r=n.length;e<r;e++){var u=n[e],f=G(i,u,0);f>=0&&i.splice(f),u.callback.apply(u,t),null!=t[0]&&c.error(t[0],u.data)}o<=c.concurrency-c.buffer&&c.unsaturated(),c.idle()&&c.drain(),c.process()})}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var o=0,i=[],c={_tasks:new pn,concurrency:t,payload:e,saturated:d,unsaturated:d,buffer:t/4,empty:d,drain:d,error:d,started:!1,paused:!1,push:function(n,t){r(n,!1,t)},kill:function(){c.drain=d,c._tasks.empty()},unshift:function(n,t){r(n,!0,t)},process:function(){for(;!c.paused&&o<c.concurrency&&c._tasks.length;){var t=[],e=[],r=c._tasks.length;c.payload&&(r=Math.min(r,c.payload));for(var f=0;f<r;f++){var a=c._tasks.shift();t.push(a),e.push(a.data)}0===c._tasks.length&&c.empty(),o+=1,i.push(t[0]),o===c.concurrency&&c.saturated();var l=I(u(t));n(e,l)}},length:function(){return c._tasks.length},running:function(){return o},workersList:function(){return i},idle:function(){return c._tasks.length+o===0},pause:function(){c.paused=!0},resume:function(){if(!1!==c.paused){c.paused=!1;for(var n=Math.min(c.concurrency,c._tasks.length),t=1;t<=n;t++)We(c.process)}}};return c}function vn(n,t){return yn(n,1,t)}function dn(n,t,e,r){r=m(r||d),Ge(n,function(n,r,u){e(t,n,function(n,e){t=e,u(n)})},function(n){r(n,t)})}function mn(n,t,e,r){var u=[];n(t,function(n,t,r){e(n,function(n,t){u=u.concat(t||[]),r(n)})},function(n){r(n,u)})}function gn(n,t,e){return function(r,u,o,i){function c(){i&&i(null,e(!1))}function f(n,r,u){if(!i)return u();o(n,function(r,c){i&&(r||t(c))?(r?i(r):i(r,e(!0,n)),i=o=!1,u(r,ae)):u()})}arguments.length>3?(i=i||d,n(r,u,f,c)):(i=o,i=i||d,o=u,n(r,f,c))}}function bn(n,t){return t}function jn(n){return p(function(t,e){t.apply(null,e.concat([p(function(t,e){"object"==typeof console&&(t?console.error&&console.error(t):console[n]&&D(e,function(t){console[n](t)}))})]))})}function Sn(n,t,e){function r(t,r){return t?e(t):r?void n(u):e(null)}e=I(e||d);var u=p(function(n,u){if(n)return e(n);u.push(r),t.apply(this,u)});r(null,!0)}function kn(n,t,e){e=I(e||d);var r=p(function(u,o){return u?e(u):t.apply(this,o)?n(r):void e.apply(null,[null].concat(o))});n(r)}function On(n,t,e){kn(n,function(){return!t.apply(this,arguments)},e)}function wn(n,t,e){function r(t){if(t)return e(t);n(u)}function u(n,u){return n?e(n):u?void t(r):e(null)}e=I(e||d),n(u)}function xn(n){return function(t,e,r){return n(t,r)}}function En(n,t,e){se(n,xn(t),e)}function Ln(n,t,e,r){B(t)(n,xn(e),r)}function An(n){return Et(function(t,e){var r=!0;t.push(function(){var n=arguments;r?We(function(){e.apply(null,n)}):e.apply(null,n)}),n.apply(this,t),r=!1})}function _n(n){return!n}function Tn(n){return function(t){return null==t?void 0:t[n]}}function Fn(n,t,e,r){r=m(r||d);var u=[];n(t,function(n,t,r){e(n,function(e,o){e?r(e):(o&&u.push({index:t,value:n}),r())})},function(n){n?r(n):r(null,N(u.sort(function(n,t){return n.index-t.index}),Tn("value")))})}function In(n,t){function e(n){if(n)return r(n);u(e)}var r=I(t||d),u=An(n);e()}function Bn(n,t,e,r){r=m(r||d);var u={};$(n,t,function(n,t,r){e(n,t,function(n,e){if(n)return r(n);u[t]=e,r()})},function(n){r(n,u)})}function $n(n,t){return t in n}function Mn(n,e){var r=Object.create(null),u=Object.create(null);e=e||t;var o=Et(function(t,o){var i=e.apply(null,t);$n(r,i)?We(function(){o.apply(null,r[i])}):$n(u,i)?u[i].push(o):(u[i]=[o],n.apply(null,t.concat([p(function(n){r[i]=n;var t=u[i];delete u[i];for(var e=0,o=t.length;e<o;e++)t[e].apply(null,n)})])))});return o.memo=r,o.unmemoized=n,o}function Pn(n,t,e){e=e||d;var r=v(t)?[]:{};n(t,function(n,t,e){n(p(function(n,u){u.length<=1&&(u=u[0]),r[t]=u,e(n)}))},function(n){e(n,r)})}function zn(n,t){Pn(se,n,t)}function Rn(n,t,e){Pn(B(t),n,e)}function Un(n,t){if(t=m(t||d),!zt(n))return t(new TypeError("First argument to race must be an array of functions"));if(!n.length)return t();for(var e=0,r=n.length;e<r;e++)n[e](t)}function Vn(n,t,e,r){dn(vr.call(n).reverse(),t,e,r)}function Dn(n){return Et(function(t,e){return t.push(p(function(n,t){if(n)e(null,{error:n});else{var r=null;1===t.length?r=t[0]:t.length>1&&(r=t),e(null,{value:r})}})),n.apply(this,t)})}function qn(n,t,e,r){Fn(n,t,function(n,t){e(n,function(n,e){n?t(n):t(null,!e)})},r)}function Cn(n){var t;return zt(n)?t=N(n,Dn):(t={},q(n,function(n,e){t[e]=Dn.call(this,n)})),t}function Wn(n,t,e){function r(){t(function(n){n&&f++<c.times&&("function"!=typeof c.errorFilter||c.errorFilter(n))?setTimeout(r,c.intervalFunc(f)):e.apply(null,arguments)})}var o=5,i=0,c={times:o,intervalFunc:u(i)};if(arguments.length<3&&"function"==typeof n?(e=t||d,t=n):(!function(n,t){if("object"==typeof t)n.times=+t.times||o,n.intervalFunc="function"==typeof t.interval?t.interval:u(+t.interval||i),n.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");n.times=+t||o}}(c,n),e=e||d),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var f=1;r()}function Qn(n,t){Pn(Ge,n,t)}function Gn(n,t,e){function r(n,t){var e=n.criteria,r=t.criteria;return e<r?-1:e>r?1:0}pe(n,function(n,e){t(n,function(t,r){if(t)return e(t);e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);e(null,N(t.sort(r),Tn("value")))})}function Nn(n,t,e){function r(){c||(o.apply(null,arguments),clearTimeout(i))}function u(){var t=n.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",e&&(r.info=e),c=!0,o(r)}var o,i,c=!1;return Et(function(e,c){o=c,i=setTimeout(u,t),n.apply(null,e.concat(r))})}function Hn(n,t,e,r){for(var u=-1,o=wr(Or((t-n)/(e||1)),0),i=Array(o);o--;)i[r?o:++u]=n,n+=e;return i}function Jn(n,t,e,r){ye(Hn(0,n,1),t,e,r)}function Kn(n,t,e,r){3===arguments.length&&(r=e,e=t,t=zt(n)?[]:{}),r=m(r||d),se(n,function(n,r,u){e(t,n,r,u)},function(n){r(n,t)})}function Xn(n){return function(){return(n.unmemoized||n).apply(null,arguments)}}function Yn(n,t,e){if(e=I(e||d),!n())return e(null);var r=p(function(u,o){return u?e(u):n()?t(r):void e.apply(null,[null].concat(o))});t(r)}function Zn(n,t,e){Yn(function(){return!n.apply(this,arguments)},t,e)}var nt=Math.max,tt="[object Function]",et="[object GeneratorFunction]",rt="[object Proxy]",ut=Object.prototype,ot=ut.toString,it="object"==typeof global&&global&&global.Object===Object&&global,ct="object"==typeof self&&self&&self.Object===Object&&self,ft=it||ct||Function("return this")(),at=ft["__core-js_shared__"],lt=function(){var n=/[^.]+$/.exec(at&&at.keys&&at.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),st=Function.prototype,pt=st.toString,ht=/[\\^$.*+?()[\]{}|]/g,yt=/^\[object .+?Constructor\]$/,vt=Function.prototype,dt=Object.prototype,mt=vt.toString,gt=dt.hasOwnProperty,bt=RegExp("^"+mt.call(gt).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jt=function(){try{var n=s(Object,"defineProperty");return n({},"",{}),n}catch(n){}}(),St=jt?function(n,t){return jt(n,"toString",{configurable:!0,enumerable:!1,value:u(t),writable:!0})}:t,kt=500,Ot=16,wt=Date.now,xt=function(n){var t=0,e=0;return function(){var r=wt(),u=Ot-(r-e);if(e=r,u>0){if(++t>=kt)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}(St),Et=function(n){return p(function(t){var e=t.pop();n.call(this,t,e)})},Lt=9007199254740991,At="function"==typeof Symbol&&Symbol.iterator,_t=function(n){return At&&n[At]&&n[At]()},Tt="[object Arguments]",Ft=Object.prototype,It=Ft.toString,Bt=Object.prototype,$t=Bt.hasOwnProperty,Mt=Bt.propertyIsEnumerable,Pt=j(function(){return arguments}())?j:function(n){return b(n)&&$t.call(n,"callee")&&!Mt.call(n,"callee")},zt=Array.isArray,Rt="object"==typeof n&&n&&!n.nodeType&&n,Ut=Rt&&"object"==typeof module&&module&&!module.nodeType&&module,Vt=Ut&&Ut.exports===Rt,Dt=Vt?ft.Buffer:void 0,qt=Dt?Dt.isBuffer:void 0,Ct=qt||S,Wt=9007199254740991,Qt=/^(?:0|[1-9]\d*)$/,Gt={};Gt["[object Float32Array]"]=Gt["[object Float64Array]"]=Gt["[object Int8Array]"]=Gt["[object Int16Array]"]=Gt["[object Int32Array]"]=Gt["[object Uint8Array]"]=Gt["[object Uint8ClampedArray]"]=Gt["[object Uint16Array]"]=Gt["[object Uint32Array]"]=!0,Gt["[object Arguments]"]=Gt["[object Array]"]=Gt["[object ArrayBuffer]"]=Gt["[object Boolean]"]=Gt["[object DataView]"]=Gt["[object Date]"]=Gt["[object Error]"]=Gt["[object Function]"]=Gt["[object Map]"]=Gt["[object Number]"]=Gt["[object Object]"]=Gt["[object RegExp]"]=Gt["[object Set]"]=Gt["[object String]"]=Gt["[object WeakMap]"]=!1;var Nt,Ht=Object.prototype,Jt=Ht.toString,Kt="object"==typeof n&&n&&!n.nodeType&&n,Xt=Kt&&"object"==typeof module&&module&&!module.nodeType&&module,Yt=Xt&&Xt.exports===Kt,Zt=Yt&&it.process,ne=function(){try{return Zt&&Zt.binding("util")}catch(n){}}(),te=ne&&ne.isTypedArray,ee=te?function(n){return function(t){return n(t)}}(te):O,re=Object.prototype,ue=re.hasOwnProperty,oe=Object.prototype,ie=function(n,t){return function(e){return n(t(e))}}(Object.keys,Object),ce=Object.prototype,fe=ce.hasOwnProperty,ae={},le=M($,1/0),se=function(n,t,e){(v(n)?P:le)(n,t,e)},pe=z(R),he=h(pe),ye=U(R),ve=M(ye,1),de=h(ve),me=p(function(n,t){return p(function(e){return n.apply(null,t.concat(e))})}),ge=function(n){return function(t,e,r){for(var u=-1,o=Object(t),i=r(t),c=i.length;c--;){var f=i[n?c:++u];if(!1===e(o[f],f,o))break}return t}}(),be=function(n,t,e){function r(n,t){g.push(function(){c(n,t)})}function u(){if(0===g.length&&0===h)return e(null,s);for(;g.length&&h<t;){g.shift()()}}function o(n,t){var e=v[n];e||(e=v[n]=[]),e.push(t)}function i(n){D(v[n]||[],function(n){n()}),u()}function c(n,t){if(!y){var r=I(p(function(t,r){if(h--,r.length<=1&&(r=r[0]),t){var u={};q(s,function(n,t){u[t]=n}),u[n]=r,y=!0,v=[],e(t,u)}else s[n]=r,i(n)}));h++;var u=t[t.length-1];t.length>1?u(s,r):u(r)}}function f(t){var e=[];return q(n,function(n,r){zt(n)&&G(n,t,0)>=0&&e.push(r)}),e}"function"==typeof t&&(e=t,t=null),e=m(e||d);var a=L(n),l=a.length;if(!l)return e(null);t||(t=l);var s={},h=0,y=!1,v={},g=[],b=[],j={};q(n,function(t,e){if(!zt(t))return r(e,[t]),void b.push(e);var u=t.slice(0,t.length-1),i=u.length;if(0===i)return r(e,t),void b.push(e);j[e]=i,D(u,function(c){if(!n[c])throw new Error("async.auto task `"+e+"` has a non-existent dependency in "+u.join(", "));o(c,function(){0===--i&&r(e,t)})})}),function(){for(var n,t=0;b.length;)n=b.pop(),t++,D(f(n),function(n){0==--j[n]&&b.push(n)});if(t!==l)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),u()},je=ft.Symbol,Se="[object Symbol]",ke=Object.prototype,Oe=ke.toString,we=1/0,xe=je?je.prototype:void 0,Ee=xe?xe.toString:void 0,Le=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Ae="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",_e="\\ud83c[\\udffb-\\udfff]",Te="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ie="(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?",Be="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Te,Fe].join("|")+")[\\ufe0e\\ufe0f]?"+Ie+")*",$e="[\\ufe0e\\ufe0f]?"+Ie+Be,Me="(?:"+["[^\\ud800-\\udfff]"+Ae+"?",Ae,Te,Fe,"[\\ud800-\\udfff]"].join("|")+")",Pe=RegExp(_e+"(?="+_e+")|"+Me+$e,"g"),ze=/^\s+|\s+$/g,Re=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Ue=/,/,Ve=/(=.+)?(\s*)$/,De=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,qe="function"==typeof setImmediate&&setImmediate,Ce="object"==typeof process&&"function"==typeof process.nextTick;Nt=qe?setImmediate:Ce?process.nextTick:ln;var We=sn(Nt);pn.prototype.removeLink=function(n){return n.prev?n.prev.next=n.next:this.head=n.next,n.next?n.next.prev=n.prev:this.tail=n.prev,n.prev=n.next=null,this.length-=1,n},pn.prototype.empty=pn,pn.prototype.insertAfter=function(n,t){t.prev=n,t.next=n.next,n.next?n.next.prev=t:this.tail=t,n.next=t,this.length+=1},pn.prototype.insertBefore=function(n,t){t.prev=n.prev,t.next=n,n.prev?n.prev.next=t:this.head=t,n.prev=t,this.length+=1},pn.prototype.unshift=function(n){this.head?this.insertBefore(this.head,n):hn(this,n)},pn.prototype.push=function(n){this.tail?this.insertAfter(this.tail,n):hn(this,n)},pn.prototype.shift=function(){return this.head&&this.removeLink(this.head)},pn.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var Qe,Ge=M($,1),Ne=p(function(n){return p(function(t){var e=this,r=t[t.length-1];"function"==typeof r?t.pop():r=d,dn(n,t,function(n,t,r){t.apply(e,n.concat([p(function(n,t){r(n,t)})]))},function(n,t){r.apply(e,[n].concat(t))})})}),He=p(function(n){return Ne.apply(null,n.reverse())}),Je=z(mn),Ke=function(n){return function(t,e,r){return n(Ge,t,e,r)}}(mn),Xe=p(function(n){var t=[null].concat(n);return Et(function(n,e){return e.apply(this,t)})}),Ye=gn(se,t,bn),Ze=gn($,t,bn),nr=gn(Ge,t,bn),tr=jn("dir"),er=M(Ln,1),rr=gn(se,_n,_n),ur=gn($,_n,_n),or=M(ur,1),ir=z(Fn),cr=U(Fn),fr=M(cr,1),ar=jn("log"),lr=M(Bn,1/0),sr=M(Bn,1);Qe=Ce?process.nextTick:qe?setImmediate:ln;var pr=sn(Qe),hr=function(n,t){return yn(function(t,e){n(t[0],e)},t,1)},yr=function(n,t){var e=hr(n,t);return e.push=function(n,t,r){if(null==r&&(r=d),"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,zt(n)||(n=[n]),0===n.length)return We(function(){e.drain()});t=t||0;for(var u=e._tasks.head;u&&t>=u.priority;)u=u.next;for(var o=0,i=n.length;o<i;o++){var c={data:n[o],priority:t,callback:r};u?e._tasks.insertBefore(u,c):e._tasks.push(c)}We(e.process)},delete e.unshift,e},vr=Array.prototype.slice,dr=z(qn),mr=U(qn),gr=M(mr,1),br=function(n,t){return t||(t=n,n=null),Et(function(e,r){function u(n){t.apply(null,e.concat([n]))}n?Wn(n,u,r):Wn(u,r)})},jr=gn(se,Boolean,t),Sr=gn($,Boolean,t),kr=M(Sr,1),Or=Math.ceil,wr=Math.max,xr=M(Jn,1/0),Er=M(Jn,1),Lr=function(n,t){function e(u){if(r===n.length)return t.apply(null,[null].concat(u));var o=I(p(function(n,r){if(n)return t.apply(null,[n].concat(r));e(r)}));u.push(o),n[r++].apply(null,u)}if(t=m(t||d),!zt(n))return t(new Error("First argument to waterfall must be an array of functions"));if(!n.length)return t();var r=0;e([])},Ar={applyEach:he,applyEachSeries:de,apply:me,asyncify:V,auto:be,autoInject:an,cargo:vn,compose:He,concat:Je,concatSeries:Ke,constant:Xe,detect:Ye,detectLimit:Ze,detectSeries:nr,dir:tr,doDuring:Sn,doUntil:On,doWhilst:kn,during:wn,each:En,eachLimit:Ln,eachOf:se,eachOfLimit:$,eachOfSeries:Ge,eachSeries:er,ensureAsync:An,every:rr,everyLimit:ur,everySeries:or,filter:ir,filterLimit:cr,filterSeries:fr,forever:In,log:ar,map:pe,mapLimit:ye,mapSeries:ve,mapValues:lr,mapValuesLimit:Bn,mapValuesSeries:sr,memoize:Mn,nextTick:pr,parallel:zn,parallelLimit:Rn,priorityQueue:yr,queue:hr,race:Un,reduce:dn,reduceRight:Vn,reflect:Dn,reflectAll:Cn,reject:dr,rejectLimit:mr,rejectSeries:gr,retry:Wn,retryable:br,seq:Ne,series:Qn,setImmediate:We,some:jr,someLimit:Sr,someSeries:kr,sortBy:Gn,timeout:Nn,times:xr,timesLimit:Jn,timesSeries:Er,transform:Kn,unmemoize:Xn,until:Zn,waterfall:Lr,whilst:Yn,all:rr,any:jr,forEach:En,forEachSeries:er,forEachLimit:Ln,forEachOf:se,forEachOfSeries:Ge,forEachOfLimit:$,inject:dn,foldl:dn,foldr:Vn,select:ir,selectLimit:cr,selectSeries:fr,wrapSync:V};n.default=Ar,n.applyEach=he,n.applyEachSeries=de,n.apply=me,n.asyncify=V,n.auto=be,n.autoInject=an,n.cargo=vn,n.compose=He,n.concat=Je,n.concatSeries=Ke,n.constant=Xe,n.detect=Ye,n.detectLimit=Ze,n.detectSeries=nr,n.dir=tr,n.doDuring=Sn,n.doUntil=On,n.doWhilst=kn,n.during=wn,n.each=En,n.eachLimit=Ln,n.eachOf=se,n.eachOfLimit=$,n.eachOfSeries=Ge,n.eachSeries=er,n.ensureAsync=An,n.every=rr,n.everyLimit=ur,n.everySeries=or,n.filter=ir,n.filterLimit=cr,n.filterSeries=fr,n.forever=In,n.log=ar,n.map=pe,n.mapLimit=ye,n.mapSeries=ve,n.mapValues=lr,n.mapValuesLimit=Bn,n.mapValuesSeries=sr,n.memoize=Mn,n.nextTick=pr,n.parallel=zn,n.parallelLimit=Rn,n.priorityQueue=yr,n.queue=hr,n.race=Un,n.reduce=dn,n.reduceRight=Vn,n.reflect=Dn,n.reflectAll=Cn,n.reject=dr,n.rejectLimit=mr,n.rejectSeries=gr,n.retry=Wn,n.retryable=br,n.seq=Ne,n.series=Qn,n.setImmediate=We,n.some=jr,n.someLimit=Sr,n.someSeries=kr,n.sortBy=Gn,n.timeout=Nn,n.times=xr,n.timesLimit=Jn,n.timesSeries=Er,n.transform=Kn,n.unmemoize=Xn,n.until=Zn,n.waterfall=Lr,n.whilst=Yn,n.all=rr,n.allLimit=ur,n.allSeries=or,n.any=jr,n.anyLimit=Sr,n.anySeries=kr,n.find=Ye,n.findLimit=Ze,n.findSeries=nr,n.forEach=En,n.forEachSeries=er,n.forEachLimit=Ln,n.forEachOf=se,n.forEachOfSeries=Ge,n.forEachOfLimit=$,n.inject=dn,n.foldl=dn,n.foldr=Vn,n.select=ir,n.selectLimit=cr,n.selectSeries=fr,n.wrapSync=V,Object.defineProperty(n,"__esModule",{value:!0})});
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("timers").setImmediate)
},{"_process":11,"timers":15}],"/wrapper/src/libs/external/base64.js":[function(require,module,exports){
!function(t,e){"function"==typeof define&&define.amd?define([],function(){e(t)}):e(t)}("undefined"!=typeof exports?exports:this,function(t){if(t.atob)try{t.atob(" ")}catch(e){t.atob=function(t){var e=function(e){return t(String(e).replace(/[\t\n\f\r ]+/g,""))};return e.original=t,e}(t.atob)}else{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;t.btoa=function(t){t=String(t);for(var r,n,o,a,i="",c=0,d=t.length%3;c<t.length;){if((n=t.charCodeAt(c++))>255||(o=t.charCodeAt(c++))>255||(a=t.charCodeAt(c++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");r=n<<16|o<<8|a,i+=e.charAt(r>>18&63)+e.charAt(r>>12&63)+e.charAt(r>>6&63)+e.charAt(63&r)}return d?i.slice(0,d-3)+"===".substring(d):i},t.atob=function(t){if(t=String(t).replace(/[\t\n\f\r ]+/g,""),!r.test(t))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");t+="==".slice(2-(3&t.length));for(var n,o,a,i="",c=0;c<t.length;)n=e.indexOf(t.charAt(c++))<<18|e.indexOf(t.charAt(c++))<<12|(o=e.indexOf(t.charAt(c++)))<<6|(a=e.indexOf(t.charAt(c++))),i+=64===o?String.fromCharCode(n>>16&255):64===a?String.fromCharCode(n>>16&255,n>>8&255):String.fromCharCode(n>>16&255,n>>8&255,255&n);return i}}});
},{}],"/wrapper/src/libs/external/device.js":[function(require,module,exports){
"use strict";var device,find,userAgent;device={},userAgent=window.navigator.userAgent.toLowerCase(),device.ios=function(){return device.iphone()||device.ipod()||device.ipad()},device.iphone=function(){return!device.windows()&&find("iphone")},device.ipod=function(){return find("ipod")},device.ipad=function(){return find("ipad")},device.android=function(){return!device.windows()&&find("android")},device.androidPhone=function(){return device.android()&&find("mobile")},device.androidTablet=function(){return device.android()&&!find("mobile")},device.blackberry=function(){return find("blackberry")||find("bb10")||find("rim")},device.blackberryPhone=function(){return device.blackberry()&&!find("tablet")},device.blackberryTablet=function(){return device.blackberry()&&find("tablet")},device.windows=function(){return find("windows")},device.windowsPhone=function(){return device.windows()&&find("phone")},device.windowsTablet=function(){return device.windows()&&find("touch")&&!device.windowsPhone()},device.fxos=function(){return(find("(mobile;")||find("(tablet;"))&&find("; rv:")},device.fxosPhone=function(){return device.fxos()&&find("mobile")},device.fxosTablet=function(){return device.fxos()&&find("tablet")},device.meego=function(){return find("meego")},device.mobile=function(){return device.androidPhone()||device.iphone()||device.ipod()||device.windowsPhone()||device.blackberryPhone()||device.fxosPhone()||device.meego()},device.tablet=function(){return device.ipad()||device.androidTablet()||device.blackberryTablet()||device.windowsTablet()||device.fxosTablet()},device.desktop=function(){return!device.tablet()&&!device.mobile()},find=function(e){return-1!==userAgent.indexOf(e)},module.exports=device;
},{}],"/wrapper/src/libs/external/jsonpatch-reduced.js":[function(require,module,exports){
"use strict";!function(t,e){"object"==typeof exports?e(module.exports):"function"==typeof define&&define.amd?define(["exports"],e):(t.jsonpatch={},t.returnExports=e(t.jsonpatch))}(this,function(t){function e(t){Error.call(this,t),this.message=t}function r(t){Error.call(this,t),this.message=t}function n(t){var e,r;if(h(t))return t.slice();if(null===t)return t;if("object"==typeof t){e={};for(r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}return t}function o(t,e){var r;if(t===e)return!0;if(typeof t!=typeof e)return!1;if("object"!=typeof t)return!1;var n=h(t);if(n!==h(e))return!1;if(!n){for(r in t)if(Object.hasOwnProperty(t,r)&&(!Object.hasOwnProperty(e,r)||!o(t[r],e[r])))return!1;for(r in e)if(Object.hasOwnProperty(e,r)&&!Object.hasOwnProperty(t,r))return!1;return!0}if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)return o(t[i],e[i])}function i(t){var r,n;if(!t.op)throw new e("");if(!a.hasOwnProperty(t.op))throw new e("");if(!("path"in t))throw new e("");for(n=a[t.op],r=0;r<n.length;r++)if(!(n[r]in t))throw new e("")}function c(t,n){i(t);var c=t.op,f=new p(t.path),a=t.value,h=t.from?new p(t.from):null;switch(c){case"add":return function(t){return f.add(t,a,n)};case"remove":return function(t){return f.remove(t,n)};case"replace":return function(t){return f.replace(t,a,n)};case"move":if(f.subsetOf(h))throw new e("");return function(t){var e=h.get(t),r=h.remove(t,n);return f.add(r,e,n)};case"copy":return function(t){var e=h.get(t);return f.add(t,e,n)};case"test":return function(t){if(!o(f.get(t),a))throw new r("");return t}}}var f,p,a,h;h=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.applyPatch=function(t,e){return new f(e).apply(t)},t.InvalidPatch=e,e.prototype=new Error,t.PatchApplyError=r,r.prototype=new Error,t.JSONPointer=p=function(t){var r,n,o=[];if(n=t.split("/"),""!==n[0])throw new e("");for(r=1;r<n.length;r++)o[r-1]=n[r].replace(/~1/g,"/").replace(/~0/g,"~");this.path=o,this.length=o.length},p.prototype._get_segment=function(t,e){var n=this.path[t];if(h(e))if("-"===n)n=e.length;else{if(!n.match(/^0|[1-9][0-9]*$/))throw new r("");n=parseInt(n,10)}return n},p.prototype._action=function(t,e,o){function i(t,f){var p,a;if(o||(t=n(t)),p=c._get_segment(f,t),f==c.path.length-1)t=e(t,p);else{if(h(t)){if(t.length<=p)throw new r("")}else{if("object"!=typeof t)throw new r("");if(!Object.hasOwnProperty.call(t,p))throw new r("")}a=i(t[p],f+1),o||(t[p]=a)}return t}var c=this;return i(t,0)},p.prototype.add=function(t,e,n){return 0===this.length?e:this._action(t,function(t,n){if(h(t)){if(n>t.length)throw new r("");t.splice(n,0,e)}else t[n]=e;return t},n)},p.prototype.remove=function(t,e){if(0!==this.length)return this._action(t,function(t,e){if(!Object.hasOwnProperty.call(t,e))throw new r("");return h(t)?t.splice(e,1):delete t[e],t},e)},p.prototype.replace=function(t,e,n){return 0===this.length?e:this._action(t,function(t,n){if(!Object.hasOwnProperty.call(t,n))throw new r("");return h(t)?t.splice(n,1,e):t[n]=e,t},n)},p.prototype.get=function(t){var e;return 0===this.length?t:(this._action(t,function(t,n){if(!Object.hasOwnProperty.call(t,n))throw new r("");return e=t[n],t},!0),e)},p.prototype.subsetOf=function(t){if(this.length<=t.length)return!1;for(var e=0;e<t.length;e++)if(t.path[e]!==this.path[e])return!1;return!0},a={add:["value"],replace:["value"],test:["value"],remove:[],move:["from"],copy:["from"]},t.JSONPatch=f=function(t,e){this._compile(t,e)},f.prototype._compile=function(t,r){var n,o=this;if(this.compiledOps=[],"string"==typeof t&&(t=JSON.parse(t)),!h(t))throw new e("");for(n=0;n<t.length;n++){var i=c(t[n],r);o.compiledOps.push(i)}},t.JSONPatch.prototype.apply=function(t){var e;for(e=0;e<this.compiledOps.length;e++)t=this.compiledOps[e](t);return t}});
},{}],"/wrapper/src/libs/external/prms.js":[function(require,module,exports){
function noop(){}function Promise(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(e,this)}function handle(e,t){for(;3===e._state;)e=e._value;if(0===e._state)return void e._deferreds.push(t);e._handled=!0;var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?resolve:reject)(t.promise,e._value);var o;try{o=n(e._value)}catch(e){return void reject(t.promise,e)}resolve(t.promise,o)}function resolve(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof Promise)return e._state=3,e._value=t,void finale(e);if("function"==typeof n)return void doResolve(bind(n,t),e)}e._state=1,e._value=t,finale(e)}catch(t){reject(e,t)}}function reject(e,t){e._state=2,e._value=t,finale(e)}function finale(e){for(var t=0,n=e._deferreds.length;t<n;t++)handle(e,e._deferreds[t]);e._deferreds=null}function Handler(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function doResolve(e,t){var n=!1;try{e(function(e){n||(n=!0,resolve(t,e))},function(e){n||(n=!0,reject(t,e))})}catch(e){if(n)return;n=!0,reject(t,e)}}Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){var n=new this.constructor(noop);return handle(this,new Handler(e,t,n)),n},Promise.all=function(e){var t=Array.prototype.slice.call(e);return new Promise(function(e,n){function o(i,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var s=f.then;if("function"==typeof s)return void s.call(f,function(e){o(i,e)},n)}t[i]=f,0==--r&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var r=t.length,i=0;i<t.length;i++)o(i,t[i])})},Promise.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Promise?e:new Promise(function(t){t(e)})},Promise.reject=function(e){return new Promise(function(t,n){n(e)})},Promise.defer=function(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e},module.exports=Promise;
},{}],"/wrapper/src/libs/external/schema-inspector.js":[function(require,module,exports){
!function(){function t(t,e){if(!e||"object"!=typeof e)return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function e(){var t={},e=Array.prototype.slice.call(arguments),n=null,r=null;return e.forEach(function(e){if(e&&e.constructor===Object)for(n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]]}),t}function n(){this.custom={},this.extend=function(e){return t(this.custom,e)},this.reset=function(){this.custom={}},this.remove=function(t){h.array(t)||(t=[t]),t.forEach(function(t){delete this.custom[t]},this)}}function r(t,e){var n=["@"];if(this._schema=t,this._custom={},null!=e)for(var r in e)e.hasOwnProperty(r)&&(this._custom["$"+r]=e[r]);this._getDepth=function(){return n.length},this._dumpStack=function(){return n.map(function(t){return t.replace(/^\[/g,"")}).join(".").replace(/\.\u001b\u001c\u001d\u001e/g,"[")},this._deeperObject=function(t){return n.push(/^[a-z$_][a-z0-9$_]*$/i.test(t)?t:'["'+t+'"]'),this},this._deeperArray=function(t){return n.push("["+t+"]"),this},this._back=function(){return n.pop(),this}}function i(t,e){return"function"==typeof t?e instanceof t:(t=t in h?t:"any",h[t](e))}function u(t){for(var e in h)if(i(e,t))return"any"!==e?e:"an instance of "+t.constructor.name}function o(t,e){for(var n=[],r=t.indexOf(e);-1!==r;)n.push(r),r=t.indexOf(e,r+1);return n}function a(t,n){r.prototype.constructor.call(this,t,e(a.custom,n));var i=[];this._basicFields=Object.keys(y),this._customFields=Object.keys(this._custom),this.origin=null,this.report=function(t,e,n){var r={code:e||this.userCode||null,reason:n||"unknown",message:this.userError||t||"is invalid",property:this.userAlias?this.userAlias+" ("+this._dumpStack()+")":this._dumpStack()};return i.push(r),this},this.result=function(){return{error:i,valid:0===i.length,format:function(){return!0===this.valid?"Candidate is valid":this.error.map(function(t){return"Property "+t.property+": "+t.message}).join("\n")}}}}function s(t,n){r.prototype.constructor.call(this,t,e(s.custom,n));var i=[];this._basicFields=Object.keys(b),this._customFields=Object.keys(this._custom),this.origin=null,this.report=function(t){var e={message:t||"was sanitized",property:this.userAlias?this.userAlias+" ("+this._dumpStack()+")":this._dumpStack()};i.some(function(t){return t.property===e.property})||i.push(e)},this.result=function(t){return{data:t,reporting:i,format:function(){return this.reporting.map(function(t){return"Property "+t.property+" "+t.message}).join("\n")}}}}function c(t){var e=_,n=D;return null!=t.gte?e=t.gte:null!=t.gt&&(e=t.gt+1),null!=t.lte?n=t.lte:null!=t.lt&&(n=t.lt-1),{min:e,max:n}}function f(){}var l={};if(l.async="function"==typeof require?require("./async.js"):window.async,"object"!=typeof l.async)throw new Error("Module async is required (https://github.com/caolan/async)");var p=l.async,h={function:function(t){return"function"==typeof t},string:function(t){return"string"==typeof t},number:function(t){return"number"==typeof t&&!isNaN(t)},integer:function(t){return"number"==typeof t&&t%1==0},NaN:function(t){return"number"==typeof t&&isNaN(t)},boolean:function(t){return"boolean"==typeof t},null:function(t){return null===t},date:function(t){return null!=t&&t instanceof Date},object:function(t){return null!=t&&t.constructor===Object},array:function(t){return null!=t&&t.constructor===Array},any:function(t){return!0}},F={void:/^$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)?(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,"date-time":/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?(Z?|(-|\+)\d{2}:\d{2})$/,date:/^\d{4}-\d{2}-\d{2}$/,coolDateTime:/^\d{4}(-|\/)\d{2}(-|\/)\d{2}(T| )\d{2}:\d{2}:\d{2}(\.\d{3})?Z?$/,time:/^\d{2}\:\d{2}\:\d{2}$/,color:/^#([0-9a-f])+$/i,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,numeric:/^[0-9]+$/,integer:/^\-?[0-9]+$/,decimal:/^\-?[0-9]*\.?[0-9]+$/,alpha:/^[a-z]+$/i,alphaNumeric:/^[a-z0-9]+$/i,alphaDash:/^[a-z0-9_-]+$/i,javascript:/^[a-z_\$][a-z0-9_\$]*$/i,upperString:/^[A-Z ]*$/,lowerString:/^[a-z ]*$/},y={optional:function(t,e){!0!==("boolean"==typeof t.optional?t.optional:"true"===t.optional)&&void 0===e&&this.report("is missing and not optional",null,"optional")},type:function(t,e){if(void 0!==e&&("string"==typeof t.type||t.type instanceof Array||"function"==typeof t.type)){var n=h.array(t.type)?t.type:[t.type];n.some(function(t){return i(t,e)})||(n=n.map(function(t){return"function"==typeof t?"and instance of "+t.name:t}),this.report("must be "+n.join(" or ")+", but is "+u(e),null,"type"))}},uniqueness:function(t,e){if("string"==typeof t.uniqueness&&(t.uniqueness="true"===t.uniqueness),"boolean"==typeof t.uniqueness&&!1!==t.uniqueness&&(h.array(e)||"string"==typeof e))for(var n=[],r=0;r<e.length;r++)if(!(n.indexOf(e[r])>=0)){var i=o(e,e[r]);i.length>1&&(n.push(e[r]),this.report("has value ["+e[r]+"] more than once at indexes ["+i.join(", ")+"]",null,"uniqueness"))}},pattern:function(t,e){var n=this,r=t.pattern;if("string"==typeof e){var i=!1;h.array(r)||(r=[r]),r.forEach(function(t){"string"==typeof t&&t in F&&(t=F[t]),t instanceof RegExp&&t.test(e)&&(i=!0)}),i||n.report("must match ["+r.join(" or ")+'], but is equal to "'+e+'"',null,"pattern")}},validDate:function(t,e){"true"===String(t.validDate)&&e instanceof Date&&isNaN(e.getTime())&&this.report("must be a valid date",null,"validDate")},minLength:function(t,e){if("string"==typeof e||h.array(e)){var n=Number(t.minLength);isNaN(n)||e.length<n&&this.report("must be longer than "+n+" elements, but it has "+e.length,null,"minLength")}},maxLength:function(t,e){if("string"==typeof e||h.array(e)){var n=Number(t.maxLength);isNaN(n)||e.length>n&&this.report("must be shorter than "+n+" elements, but it has "+e.length,null,"maxLength")}},exactLength:function(t,e){if("string"==typeof e||h.array(e)){var n=Number(t.exactLength);isNaN(n)||e.length!==n&&this.report("must have exactly "+n+" elements, but it have "+e.length,null,"exactLength")}},lt:function(t,e){var n=Number(t.lt);"number"!=typeof e||isNaN(n)||e>=n&&this.report("must be less than "+n+', but is equal to "'+e+'"',null,"lt")},lte:function(t,e){var n=Number(t.lte);"number"!=typeof e||isNaN(n)||e>n&&this.report("must be less than or equal to "+n+', but is equal to "'+e+'"',null,"lte")},gt:function(t,e){var n=Number(t.gt);"number"!=typeof e||isNaN(n)||e<=n&&this.report("must be greater than "+n+', but is equal to "'+e+'"',null,"gt")},gte:function(t,e){var n=Number(t.gte);"number"!=typeof e||isNaN(n)||e<n&&this.report("must be greater than or equal to "+n+', but is equal to "'+e+'"',null,"gte")},eq:function(t,e){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e){var n=t.eq;if("number"==typeof n||"string"==typeof n||"boolean"==typeof n||h.array(n))if(h.array(n)){for(var r=0;r<n.length;r++)if(e===n[r])return;this.report("must be equal to ["+n.map(function(t){return'"'+t+'"'}).join(" or ")+'], but is equal to "'+e+'"',null,"eq")}else e!==n&&this.report('must be equal to "'+n+'", but is equal to "'+e+'"',null,"eq")}},ne:function(t,e){if("number"==typeof e||"string"==typeof e){var n=t.ne;if("number"==typeof n||"string"==typeof n||h.array(n))if(h.array(n)){for(var r=0;r<n.length;r++)if(e===n[r])return void this.report('must not be equal to "'+n[r]+'"',null,"ne")}else e===n&&this.report('must not be equal to "'+n+'"',null,"ne")}},someKeys:function(t,e){var n=t.someKeys;if(h.object(e)){n.some(function(t){return t in e})||this.report("must have at least key "+n.map(function(t){return'"'+t+'"'}).join(" or "),null,"someKeys")}},strict:function(t,e){if("string"==typeof t.strict&&(t.strict="true"===t.strict),!0===t.strict&&h.object(e)&&h.object(t.properties)){var n=this;if(void 0===t.properties["*"]){var r=Object.keys(e).filter(function(e){return void 0===t.properties[e]});if(r.length>0){var i="should not contains "+(r.length>1?"properties":"property")+" ["+r.map(function(t){return'"'+t+'"'}).join(", ")+"]";n.report(i,null,"strict")}}}},exec:function(t,e,n){var r=this;if("function"==typeof n)return this.asyncExec(t,e,n);(h.array(t.exec)?t.exec:[t.exec]).forEach(function(n){"function"==typeof n&&n.call(r,t,e)})},properties:function(t,e,n){if("function"==typeof n)return this.asyncProperties(t,e,n);if(t.properties instanceof Object&&e instanceof Object){var r,i=t.properties;if(null!=i["*"])for(r in e)r in i||(this._deeperObject(r),this._validate(i["*"],e[r]),this._back());for(r in i)"*"!==r&&(this._deeperObject(r),this._validate(i[r],e[r]),this._back())}},items:function(t,e,n){if("function"==typeof n)return this.asyncItems(t,e,n);if(t.items instanceof Object&&e instanceof Object){var r,i,u=t.items;if(h.array(u)&&h.array(e))for(r=0,i=u.length;r<i;r++)this._deeperArray(r),this._validate(u[r],e[r]),this._back();else for(var o in e)e.hasOwnProperty(o)&&(this._deeperArray(o),this._validate(u,e[o]),this._back())}}},m={asyncExec:function(t,e,n){var r=this;p.eachSeries(h.array(t.exec)?t.exec:[t.exec],function(n,i){if("function"==typeof n){if(n.length>2)return n.call(r,t,e,i);n.call(r,t,e)}p.nextTick(i)},n)},asyncProperties:function(t,e,n){if(!(t.properties instanceof Object&&h.object(e)))return n();var r=this,i=t.properties;p.series([function(t){if(null==i["*"])return t();p.eachSeries(Object.keys(e),function(t,n){if(t in i)return p.nextTick(n);r._deeperObject(t),r._asyncValidate(i["*"],e[t],function(t){r._back(),n(t)})},t)},function(t){p.eachSeries(Object.keys(i),function(t,n){if("*"===t)return p.nextTick(n);r._deeperObject(t),r._asyncValidate(i[t],e[t],function(t){r._back(),n(t)})},t)}],n)},asyncItems:function(t,e,n){if(!(t.items instanceof Object&&e instanceof Object))return n();var r=this,i=t.items;h.array(i)&&h.array(e)?p.timesSeries(i.length,function(t,n){r._deeperArray(t),r._asyncValidate(i[t],e[t],function(t,e){r._back(),n(t,e)}),r._back()},n):p.eachSeries(Object.keys(e),function(t,n){r._deeperArray(t),r._asyncValidate(i,e[t],function(t,e){r._back(),n(t,e)})},n)}};t(a.prototype,y),t(a.prototype,m),t(a,new n),a.prototype.validate=function(t,e){if(this.origin=t,"function"==typeof e){var n=this;return p.nextTick(function(){n._asyncValidate(n._schema,t,function(t){n.origin=null,e(t,n.result())})})}return this._validate(this._schema,t).result()},a.prototype._validate=function(t,e,n){return this.userCode=t.code||null,this.userError=t.error||null,this.userAlias=t.alias||null,this._basicFields.forEach(function(n){(n in t||"optional"===n)&&"function"==typeof this[n]&&this[n](t,e)},this),this._customFields.forEach(function(n){n in t&&"function"==typeof this._custom[n]&&this._custom[n].call(this,t,e)},this),this},a.prototype._asyncValidate=function(t,e,n){var r=this;this.userCode=t.code||null,this.userError=t.error||null,this.userAlias=t.alias||null,p.series([function(n){p.eachSeries(Object.keys(y),function(n,i){p.nextTick(function(){if((n in t||"optional"===n)&&"function"==typeof r[n]){if(r[n].length>2)return r[n](t,e,i);r[n](t,e)}i()})},n)},function(n){p.eachSeries(Object.keys(r._custom),function(n,i){p.nextTick(function(){if(n in t&&"function"==typeof r._custom[n]){if(r._custom[n].length>2)return r._custom[n].call(r,t,e,i);r._custom[n].call(r,t,e)}i()})},n)}],n)};var d={number:function(t,e){var n;if("number"==typeof t)return t;if(""===t)return void 0!==e.def?e.def:null;if("string"==typeof t){if("number"==typeof(n=parseFloat(t.replace(/,/g,".").replace(/ /g,""))))return n}else if(t instanceof Date)return+t;return null},integer:function(t,e){var n;if("number"==typeof t&&t%1==0)return t;if(""===t)return void 0!==e.def?e.def:null;if("string"==typeof t){if("number"==typeof(n=parseInt(t.replace(/ /g,""),10)))return n}else{if("number"==typeof t)return parseInt(t,10);if("boolean"==typeof t)return t?1:0;if(t instanceof Date)return+t}return null},string:function(t,e){return"boolean"==typeof t||"number"==typeof t||t instanceof Date?t.toString():h.array(t)?e.items||e.properties?t:t.join(String(e.joinWith||",")):t instanceof Object?e.items||e.properties?t:JSON.stringify(t):"string"==typeof t&&t.length?t:null},date:function(t,e){if(t instanceof Date)return t;var n=new Date(t);return isNaN(n.getTime())?null:n},boolean:function(t,e){return void 0===t?null:("string"!=typeof t||"false"!==t.toLowerCase())&&!!t},object:function(t,e){if("string"!=typeof t||h.object(t))return t;try{return JSON.parse(t)}catch(t){return null}},array:function(t,e){if(h.array(t))return t;if(void 0===t)return null;if("string"==typeof t){if("["===t.substring(0,1)&&"]"===t.slice(-1))try{return JSON.parse(t)}catch(t){return null}return t.split(String(e.splitWith||","))}return h.array(t)?null:[t]}},g={upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()},title:function(t){return t.replace(/\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()},ucfirst:function(t){return t.charAt(0).toUpperCase()+t.substr(1)},trim:function(t){return t.trim()}},b={strict:function(t,e){if("string"==typeof t.strict&&(t.strict="true"===t.strict),!0!==t.strict)return e;if(!h.object(t.properties))return e;if(!h.object(e))return e;return Object.keys(e).forEach(function(n){n in t.properties||delete e[n]}),e},optional:function(t,e){return!0===("boolean"==typeof t.optional?t.optional:"false"!==t.optional)?e:void 0!==e?e:(this.report(),t.def===Date?new Date:t.def)},type:function(t,e){if("string"!=typeof t.type||"function"!=typeof d[t.type])return e;var n,r="boolean"!=typeof t.optional||t.optional;return"function"==typeof d[t.type]?(null===(n=d[t.type](e,t))&&!r||!n&&isNaN(n)||null===n&&"string"===t.type)&&(n=t.def):r||(n=t.def),(null!=n||void 0!==t.def&&t.def===n)&&n!==e?(this.report(),n):e},rules:function(t,e){var n=t.rules;if("string"!=typeof e||"string"!=typeof n&&!h.array(n))return e;var r=!1;return(h.array(n)?n:[n]).forEach(function(t){"function"==typeof g[t]&&(e=g[t](e),r=!0)}),r&&this.report(),e},min:function(t,e){var n=Number(e);if(isNaN(n))return e;var r=Number(t.min);return isNaN(r)?e:n<r?(this.report(),r):e},max:function(t,e){var n=Number(e);if(isNaN(n))return e;var r=Number(t.max);return isNaN(r)?e:n>r?(this.report(),r):e},minLength:function(t,e){var n=Number(t.minLength);if("string"!=typeof e||isNaN(n)||n<0)return e;var r="",i=n-e.length;if(i>0){for(var u=0;u<i;u++)r+="-";return this.report(),e+r}return e},maxLength:function(t,e){var n=Number(t.maxLength);return"string"!=typeof e||isNaN(n)||n<0?e:e.length>n?(this.report(),e.slice(0,n)):e},properties:function(t,e,n){if("function"==typeof n)return this.asyncProperties(t,e,n);if(!e||"object"!=typeof e)return e;var r,i,u=t.properties;if(void 0!==u["*"])for(i in e)i in u||(this._deeperObject(i),r=this._sanitize(t.properties["*"],e[i]),void 0!==r&&(e[i]=r),this._back());for(i in t.properties)"*"!==i&&(this._deeperObject(i),r=this._sanitize(t.properties[i],e[i]),void 0!==r&&(e[i]=r),this._back());return e},items:function(t,e,n){if("function"==typeof n)return this.asyncItems(t,e,n);if(!(t.items instanceof Object&&e instanceof Object))return e;var r;if(h.array(t.items)&&h.array(e)){var i=t.items.length<e.length?t.items.length:e.length;for(r=0;r<i;r++)this._deeperArray(r),e[r]=this._sanitize(t.items[r],e[r]),this._back()}else for(r in e)e.hasOwnProperty(r)&&(this._deeperArray(r),e[r]=this._sanitize(t.items,e[r]),this._back());return e},exec:function(t,e,n){return"function"==typeof n?this.asyncExec(t,e,n):((h.array(t.exec)?t.exec:[t.exec]).forEach(function(n){"function"==typeof n&&(e=n.call(this,t,e))},this),e)}},v={asyncExec:function(t,e,n){var r=this,i=h.array(t.exec)?t.exec:[t.exec];p.eachSeries(i,function(n,i){if("function"==typeof n){if(n.length>2)return n.call(r,t,e,function(t,n){if(t)return i(t);e=n,i()});e=n.call(r,t,e)}i()},function(t){n(t,e)})},asyncProperties:function(t,e,n){if(!e||"object"!=typeof e)return n(null,e);var r=this,i=t.properties;p.series([function(t){if(null==i["*"])return t();var n=i["*"];p.eachSeries(Object.keys(e),function(t,u){if(t in i)return u();r._deeperObject(t),r._asyncSanitize(n,e[t],function(n,i){void 0!==i&&(e[t]=i),r._back(),u()})},t)},function(t){p.eachSeries(Object.keys(i),function(t,n){if("*"===t)return n();r._deeperObject(t),r._asyncSanitize(i[t],e[t],function(i,u){if(i)return n(i);void 0!==u&&(e[t]=u),r._back(),n()})},t)}],function(t){return n(t,e)})},asyncItems:function(t,e,n){if(!(t.items instanceof Object&&e instanceof Object))return n(null,e);var r=this,i=t.items;if(h.array(i)&&h.array(e)){var u=i.length<e.length?i.length:e.length;p.timesSeries(u,function(t,n){r._deeperArray(t),r._asyncSanitize(i[t],e[t],function(i,u){if(i)return n(i);e[t]=u,r._back(),n()})},function(t){n(t,e)})}else p.eachSeries(Object.keys(e),function(t,n){r._deeperArray(t),r._asyncSanitize(i,e[t],function(i,u){if(i)return n();e[t]=u,r._back(),n()})},function(t){n(t,e)});return e}};t(s.prototype,b),t(s.prototype,v),t(s,new n),s.prototype.sanitize=function(t,e){if(this.origin=t,"function"==typeof e){var n=this;return this._asyncSanitize(this._schema,t,function(t,r){n.origin=null,e(t,n.result(r))})}var r=this._sanitize(this._schema,t);return this.origin=null,this.result(r)},s.prototype._sanitize=function(t,e){return this.userAlias=t.alias||null,this._basicFields.forEach(function(n){(n in t||"optional"===n)&&"function"==typeof this[n]&&(e=this[n](t,e))},this),this._customFields.forEach(function(n){n in t&&"function"==typeof this._custom[n]&&(e=this._custom[n].call(this,t,e))},this),e},s.prototype._asyncSanitize=function(t,e,n){var r=this;this.userAlias=t.alias||null,p.waterfall([function(n){p.reduce(r._basicFields,e,function(e,n,i){p.nextTick(function(){if((n in t||"optional"===n)&&"function"==typeof r[n]){if(r[n].length>2)return r[n](t,e,i);e=r[n](t,e)}i(null,e)})},n)},function(e,n){p.reduce(r._customFields,e,function(e,n,i){p.nextTick(function(){if(n in t&&"function"==typeof r._custom[n]){if(r._custom[n].length>2)return r._custom[n].call(r,t,e,i);e=r._custom[n].call(r,t,e)}i(null,e)})},n)}],n)};var _=-2147483648,D=2147483647,x={int:function(t,e){return t+(0|Math.random()*(e-t+1))},float:function(t,e){return Math.random()*(e-t)+t},bool:function(){return Math.random()>.5},char:function(t,e){return String.fromCharCode(this.int(t,e))},fromList:function(t){return t[this.int(0,t.length-1)]}},j={"date-time":function(){return(new Date).toISOString()},date:function(){return(new Date).toISOString().replace(/T.*$/,"")},time:function(){return(new Date).toLocaleTimeString({},{hour12:!1})},color:function(t,e){var n="#";t<1&&(t=1);for(var r=0,i=x.int(t,e);r<i;r++)n+=x.fromList("0123456789abcdefABCDEF");return n},numeric:function(){return""+x.int(0,D)},integer:function(){return!0===x.bool()?"-"+this.numeric():this.numeric()},decimal:function(){return this.integer()+"."+this.numeric()},alpha:function(t,e){var n="";t<1&&(t=1);for(var r=0,i=x.int(t,e);r<i;r++)n+=x.fromList("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return n},alphaNumeric:function(t,e){var n="";t<1&&(t=1);for(var r=0,i=x.int(t,e);r<i;r++)n+=x.fromList("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");return n},alphaDash:function(t,e){var n="";t<1&&(t=1);for(var r=0,i=x.int(t,e);r<i;r++)n+=x.fromList("_-abcdefghijklmnopqrstuvwxyz_-ABCDEFGHIJKLMNOPQRSTUVWXYZ_-0123456789_-");return n},javascript:function(t,e){for(var n=x.fromList("_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$"),r=0,i=x.int(t,e-1);r<i;r++)n+=x.fromList("_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$0123456789_$");return n}},N={string:function(t){if(null!=t.eq)return t.eq;var e="",n=null!=t.minLength?t.minLength:0,r=null!=t.maxLength?t.maxLength:32;if("string"==typeof t.pattern&&"function"==typeof j[t.pattern])return j[t.pattern](n,r);for(var i=null!=t.exactLength?t.exactLength:x.int(n,r),u=0;u<i;u++)e+=x.char(32,126);return e},number:function(t){if(null!=t.eq)return t.eq;var e=c(t),n=x.float(e.min,e.max);if(null!=t.ne)for(var r=h.array(t.ne)?t.ne:[t.ne];-1!==r.indexOf(n);)n=x.float(e.min,e.max);return n},integer:function(t){if(null!=t.eq)return t.eq;var e=c(t),n=x.int(e.min,e.max);if(null!=t.ne)for(var r=h.array(t.ne)?t.ne:[t.ne];-1!==r.indexOf(n);)n=x.int(e.min,e.max);return n},boolean:function(t){return null!=t.eq?t.eq:x.bool()},null:function(t){return null},date:function(t){return null!=t.eq?t.eq:new Date},object:function(t){var e={},n=t.properties||{};for(var r in n)if(n.hasOwnProperty(r)){if(!0===n[r].optional&&!0===x.bool())continue;if("*"!==r)e[r]=this.generate(n[r]);else for(var i="__random_key_",u=i+0,o=x.int(1,9),a=1;a<=o;a++)u in n||(e[u]=this.generate(n[r])),u=i+a}return e},array:function(t){var e,n,r,i,u=this,o=t.items||{},a=null!=t.minLength?t.minLength:0,s=null!=t.maxLength?t.maxLength:16;if(h.array(o))for(r=o.length,null!=t.exactLength?r=t.exactLength:r<a?r=a:r>s&&(r=s),n=new Array(r),e=null,i=0;i<r;i++)e=o[i].type||"any",h.array(e)&&(e=e[x.int(0,e.length-1)]),n[i]=u[e](o[i]);else for(r=null!=t.exactLength?t.exactLength:x.int(a,s),n=new Array(r),e=o.type||"any",h.array(e)&&(e=e[x.int(0,e.length-1)]),i=0;i<r;i++)n[i]=u[e](o);return n},any:function(t){var e=Object.keys(N);return this[e[x.int(0,e.length-2)]](t)}};t(f.prototype,N);var O=null;f.instance=function(){return O instanceof f||(O=new f),O},f.prototype.generate=function(t){var e=t.type||"any";return h.array(e)&&(e=e[x.int(0,e.length-1)]),this[e](t)};var A={};"undefined"!=typeof module&&module.exports?module.exports=A:window.SchemaInspector=A,A.newSanitization=function(t,e){return new s(t,e)},A.newValidation=function(t,e){return new a(t,e)},A.Validation=a,A.Sanitization=s,A.sanitize=function(t,e,n,r){return 3===arguments.length&&"function"==typeof n&&(r=n,n=null),new s(t,n).sanitize(e,r)},A.validate=function(t,e,n,r){return 3===arguments.length&&"function"==typeof n&&(r=n,n=null),new a(t,n).validate(e,r)},A.generate=function(t,e){if("number"==typeof e){for(var n=new Array(e),r=0;r<e;r++)n[r]=f.instance().generate(t);return n}return f.instance().generate(t)}}();
},{"./async.js":"/wrapper/src/libs/external/async.js"}],"/wrapper/src/libs/external/user-agent-matcher.js":[function(require,module,exports){
"use strict";function uaMatch(e){e=e.toLowerCase();var r=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],i={},o={browser:r[5]||r[3]||r[1]||"",version:r[2]||r[4]||"0",versionNumber:r[4]||r[2]||"0"};if(o.browser&&(i[o.browser]=!0,i.version=o.version,i.versionNumber=parseInt(o.versionNumber,10)),i.rv||i.iemobile){o.browser="msie",i.msie=!0}if(i.edge){delete i.edge;o.browser="msedge",i.msedge=!0}if(i.opr){o.browser="opera",i.opera=!0}if(i.safari&&i.android){o.browser="android",i.android=!0}if(i.safari&&i.kindle){o.browser="kindle",i.kindle=!0}if(i.safari&&i.silk){o.browser="silk",i.silk=!0}return i.name=o.browser,i}module.exports=uaMatch(window.navigator.userAgent);
},{}],"/wrapper/src/libs/gpt-helper.js":[function(require,module,exports){
"use strict";function GptHelper(){function t(t,e){(e=e||window.googletag)&&e.cmd&&e.cmd.push(t)}function e(t){return t=t||window,t.googletag?t.googletag:(t.googletag=t.googletag||{},t.googletag.cmd=t.googletag.cmd||[],Network.jsonp({async:!0,url:Browser.getProtocol()+"//www.googletagservices.com/tag/js/gpt.js",windowScope:t}),t.googletag)}function o(t){return void 0===t?Browser.getNearestEntity("googletag"):Browser.traverseContextTree(function(t){return t.hasOwnProperty("googletag")?t.googletag:null},null,t,t)}function i(t){return Utilities.isObject(t)&&Utilities.isFunction(t.getSlotElementId)&&Utilities.isFunction(t.setTargeting)&&Utilities.isFunction(t.getTargeting)&&Utilities.isFunction(t.clearTargeting)}function r(){return googletag.pubads().getSlots().slice()}function g(t){for(var e=r(),o=0;o<e.length;o++)if(e[o].getSlotElementId()===t)return e[o];return null}return{run:t,loadGpt:e,getGpt:o,isGSlot:i,getGSlots:r,getGSlotByDivId:g}}var Browser=require("browser.js"),Network=require("network.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js");module.exports=GptHelper();
},{"browser.js":"/wrapper/src/libs/browser.js","network.js":"/wrapper/src/libs/network.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/header-tag-slot.js":[function(require,module,exports){
"use strict";function HeaderTagSlot(e,t){function n(e,t){return Number(e)-Number(t)}function r(){return f}function i(){return d}function o(){return y}function a(){return h}function u(e,t){var r,i,o,a,u=[];r=Object.keys(v).sort(n);for(var p=r.length-1;p>=0;p--)if(o=r[p],!(Number(o)>e)){i=Object.keys(v[o]).sort(n);for(var s=i.length-1;s>=0;s--)if(a=i[s],!(Number(a)>t)){u=v[o][a];break}if(u.length>0)break}return u}function p(){return O}function s(){return P}function g(){return T}function l(){return N}function c(e){N=e}var f,d,y,h,v,O,P,T,N;return function(){if(f=e,d=t.id,y=null,h=null,v=null,O=null,P=null,T=null,N=null,t.hasOwnProperty("divId")&&(y=RegExp(t.divId)),t.hasOwnProperty("adUnitPath")&&(h=RegExp(t.adUnitPath)),t.hasOwnProperty("sizeMapping")){var n,r,i,o=/^(\d+)x(\d+)$/;v={};for(var a in t.sizeMapping)t.sizeMapping.hasOwnProperty(a)&&(n=o.exec(a),r=n[1],i=n[2],v.hasOwnProperty(r)||(v[r]={}),v[r][i]=t.sizeMapping[a])}t.hasOwnProperty("targeting")&&(O=t.targeting),t.hasOwnProperty("deviceType")&&(P=t.deviceType),t.hasOwnProperty("position")&&(T=t.position),t.hasOwnProperty("type")&&(N=t.type),t=void 0}(),{getName:r,getId:i,getDivId:o,getAdUnitPath:a,getSizes:u,getTargeting:p,getDeviceType:s,getPosition:g,getType:l,setType:c,__numericSortComparison:n,__sizeMapping:v}}var Whoopsie=require("whoopsie.js");HeaderTagSlot.SlotTypes={INSTREAM_VIDEO:"INSTREAM_VIDEO",BANNER:"BANNER"},module.exports=HeaderTagSlot;
},{"whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/ht-slot-mapper.js":[function(require,module,exports){
"use strict";function HtSlotMapper(r){function e(r,e){for(var t=0;t<r.length;t++){var i,n;"!"===r[t].charAt(0)?(i=r[t].slice(1),n=!0):(i=r[t],n=!1);for(var a=!1,s=0;s<e.length;s++)if(i===e[s]){a=!0;break}if(n===a)return!1}return!0}function t(r,t){for(var i in r)if(r.hasOwnProperty(i)){if(!t.hasOwnProperty(i))return!1;if(!e(r[i],t[i]))return!1}return!0}function i(r,e){for(var t=0;t<o.length;t++)if(0===o[t](r,e))return!1;return!0}function n(r,e,t){for(var i=0;i<t.length;i++){if(t[i](r,e)<=0)return!1}return!0}function a(r,e){if(Utilities.isEmpty(o))return r.slice();for(var t=[],n=0;n<r.length;n++)for(var a=0;a<e.length;a++)if(i(e[a],r[n])){t.push(r[n]);break}return t}function s(r,e){if(Utilities.isEmpty(r)||Utilities.isEmpty(e))return[];for(var t=[],i=r.slice(),a=e.slice(),s=0;s<f.length;s++){for(var o=f[s],l=[],u=a.length-1;u>=0;u--){for(var h=[],c=-1,p=0;p<i.length;p++)if(n(a[u],i[p],o)){for(var g=[],v=0;v<o.length;v++){var y=o[v](a[u],i[p]);g.push(y)}for(var d=0;d<o.length;d++){if(!h[d]||g[d]>h[d]){h=g,c=p;break}if(g[d]<h[d])break}}if(c>=0){var _={};l[c]=!0,_.htSlot=i[c],a[u].firstPartyData&&(_.firstPartyData=a[u].firstPartyData),a[u].reference&&(_.ref=a[u].reference),t.push(_),a.splice(u,1)}}for(var w=i.length-1;w>=0;w--)l[w]&&i.splice(w,1)}return t}var f=[],o=[],l={divId:function(r,e){var t=e.getDivId();return t?t.test(r.divId)?1:0:-1},targeting:function(r,e){var i=e.getTargeting(),n=r.targeting;if(!i)return-1;for(var a=!1,s=0,f=0;f<i.length;f++)if(i[f])if(Utilities.isEmpty(i[f]))a=!0;else if(t(i[f],n)){var o=0;for(var l in i[f])i[f].hasOwnProperty(l)&&(o+=i[f][l].length);s=Math.max(s,o)}return a||s>0?s+1:0},size:function(r,e){var t=e.getSizes(Browser.getViewportWidth(),Browser.getViewportHeight());if(!t)return-1;for(var i=0,n=0;n<t.length;n++){for(var a=0,s=0;s<r.sizes.length;s++)if(t[n][0]===r.sizes[s][0]&&t[n][1]===r.sizes[s][1]){a++;break}if(0===a)return 0;i+=a}return 0===i?0:Math.ceil(100*i/r.sizes.length)},deviceType:function(r,e){var t=e.getDeviceType();return t?t===SpaceCamp.DeviceTypeChecker.getDeviceType()?1:0:-1},adUnitPath:function(r,e){var t=e.getAdUnitPath();return t?t.test(r.adUnitPath)?1:0:-1}};return function(){for(var e=0;e<r.filters.length;e++){if(!l.hasOwnProperty(r.filters[e]))throw Whoopsie("INVALID_CONFIG","Cannot find function "+r.filters[e]+" in HtSlotMapper");o.push(l[r.filters[e]])}for(var t=0;t<r.selectors.length;t++){var i=[],n=r.selectors[t];if(Utilities.isString(n))i.push(l[n]);else for(var a=0;a<n.length;a++)i.push(l[n[a]]);f.push(i)}}(),{__selectors:f,__filters:o,__matcherFunctions:l,select:s,filter:a,__doesTargetArrayMatch:e,__doesTargetingMapMatch:t,__doAllFiltersPass:i}}var Browser=require("browser.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js");module.exports=HtSlotMapper;
},{"browser.js":"/wrapper/src/libs/browser.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/mvt.js":[function(require,module,exports){
"use strict";function MvtBuilder(){function e(e){if(!e.hasOwnProperty("targeting"))return{};var r={};return n.map(function(t){if(e.targeting.hasOwnProperty(t)){var i=e.targeting[t];for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])}}),r}function r(e){var r="";for(var t in e)e.hasOwnProperty(t)&&(r=r+t+"="+e[t].join(",")+"&");return r.slice(0,-1)}function t(e){var r=[],t=[];if(e=Utilities.deepCopy(e),e.map(function(e){if(0===t.length||t[0].price===e.price)t.push(e);else if(t[0].price<e.price){for(var i=0;i<t.length;i++)t[i].hasOwnProperty("dealId")&&delete t[i].targeting.price;t=[e]}e.hasOwnProperty("dealId")&&(r.push(e),t.length>0&&t[0].price>e.price&&delete e.targeting.price)}),t.length>0){var i=Utilities.randomSplice(t);i.hasOwnProperty("dealId")||r.push(i);for(var a=0;a<t.length;a++)t[a].hasOwnProperty("dealId")&&delete t[a].targeting.price}return r}function i(t,i){for(var n={},p=[],u=0;u<i.length;u++){var l=i[u],d=Size.arrayToString(l.size);-1===p.indexOf(d)&&p.push(d),n=Utilities.appendToObject(n,e(l))}var c=p.join("|");t.hasOwnProperty("sz")&&(c=Size.arrayToString(t.sz,"|")),t.hasOwnProperty("cust_params")&&(n=Utilities.appendToObject(n,t.cust_params));var g={correlator:System.generateUniqueId(16,"NUM"),iu:t.iu,description_url:t.description_url,output:"vast",sz:c,url:Browser.getPageUrl(),cust_params:r(n)};for(var f in t)t.hasOwnProperty(f)&&(a.hasOwnProperty(f)||-1!==s.indexOf(f)||(g[f]=t[f]));return g=Utilities.appendToObject(g,a),Network.buildUrl(o.dfp,null,g)}var a,s,n,o;return function(){a={env:"vp",gdfp_req:1,unviewed_position_start:1},s=["sz","cust_params","correlator"],n=["price","deal"],o={dfp:"https://securepubads.g.doubleclick.net/gampad/ads"}}(),{__fixedParams:a,__specialParams:s,__targetingSubGroups:n,__baseUrls:o,__extractTargetingKeyValues:e,__buildCustParamsString:r,mediateVideoBids:t,buildDfpMvt:i}}var Browser=require("browser.js"),Network=require("network.js"),Size=require("size.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js");module.exports=MvtBuilder();
},{"browser.js":"/wrapper/src/libs/browser.js","network.js":"/wrapper/src/libs/network.js","size.js":"/wrapper/src/libs/size.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/network.js":[function(require,module,exports){
"use strict";function Network(e){function t(){return s}function r(e){var t="";for(var r in e)if(e.hasOwnProperty(r))if(Utilities.isObject(e[r]))for(var n in e[r])e[r].hasOwnProperty(n)&&(t+=r+"%5B"+n+"%5D="+encodeURIComponent(e[r][n])+"&");else if(Utilities.isArray(e[r]))for(var i=0;i<e[r].length;i++)t+=r+"%5B%5D="+encodeURIComponent(e[r][i])+"&";else t+=r+"="+encodeURIComponent(e[r])+"&";return t.slice(0,-1)}function n(e,t,n){return"/"!==e[e.length-1]&&t&&(e+="/"),t=t||[],Utilities.isObject(n)&&(n=r(n)),n=n?"?"+n:"",e+t.join("/")+n}function i(t){var i,o=null,a=t.scope||e;if(t.useImgTag)i=a.document.createElement("img");else{i=a.document.createElement("script"),i.type="text/javascript";var s=!0;t.hasOwnProperty("async")&&(s=t.async),i.async=s}var u=t.url;if(t.data){var c;c=Utilities.isString(t.data)?t.data:r(t.data),u=n(t.url,null,c)}var l,d=!1,m=function(){try{if(d)return;d=!0,t.onTimeout&&t.onTimeout(),t.useImgTag||t.continueAfterTimeout||i.parentNode.removeChild(i)}catch(e){}};t.globalTimeout&&SpaceCamp.services.TimerService.addTimerCallback(t.sessionId,m),t.timeout&&(l=setTimeout(m,t.timeout));var p=function(){try{if(d){if(!t.continueAfterTimeout)return}else clearTimeout(l);t.onSuccess&&t.onSuccess(null,System.now(),d),d=!0,t.useImgTag||i.parentNode.removeChild(i)}catch(e){}};null===i.onload?i.onload=p:i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,p())};var f=function(){try{if(d){if(!t.continueAfterTimeout)return}else clearTimeout(l),d=!0;t.onFailure&&t.onFailure(),t.useImgTag||i.parentNode.removeChild(i)}catch(e){}};if(i.onerror=f,o=System.now(),i.src=u,!t.useImgTag){var h=a.document.getElementsByTagName("script")[0];h?h.parentNode.insertBefore(i,h):UserAgentMatcher.msie||UserAgentMatcher.msedge||UserAgentMatcher.mozilla?a.onload=function(){a.document.body.appendChild(i)}:a.document.body.appendChild(i)}return o}function o(o){if(!t()){if(o.jsonp&&"GET"===o.method)return i(o);throw Whoopsie("INTERNAL_ERROR","XHR is not supported in this browser.")}var a=null,s=o.scope||e,u=new s.XMLHttpRequest,c=o.url,l=null;if(o.data)if("GET"===o.method){var d;d=Utilities.isString(o.data)?o.data:r(o.data),c=n(o.url,null,d)}else"POST"===o.method&&(l=Utilities.isString(o.data)?o.data:JSON.stringify(o.data));var m=!0;o.hasOwnProperty("async")&&(m=o.async),u.open(o.method,c,m);var p="application/x-www-form-urlencoded; charset=UTF-8";if(void 0!==o.contentType&&(p=o.contentType),p&&u.setRequestHeader("Content-Type",p),o.headers){o.headers.hasOwnProperty("X-Request-With")||u.setRequestHeader("X-Request-With","XMLHttpRequest");for(var f in o.headers)o.headers.hasOwnProperty(f)&&u.setRequestHeader(f,o.headers[f])}o.withCredentials&&(u.withCredentials=!0);var h,y=!1,T=function(){try{if(y)return;y=!0,o.onTimeout&&o.onTimeout()}catch(e){}};return o.globalTimeout&&SpaceCamp.services.TimerService.addTimerCallback(o.sessionId,T),o.timeout&&(o.continueAfterTimeout?h=setTimeout(T,o.timeout):(u.timeout=o.timeout,u.ontimeout=T)),(o.onSuccess||o.onFailure)&&(u.onreadystatechange=function(){if(4===u.readyState){if(y){if(!o.continueAfterTimeout)return}else clearTimeout(h),u.ontimeout=null;if(200===u.status){if(o.onSuccess)try{o.onSuccess(u.responseText,System.now(),y)}catch(e){}}else if(o.onFailure)try{o.onFailure(u.status)}catch(e){}y=!0}}),a=System.now(),u.send(l),a}function a(e){return e.useImgTag=!0,i(e)}var s;return function(){s=e.XMLHttpRequest&&"string"==typeof(new XMLHttpRequest).responseType}(),{ajax:o,jsonp:i,img:a,buildUrl:n,objToQueryString:r,isXhrSupported:t}}var SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),UserAgentMatcher=require("user-agent-matcher.js");module.exports=Network(window),module.exports.Network=Network;
},{"space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","user-agent-matcher.js":"/wrapper/src/libs/external/user-agent-matcher.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/openrtb.js":[function(require,module,exports){
"use strict";function OpenRtb(){function e(){if(!(this instanceof e))return new e;this.__bidRequest={id:Number(System.generateUniqueId(8,"NUM")),site:{page:""},imp:[]},this.__impCount=0}function t(e){if(!(this instanceof t))return new t(e);try{this.__bidResponse=e}catch(e){throw Whoopsie("INTERNAL_ERROR","cannot parse `bidResponse`")}}return e.prototype.setPage=function(e){this.__bidRequest.site.page=e},e.prototype.setRef=function(e){this.__bidRequest.site.ref=e},e.prototype.getId=function(){return this.__bidRequest.id},e.prototype.addImp=function(e,t,i,s){var r=String(++this.__impCount);return this.__bidRequest.imp.push({banner:e,ext:t,id:r,bidfloor:i,bidfloorcur:s}),r},e.prototype.addVideoImp=function(e,t,i,s){var r=String(++this.__impCount);return this.__bidRequest.imp.push({video:e,ext:t,id:r,bidfloor:i,bidfloorcur:s}),r},e.prototype.addUserEid=function(e){this.__bidRequest.user=this.__bidRequest.user||{},this.__bidRequest.user.eids=this.__bidRequest.user.eids||[],this.__bidRequest.user.eids.push(e)},e.prototype.setGdprConsent=function(e,t){this.__bidRequest.regs=this.__bidRequest.regs||{},this.__bidRequest.regs.ext=this.__bidRequest.regs.ext||{},this.__bidRequest.regs.ext.gdpr=e?1:0,this.__bidRequest.user=this.__bidRequest.user||{},this.__bidRequest.user.ext=this.__bidRequest.user.ext||{},this.__bidRequest.user.ext.consent=t||""},e.prototype.setUspConsent=function(e){this.__bidRequest.regs=this.__bidRequest.regs||{},this.__bidRequest.regs.ext=this.__bidRequest.regs.ext||{},this.__bidRequest.regs.ext.us_privacy=e.uspString},e.prototype.setExt=function(e){this.__bidRequest.ext=e},e.prototype.stringify=function(){return JSON.stringify(this.__bidRequest)},t.prototype.__parseBid=function(e,t){var i={};e.hasOwnProperty("impid")&&(i.impid=e.impid),e.hasOwnProperty("price")&&(i.price=e.price),e.hasOwnProperty("adm")&&(i.adm=e.adm),e.hasOwnProperty("ext")&&(i.ext=e.ext),e.hasOwnProperty("dealid")&&(i.dealid=e.dealid),e.hasOwnProperty("nurl")&&(i.nurl=e.nurl),e.hasOwnProperty("nbr")&&(i.nbr=e.nbr),e.hasOwnProperty("w")&&(i.w=e.w),e.hasOwnProperty("h")&&(i.h=e.h),t.push(i)},t.prototype.__parseVideoBid=function(e,t){var i={};e.hasOwnProperty("price")&&(i.price=e.price),e.hasOwnProperty("ext")&&(i.ext={},e.ext.hasOwnProperty("vasturl")&&(i.ext.vasturl=e.ext.vasturl),e.ext.hasOwnProperty("dealid")&&(i.ext.dealid=e.ext.dealid)),e.hasOwnProperty("impid")&&(i.impid=e.impid),t.push(i)},t.prototype.getId=function(){return this.__bidResponse.id},t.prototype.getCur=function(){return this.__bidResponse.cur||"USD"},t.prototype.getExt=function(){return this.__bidResponse.ext},t.prototype.getBids=function(){var e,t,i=[];if(!this.__bidResponse.hasOwnProperty("seatbid"))return i;t=this.__bidResponse.seatbid;for(var s=0;s<t.length;s++)if(t[s].hasOwnProperty("bid")){e=t[s].bid;for(var r=0;r<e.length;r++)this.__parseBid(e[r],i)}return i},t.prototype.getVideoBids=function(){var e,t,i=[];if(!this.__bidResponse.hasOwnProperty("seatbid"))return i;t=this.__bidResponse.seatbid;for(var s=0;s<t.length;s++)if(t[s].hasOwnProperty("bid")){e=t[s].bid;for(var r=0;r<e.length;r++)this.__parseVideoBid(e[r],i)}return i},{BidRequest:e,BidResponse:t}}var Constants=require("constants.js"),System=require("system.js"),Whoopsie=require("whoopsie.js");module.exports=OpenRtb();
},{"constants.js":"/wrapper/src/libs/constants.js","system.js":"/wrapper/src/libs/system.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/openrtb2_5.js":[function(require,module,exports){
"use strict";function OpenRtb(){function e(){if(!(this instanceof e))return new e;this.__bidRequest={id:System.generateUniqueId(8,"NUM"),site:{page:""},imp:[]},this.__impCount=0}function t(e){if(!(this instanceof t))return new t(e);this.__bidResponse=e}return e.prototype.setPage=function(e){this.__bidRequest.site.page=e},e.prototype.setRef=function(e){this.__bidRequest.site.ref=e},e.prototype.setSiteId=function(e){this.__bidRequest.site.id=e},e.prototype.setPublisher=function(e){this.__bidRequest.site.publisher=e},e.prototype.setSiteExt=function(e){this.__bidRequest.site.ext=e},e.prototype.deviceTypeMapping={desktop:2,mobile:4,tablet:5},e.prototype.setDeviceType=function(e){this.__bidRequest.device=this.__bidRequest.device||{},this.__bidRequest.device.devicetype=this.deviceTypeMapping[e]?this.deviceTypeMapping[e]:e},e.prototype.setSource=function(e){this.__bidRequest.source=e},e.prototype.setTmax=function(e){this.__bidRequest.tmax=e},e.prototype.setAuctionType=function(e){this.__bidRequest.at=e},e.prototype.setExt=function(e){this.__bidRequest.ext=e},e.prototype.setTest=function(){this.__bidRequest.test=1},e.prototype.getId=function(){return this.__bidRequest.id},e.prototype.addImp=function(e){return e.id||(e.id=String(++this.__impCount)),this.__bidRequest.imp.push(e),e.id},e.prototype.setImps=function(e){this.__bidRequest.imp=e},e.prototype.setGdprConsent=function(e,t){this.__bidRequest.regs=this.__bidRequest.regs||{},this.__bidRequest.regs.ext=this.__bidRequest.regs.ext||{},this.__bidRequest.regs.ext.gdpr=e?1:0,this.__bidRequest.user=this.__bidRequest.user||{},this.__bidRequest.user.ext=this.__bidRequest.user.ext||{},this.__bidRequest.user.ext.consent=t||""},e.prototype.stringify=function(){return JSON.stringify(this.__bidRequest)},t.prototype.__parseBid=function(e,t){var i={};e.hasOwnProperty("impid")&&(i.impid=e.impid),e.hasOwnProperty("price")&&(i.price=e.price),e.hasOwnProperty("adm")&&(i.adm=e.adm),e.hasOwnProperty("ext")&&(i.ext=e.ext),e.hasOwnProperty("dealid")&&(i.dealid=e.dealid),e.hasOwnProperty("nurl")&&(i.nurl=e.nurl),e.hasOwnProperty("nbr")&&(i.nbr=e.nbr),e.hasOwnProperty("w")&&(i.w=e.w),e.hasOwnProperty("h")&&(i.h=e.h),t.push(i)},t.prototype.getId=function(){return this.__bidResponse.id},t.prototype.getCur=function(){return this.__bidResponse.cur||"USD"},t.prototype.getBids=function(){var e,t,i=[];if(!this.__bidResponse.hasOwnProperty("seatbid"))return i;t=this.__bidResponse.seatbid;for(var s=0;s<t.length;s++)if(t[s].hasOwnProperty("bid")){e=t[s].bid;for(var r=0;r<e.length;r++)this.__parseBid(e[r],i)}return i},{BidRequest:e,BidResponse:t}}var Constants=require("constants.js"),System=require("system.js"),Whoopsie=require("whoopsie.js");module.exports=OpenRtb();
},{"constants.js":"/wrapper/src/libs/constants.js","system.js":"/wrapper/src/libs/system.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/scribe.js":[function(require,module,exports){
"use strict";function Scribe(){function e(){for(var e,o="unknown",n=/at\s(.+)/g,i=Error().stack,r=0;null!==(e=n.exec(i));){if(2===r){o=e[1];break}r++}return(p?p+" | ":"")+o+":"}function o(e){g=Scribe.LoggingLevels[e]}function n(e){p=e}function i(){window.console=__dummyConsole}function r(){window.console=console}function c(){if(!(g<Scribe.LoggingLevels.ERROR)){var o=Array.prototype.slice.call(arguments);o.unshift(e()),console.error.apply(console,o)}}function l(){if(!(g<Scribe.LoggingLevels.WARN)){var o=Array.prototype.slice.call(arguments);o.unshift(e()),console.warn.apply(console,o)}}function s(){if(!(g<Scribe.LoggingLevels.INFO)){var o=Array.prototype.slice.call(arguments);o.unshift(e()),console.info.apply(console,o)}}function t(){g<Scribe.LoggingLevels.INFO||(console.info.apply(console,[e()]),console.table.apply(console,arguments))}function a(){if(!(g<Scribe.LoggingLevels.DEBUG)){var o=Array.prototype.slice.call(arguments);o.unshift(e()),console.debug.apply(console,o)}}var g,p;return function(){g=Scribe.LoggingLevels.DEBUG,p=SpaceCamp.NAMESPACE+"_"+System.generateUniqueId(4)}(),{__type__:"Scribe",__getPrefix:e,disableNativeLogging:i,enableNativeLogging:r,setLevel:o,setHeader:n,error:c,warn:l,info:s,table:t,debug:a}}var SpaceCamp=require("space-camp.js"),System=require("system.js"),Whoopsie=require("whoopsie.js");Scribe.LoggingLevels={SILENT:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},module.exports=Scribe();
},{"space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/size.js":[function(require,module,exports){
"use strict";function Size(){function r(r){return u[r]}function i(r){return!(!Utilities.isArray(r,"number")||2!==r.length)}function e(r){if(i(r))return!0;if(!Utilities.isArray(r,"array"))return!1;for(var e=0;e<r.length;e++)if(!i(r[e]))return!1;return!0}function t(i,e,t){e=e||",",t=t||"x";var n="";if(Utilities.isArray(i,"array"))for(var u=0;u<i.length;u++)n+=r(i[u])?i[u]:i[u][0]+t+i[u][1]+e;else r(i)?n+=i+e:n+=i[0]+t+i[1]+e;return n.slice(0,-1)}function n(i,e,t){e=e||",",t=t||"x";for(var n=[],u=i.split(e),s=0;s<u.length;s++)if(r(u[s]))n.push(u[s]);else{var a=u[s].split(t);n.push([Number(a[0]),Number(a[1])])}return n}var u={native:!0,fullwidth:!0};return{arrayToString:t,stringToArray:n,isSpecialSize:r,isSize:i,isSizes:e}}var Utilities=require("utilities.js");module.exports=Size();
},{"utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/libs/system.js":[function(require,module,exports){
"use strict";function System(){function t(t,e){t.open("text/html","replace"),t.write(e),t.close()}function e(t,e){t=t||Constants.DEFAULT_UID_LENGTH,e=e||Constants.DEFAULT_UID_CHARSET;for(var n="",r=0;r<t;r++)n+=s[e].charAt(Math.floor(Math.random()*s[e].length));return n}function n(){return e(8,"HEX")+"-"+e(4,"HEX")+"-4"+e(3,"HEX")+"-"+"89ab".charAt(Math.floor(4*Math.random()))+e(3,"HEX")+"-"+e(8,"HEX")}function r(){return(new Date).getTime()}function o(){return i.getTimezoneOffset()}function a(){}var i,s={ALPHANUM:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",ALPHA:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",ALPHA_UPPER:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ALPHA_LOWER:"abcdefghijklmnopqrstuvwxyz",HEX:"0123456789abcdef",NUM:"0123456789"};return function(){i=new Date}(),{UidCharacterSets:s,generateUniqueId:e,generateUuid:n,now:r,getTimezoneOffset:o,documentWrite:t,noOp:a}}var Constants=require("constants.js"),Whoopsie=require("whoopsie.js");module.exports=System();
},{"constants.js":"/wrapper/src/libs/constants.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/utilities.js":[function(require,module,exports){
"use strict";function Utilities(){function r(r){return void 0===r?"undefined":{}.toString.call(r).match(j)[1].toLowerCase()}function n(n){return"string"===r(n)}function t(n){return"number"===r(n)&&!isNaN(n)}function e(n){return"number"===r(n)||"string"===r(n)&&!isNaN(Number(n))}function i(r){return t(r)&&r%1==0}function o(n){return"function"===r(n)}function u(n){return"boolean"===r(n)}function a(n){return"object"===r(n)}function l(n){return"regexp"===r(n)}function f(r,n){var t=r.indexOf(n);t>-1&&r.splice(t,1)}function c(t,e,i){if("array"!==r(t))return!1;if(void 0!==e){if(!n(e))throw Whoopsie("INVALID_TYPE","`type` must be a string");if("class"===e){if(!n(i))throw Whoopsie("INVALID_TYPE","`className` must be a string");for(var o=0;o<t.length;o++)if("object"!=typeof t[o]||t[o].__type__!==i)return!1}else for(var u=0;u<t.length;u++)if(r(t[u])!==e)return!1}return!0}function s(r){return r.length?r.splice(Math.floor(Math.random()*r.length),1)[0]:null}function h(r){var n,t,e;for(e=r.length-1;e>0;e--)n=Math.floor(Math.random()*(e+1)),t=r[e],r[e]=r[n],r[n]=t;return r}function g(r){return JSON.parse(JSON.stringify(r))}function p(){for(var r=Array.prototype.slice.call(arguments),n={},t=0;t<r.length;t++)for(var e in r[t])r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n}function y(){for(var r=Array.prototype.slice.call(arguments),n=[],t=0;t<r.length;t++)for(var e=0;e<r[t].length;e++)n.push(r[t][e]);return n}function v(r){if(n(r)){if(""!==r)return!1}else if(a(r)){for(var t in r)if(r.hasOwnProperty(t))return!1}else{if(!c(r))throw Whoopsie("INVALID_TYPE","`entity` must be either a string, object, or an array");if(r.length)return!1}return!0}function m(r,n,t){void 0===t&&(t=I);for(var e=0;e<r.length;e++){for(var i=!1,o=0;o<n.length&&!(i=t(r[e],n[o]));o++);if(!i)return!1}return!0}function b(r,n,t,e){return n=n||[],e=e||null,t=t||"Error occurred while calling function.",function(){try{r.apply(e,n)}catch(r){}}}function d(r,n){var t=""+r;if(n=+n,n!=n&&(n=0),n<0)throw new RangeError("repeat count must be non-negative");if(n==1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(n),0==t.length||0==n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var e="",i=0;i<n;i++)e+=t;return e}function w(r,n,t){return n>>=0,t=String(t||" "),r.length>n?String(r):(n-=r.length,n>t.length&&(t+=d(t,n/t.length)),t.slice(0,n)+String(r))}function S(r,n,t){return n>>=0,t=String(t||" "),r.length>n?String(r):(n-=r.length,n>t.length&&(t+=d(t,n/t.length)),String(r)+t.slice(0,n))}function A(r,n){n=n||null;try{return eval.call(n,r)}catch(r){}return null}function N(r,n,t){t=t||null;try{return eval.call(t,r+"("+n.join()+")")}catch(r){}return null}function E(){for(var r=Array.prototype.slice.call(arguments),n=r[0],t=1;t<r.length;t++)Array.prototype.push.apply(n,r[t]);return n}function O(){for(var r=Array.prototype.slice.call(arguments),n=r[0],t=1;t<r.length;t++){var e=r[t];for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i])}return n}var j=/\s([a-zA-Z]+)/,I=function(r,n){return r===n};return{randomSplice:s,shuffle:h,deepCopy:g,mergeObjects:p,mergeArrays:y,isArray:c,isEmpty:v,isInteger:i,isString:n,isNumeric:e,isRegex:l,isNumber:t,isBoolean:u,isFunction:o,isObject:a,isArraySubset:m,getType:r,tryCatchWrapper:b,arrayDelete:f,repeatString:d,padStart:w,padEnd:S,evalVariable:A,evalFunction:N,appendToArray:E,appendToObject:O}}var Whoopsie=require("whoopsie.js");module.exports=Utilities();
},{"whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/libs/whoopsie.js":[function(require,module,exports){
"use strict";function Whoopsie(I,E){return new Error(I+": "+E)}Whoopsie.ErrorTokens={MISSING_ARGUMENT:1,INVALID_TYPE:2,INVALID_VALUE:3,MISSING_PROPERTY:4,NUMBER_OUT_OF_RANGE:5,EMPTY_ENTITY:6,INTERNAL_ERROR:7,DUPLICATE_ENTITY:8,INVALID_ARGUMENT:9,INVALID_CONFIG:10},module.exports=Whoopsie;
},{}],"/wrapper/src/loader.js":[function(require,module,exports){
"use strict";function Loader(e){function r(){return __directInterface}var __directInterface;return function(){SpaceCamp.DeviceTypeChecker=DeviceTypeChecker(e.DeviceTypeChecker);for(var r in e.htSlots)if(e.htSlots.hasOwnProperty(r)){var t=HeaderTagSlot(r,e.htSlots[r]);SpaceCamp.htSlots.push(t),SpaceCamp.htSlotsMap[r]=t}__directInterface={Services:{},Layers:{}};for(var i=0;i<ServiceConstructors.length;i++){var c=ServiceConstructors[i].name;if(e.Services.hasOwnProperty(c)||"ComplianceService"===c){var s=ServiceConstructors[i].constructor(e.Services[c]);s&&(SpaceCamp.services[c]=s,s.getDirectInterface&&s.getDirectInterface()&&(__directInterface.Services=Utilities.mergeObjects(__directInterface.Services,s.getDirectInterface())))}}for(var a,o=e.Layers.length-1;o>=0;o--){var n=e.Layers[o].layerId,u=LayerConstructors[n](e.Layers[o].configs);u.getDirectInterface()&&(__directInterface.Layers=Utilities.mergeObjects(__directInterface.Layers,u.getDirectInterface())),a&&u.setNext(a.execute),a=u}}(),{getDirectInterface:r}}var DeviceTypeChecker=require("device-type-checker.js"),HeaderTagSlot=require("header-tag-slot.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),ServiceConstructors=[{name:"EventsService",constructor:require("events-service.js")},{name:"GptService",constructor:require("gpt-service.js")},{name:"PublisherSonarService",constructor:require("publisher-sonar-service.js")},{name:"HeaderStatsService",constructor:require("header-stats-service.js")},{name:"TimerService",constructor:require("timer-service.js")},{name:"ComplianceService",constructor:require("compliance-service.js")},{name:"RenderService",constructor:require("render-service.js")},{name:"AdaptiveTimeoutService",constructor:require("adaptive-timeout-service.js")},{name:"KeyValueService",constructor:require("key-value-service.js")}],LayerConstructors={GptLayer:require("gpt-layer.js"),MediationLayer:require("mediation-layer.js"),PartnersLayer:require("partners-layer.js"),IdentityLayer:require("identity-layer.js"),VideoInterfaceLayer:require("video-interface-layer.js")};module.exports=Loader;
},{"adaptive-timeout-service.js":"/wrapper/src/services/adaptive-timeout-service.js","compliance-service.js":"/wrapper/src/services/compliance-service.js","device-type-checker.js":"/wrapper/src/libs/device-type-checker.js","events-service.js":"/wrapper/src/services/events-service.js","gpt-layer.js":"/wrapper/src/layers/gpt-layer.js","gpt-service.js":"/wrapper/src/services/gpt-service.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","header-tag-slot.js":"/wrapper/src/libs/header-tag-slot.js","identity-layer.js":"/wrapper/src/layers/identity-layer.js","key-value-service.js":"/wrapper/src/services/key-value-service.js","mediation-layer.js":"/wrapper/src/layers/mediation-layer.js","partners-layer.js":"/wrapper/src/layers/partners-layer.js","publisher-sonar-service.js":"/wrapper/src/services/publisher-sonar-service.js","render-service.js":"/wrapper/src/services/render-service.js","space-camp.js":"/wrapper/src/space-camp.js","timer-service.js":"/wrapper/src/services/timer-service.js","utilities.js":"/wrapper/src/libs/utilities.js","video-interface-layer.js":"/wrapper/src/layers/video-interface-layer.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/adaptive-timeout-service/normal-distribution-timeout-module.js":[function(require,module,exports){
"use strict";function NormalDistributionTimeoutModule(){function r(r){for(var t="",e=0;e<r.length-3;e++)t+=String.fromCharCode(r.charCodeAt(e)-4);return t}function t(t,e){var i=r(e.partner),u=e.sessionId,l=e.status;if(u&&"success"===l){var p=System.now();if(a[u]===h.DONE){var f=Cache.getData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME);if(null===f||!f.hasOwnProperty("prt")||!Utilities.isArray(f.prt))return;f=f.prt;for(var m=0;m<f.length;m++)if(f[m].sId===u&&f[m].sst){f[m].rt.hasOwnProperty(i)||(f[m].rt[i]=[]),f[m].rt[i].unshift(p-f[m].sst),Cache.setData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME,{prt:f},n);break}}else{if(!s[u])return;o.hasOwnProperty(u)||(o[u]={}),o[u].hasOwnProperty(i)||(o[u][i]=[]),o[u][i].push(p-s[u])}}}function e(r){var t=r.length;if(0===t)return 0;for(var e=0,i=0;i<t;i++)e+=r[i];return e/t}function i(r){var t=Cache.getData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME);if(null===t||!t.hasOwnProperty("prt")||!Utilities.isArray(t.prt)||0===t.prt.length)return r;t=t.prt;for(var i=[],s=0;s<t.length;s++)if(t[s].hasOwnProperty("rt"))for(var o in t[s].rt)if(t[s].rt.hasOwnProperty(o)){var a=e(t[s].rt[o]);0!==a&&i.push(a)}var n=e(i);if(0===n)return r;for(var h=i.length,f=0,m=0;m<h;m++)f+=Math.pow(i[m]-n,2);f=Math.sqrt(f/h);var c=Math.floor(n+2*f+u),v=Math.floor(r*l),E=Math.floor(r*p);return c<v?c=v:c>E&&(c=E),c}var s,o,a,n=6048e5,u=100,l=.8,p=3,h={IPR:0,DONE:1},f={hs_session_start:function(r){var t=r.sessionId;s.hasOwnProperty(t)&&a[t]===h.IPR||(s[t]=System.now(),a[t]=h.IPR)},hs_session_end:function(r){var t=r.sessionId;if(s[t]&&a[t]===h.IPR){a[t]=h.DONE;var e=Cache.getData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME);null!==e&&e.hasOwnProperty("prt")&&Utilities.isArray(e.prt)?(e=e.prt,e.length>=5&&e.pop()):e=[],e.unshift({sId:t,sst:s[t],rt:o[t]||{}}),Cache.setData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME,{prt:e},n),delete o[t],delete s[t]}},partner_request_complete:function(r){t("partner_request_complete",r)}};return function(){for(var r in f)f.hasOwnProperty(r)&&SpaceCamp.services.EventsService.on(r,f[r]);a={},o={},s={}}(),{getTimeout:i}}var Cache=require("cache.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js");NormalDistributionTimeoutModule.STORAGE_KEY_NAME="lib_mem",module.exports=NormalDistributionTimeoutModule;
},{"cache.js":"/wrapper/src/libs/cache.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/modules/gpt-layer/gpt-clear-targeting.js":[function(require,module,exports){
"use strict";function GptClearTargeting(e,r){function t(e){var t;t=r.pageDemandHistory;for(var a in t)t.hasOwnProperty(a)&&(window.googletag.pubads().clearTargeting(a),delete t[a]);t=r.gSlotDemandHistory;for(var o=0;o<e.length;o++)if(e[o].ref){var n=e[o].ref,i=n.getSlotElementId();if(t.hasOwnProperty(i)){for(var g in t[i])t[i].hasOwnProperty(g)&&n.clearTargeting(g);delete t[i]}}}return function(){r.gSlotDemandHistory=r.gSlotDemandHistory||{},r.pageDemandHistory=r.pageDemandHistory||{}}(),{clearTargeting:t}}var GptHelper=require("gpt-helper.js"),Whoopsie=require("whoopsie.js");module.exports=GptClearTargeting;
},{"gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-destroy-slots.js":[function(require,module,exports){
"use strict";function GptDestroySlots(e,t){function o(e){return s?s(e):window.googletag.destroySlots(e)}function r(e){for(var r=e||GptHelper.getGSlots(),s=0;s<r.length;s++)t.gSlotDisplayHistory.hasOwnProperty(r[s].getSlotElementId())&&delete t.gSlotDisplayHistory[r[s].getSlotElementId()];return o(e)}var s;return function(){t.hasOwnProperty("gSlotDisplayHistory")||(t.gSlotDisplayHistory={});var o=function(){e.override&&e.override.destroySlots&&(s=SpaceCamp.LastLineGoogletag.destroySlots)};SpaceCamp.initQueue.push(o)}(),{destroySlots:r}}var SpaceCamp=require("space-camp.js"),GptHelper=require("gpt-helper.js"),Whoopsie=require("whoopsie.js");module.exports=GptDestroySlots;
},{"gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","space-camp.js":"/wrapper/src/space-camp.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-display.js":[function(require,module,exports){
"use strict";function GptDisplay(e,t,s){function r(e){return c?c(e):window.googletag.display(e)}function i(e){if(t.requestArchitecture===Constants.RequestArchitectures.SRA)for(;p.length;){if(!p[0].done)return;var s=p.shift();s.outParcels&&!Utilities.isEmpty(s.outParcels)&&l(s.outParcels),s.parcels&&!Utilities.isEmpty(s.parcels)&&n(s.sessionId,s.parcels),r(s.divOrSlot)}else e.outParcels&&!Utilities.isEmpty(e.outParcels)&&l(e.outParcels),e.parcels&&!Utilities.isEmpty(e.parcels)&&n(e.sessionId,e.parcels),r(e.divOrSlot)}function a(e){var r={done:!1,divOrSlot:e,outParcels:null,parcels:null,sessionId:""};t.requestArchitecture===Constants.RequestArchitectures.SRA&&p.push(r);var a=null;a=GptHelper.isGSlot(e)?e.getSlotElementId():e;var l=GptHelper.getGSlotByDivId(a);if(!l)return r.done=!0,i(r),Prms.resolve();var n=[];n=t.requestArchitecture===Constants.RequestArchitectures.SRA?GptHelper.getGSlots():l?[l]:[];for(var c=n.length-1;c>=0;c--)t.gSlotDisplayHistory.hasOwnProperty(n[c].getSlotElementId())&&n.splice(c,1);if(!n.length)return r.done=!0,i(r),Prms.resolve();for(var u=[],S=0;S<n.length;S++)u.push({slot:n[S]}),t.gSlotDisplayHistory[n[S].getSlotElementId()]=!0;if(t.initialLoadState===Constants.InitialLoadStates.DISABLED)return r.done=!0,i(r),Prms.resolve();var v=o(u);if(r.outParcels=v,!v.length)return EventsService.emit("warning","No valid Header Tag slots found in call to display."),r.done=!0,i(r),Prms.resolve();var d=t.desktopGlobalTimeout;"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(d=t.mobileGlobalTimeout);try{d=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(d)}catch(e){}SpaceCamp.globalTimeout=d;var g=TimerService.createTimer(d,!0);return TimerService.addTimerCallback(g,function(){EventsService.emit("global_timeout_reached",{sessionId:g})}),r.sessionId=g,EventsService.emit("hs_session_start",{sessionId:g,timeout:d,sessionType:HeaderStatsService.SessionTypes.DISPLAY}),s(g,v).then(function(e){r.parcels=e,r.done=!0,i(r),EventsService.emit("hs_session_end",{sessionId:g})})}var o,l,n,c,p;return function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,t.hasOwnProperty("gSlotDisplayHistory")||(t.gSlotDisplayHistory={}),t.hasOwnProperty("requestArchitecture")||(t.requestArchitecture=Constants.RequestArchitectures.MRA),t.hasOwnProperty("initialLoadState")||(t.initialLoadState=Constants.InitialLoadStates.ENABLED);var s=function(){e.override&&e.override.display&&(c=SpaceCamp.LastLineGoogletag.display)};SpaceCamp.initQueue.push(s),o=GptMapSlots(e,t).mapHtSlots,l=GptClearTargeting(e,t).clearTargeting,n=GptSetTargeting(e,t).setTargeting,p=[]}(),{display:a}}var GptHelper=require("gpt-helper.js"),Prms=require("prms.js"),Constants=require("constants.js"),SpaceCamp=require("space-camp.js"),Whoopsie=require("whoopsie.js"),Utilities=require("utilities.js"),GptMapSlots=require("gpt-map-slots.js"),GptClearTargeting=require("gpt-clear-targeting.js"),GptSetTargeting=require("gpt-set-targeting.js"),HeaderStatsService=require("header-stats-service.js"),TimerService,EventsService;module.exports=GptDisplay;
},{"constants.js":"/wrapper/src/libs/constants.js","gpt-clear-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-clear-targeting.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","gpt-map-slots.js":"/wrapper/src/modules/gpt-layer/gpt-map-slots.js","gpt-set-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-map-slots.js":[function(require,module,exports){
"use strict";function GptMapSlots(t,e){function r(t){for(var e=[],r=0;r<t.length;r++){var i=t[r].slot,a={reference:i};t[r].firstPartyData&&(a.firstPartyData=t[r].firstPartyData),a.divId=i.getSlotElementId();var p=[],o=i.getSizes(Browser.getViewportWidth(),Browser.getViewportHeight())||i.getSizes();if(o){for(var g=0;g<o.length;g++)Utilities.isString(o[g])||p.push([o[g].getWidth(),o[g].getHeight()]);for(var n={},l=i.getTargetingKeys(),u=0;u<l.length;u++)n[l[u]]=i.getTargeting(l[u]).map(function(t){return String(t)});a.sizes=p,a.targeting=n,a.adUnitPath=i.getAdUnitPath(),e.push(a)}}var h=SpaceCamp.htSlots,f=s.filter(h,e);return s.select(f,e)}var i,s;return function(){i=e,s=HtSlotMapper(t.slotMapping)}(),{mapHtSlots:r}}var Browser=require("browser.js"),GptHelper=require("gpt-helper.js"),HtSlotMapper=require("ht-slot-mapper.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js");module.exports=GptMapSlots;
},{"browser.js":"/wrapper/src/libs/browser.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","ht-slot-mapper.js":"/wrapper/src/libs/ht-slot-mapper.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-options.js":[function(require,module,exports){
"use strict";function GptOptions(e,t){function a(){return o?o():window.googletag.pubads().enableSingleRequest()}function n(){return r?r():window.googletag.pubads().disableInitialLoad()}function i(){return t.requestArchitecture=Constants.RequestArchitectures.SRA,a()}function s(){return t.initialLoadState=Constants.InitialLoadStates.DISABLED,n()}var o,r;return function(){t.requestArchitecture=e.enableSingleRequest?Constants.RequestArchitectures.SRA:Constants.RequestArchitectures.MRA,t.initialLoadState=e.disableInitialLoad?Constants.InitialLoadStates.DISABLED:Constants.InitialLoadStates.ENABLED;var a=function(){e.override&&(e.override.enableSingleRequest&&(o=SpaceCamp.LastLineGoogletag.enableSingleRequest),e.override.disableInitialLoad&&(r=SpaceCamp.LastLineGoogletag.disableInitialLoad))};SpaceCamp.initQueue.push(a)}(),{enableSingleRequest:i,disableInitialLoad:s}}var SpaceCamp=require("space-camp.js"),Whoopsie=require("whoopsie.js"),Constants=require("constants.js");module.exports=GptOptions;
},{"constants.js":"/wrapper/src/libs/constants.js","space-camp.js":"/wrapper/src/space-camp.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-refresh.js":[function(require,module,exports){
"use strict";function GptRefresh(e,t,r){function s(e,t){return p?p(e,t):window.googletag.pubads().refresh(e,t)}function i(e,i){e||(e=GptHelper.getGSlots());for(var p=e.slice(),c=e.length-1;c>=0;c--)GptHelper.isGSlot(e[c])||e.splice(c,1);if(t.requestArchitecture===Constants.RequestArchitectures.MRA)for(var l=e.length-1;l>=0;l--)t.gSlotDisplayHistory.hasOwnProperty(e[l].getSlotElementId())||e.splice(l,1);if(!e.length)return s(p,i),Prms.resolve();for(var u=[],g=0;g<e.length;g++)u.push({slot:e[g]}),t.gSlotDisplayHistory[e[g].getSlotElementId()]=!0;var v=a(u);if(!v.length)return EventsService.emit("warning","No valid Header Tag slots found in call to refresh."),s(p,i),Prms.resolve();var S=t.desktopGlobalTimeout;"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(S=t.mobileGlobalTimeout);try{S=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(S)}catch(e){}SpaceCamp.globalTimeout=S;var m=TimerService.createTimer(S,!0);return TimerService.addTimerCallback(m,function(){EventsService.emit("global_timeout_reached",{sessionId:m})}),EventsService.emit("hs_session_start",{sessionId:m,timeout:S,sessionType:HeaderStatsService.SessionTypes.DISPLAY}),r(m,v).then(function(e){o(v),n(m,e),EventsService.emit("hs_session_end",{sessionId:m}),s(p,i)})}var a,o,n,p;return function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,t.hasOwnProperty("gSlotDisplayHistory")||(t.gSlotDisplayHistory={}),t.hasOwnProperty("requestArchitecture")||(t.requestArchitecture=Constants.RequestArchitectures.MRA),t.hasOwnProperty("initialLoadState")||(t.initialLoadState=Constants.InitialLoadStates.ENABLED);var r=function(){e.override&&e.override.refresh&&(p=SpaceCamp.LastLineGoogletag.refresh)};SpaceCamp.initQueue.push(r),a=GptMapSlots(e,t).mapHtSlots,o=GptClearTargeting(e,t).clearTargeting,n=GptSetTargeting(e,t).setTargeting}(),{refresh:i}}var GptHelper=require("gpt-helper.js"),SpaceCamp=require("space-camp.js"),Whoopsie=require("whoopsie.js"),GptMapSlots=require("gpt-map-slots.js"),GptClearTargeting=require("gpt-clear-targeting.js"),GptSetTargeting=require("gpt-set-targeting.js"),Constants=require("constants.js"),Prms=require("prms.js"),HeaderStatsService=require("header-stats-service.js"),TimerService,EventsService;module.exports=GptRefresh;
},{"constants.js":"/wrapper/src/libs/constants.js","gpt-clear-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-clear-targeting.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","gpt-map-slots.js":"/wrapper/src/modules/gpt-layer/gpt-map-slots.js","gpt-set-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-retrieve-and-set-targeting.js":[function(require,module,exports){
"use strict";function GptRetrieveAndSetTargeting(e,t,r){function i(e){var i=s.mapHtSlots(e);if(0===i.length)return EventsService.emit("warning","no valid header tag slots found in call to retrieveDemand"),Prms.resolve();var c=t.desktopGlobalTimeout;"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(c=t.mobileGlobalTimeout);try{c=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(c)}catch(e){}SpaceCamp.globalTimeout=c;var p=TimerService.createTimer(c,!0);return TimerService.addTimerCallback(p,function(){EventsService.emit("global_timeout_reached",{sessionId:p})}),EventsService.emit("hs_session_start",{sessionId:p,timeout:c,sessionType:HeaderStatsService.SessionTypes.DISPLAY}),r(p,i).then(function(e){a.clearTargeting(i),n.setTargeting(p,e),EventsService.emit("hs_session_end",{sessionId:p})})}var s,a,n;return function(){EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,s=GptMapSlots(e,t),a=GptClearTargeting(e,t),n=GptSetTargeting(e,t)}(),{retrieveAndSetTargeting:i}}var GptHelper=require("gpt-helper.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),Whoopsie=require("whoopsie.js"),GptMapSlots=require("gpt-map-slots.js"),GptClearTargeting=require("gpt-clear-targeting.js"),GptSetTargeting=require("gpt-set-targeting.js"),HeaderStatsService=require("header-stats-service.js"),TimerService,EventsService;module.exports=GptRetrieveAndSetTargeting;
},{"gpt-clear-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-clear-targeting.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","gpt-map-slots.js":"/wrapper/src/modules/gpt-layer/gpt-map-slots.js","gpt-set-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js":[function(require,module,exports){
"use strict";function GptSetTargeting(e,t){function r(e,r){for(var i=0;i<r.length;i++)if(!r[i].pass&&r[i].targeting&&!Utilities.isEmpty(r[i].targeting)){e&&"slot"===r[i].targetingType&&EventsService.emit("hs_slot_kv_pushed",{sessionId:e,statsId:r[i].partnerStatsId,htSlotId:r[i].htSlot.getId(),requestId:r[i].requestId,xSlotNames:[r[i].xSlotName]});var s,a=r[i].targeting;for(var g in a)if(a.hasOwnProperty(g))if("page"===r[i].targetingType)s=t.pageDemandHistory,s[g]=s[g]||{},s[g]=!0,window.googletag.pubads().setTargeting(g,a[g]);else{var n=r[i].ref,o=n.getSlotElementId();s=t.gSlotDemandHistory,s[o]=s[o]||{},s[o][g]=!0,n.setTargeting(g,n.getTargeting(g).concat(a[g]))}}}return function(){EventsService=SpaceCamp.services.EventsService,t.gSlotDemandHistory=t.gSlotDemandHistory||{},t.pageDemandHistory=t.pageDemandHistory||{}}(),{setTargeting:r}}var GptHelper=require("gpt-helper.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),EventsService;module.exports=GptSetTargeting;
},{"gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/identity-layer/adserver-org-ip/adserver-org-ip-validator.js":[function(require,module,exports){
"use strict";var Inspector=require("../../../libs/external/schema-inspector.js"),partnerValidator=function(r){var e=Inspector.validate({type:"object",properties:{publisherId:{type:"number"}}},r);return e.valid?null:e.format()};module.exports=partnerValidator;
},{"../../../libs/external/schema-inspector.js":"/wrapper/src/libs/external/schema-inspector.js"}],"/wrapper/src/modules/identity-layer/adserver-org-ip/adserver-org-ip.js":[function(require,module,exports){
"use strict";function retrieve(){var r={ttd_pid:TTD_PID,fmt:FORMAT,p:API.configs.publisherId};API.Utilities.ajax({url:API.Utilities.getProtocol()+BASE_URL,method:"GET",data:r,onSuccess:function(r){try{var e=JSON.parse(r);if(!e.TDID)return void API.registerError("response does not contain TDID");var i=[];for(var t in e)e.hasOwnProperty(t)&&i.push({id:e[t],ext:{rtiPartner:t}});API.registerMatch({source:profile.source,uids:i})}catch(r){API.registerError("response is not valid JSON")}},onFailure:function(r){API.registerError("API returned error response "+r)}})}function main(r){API=r,API.onRetrieve(retrieve)}var API,BASE_URL="//match.adsrvr.org/track/rid",TTD_PID="casale",FORMAT="json",profile={partnerId:"AdserverOrgIp",statsId:"ADSORG",version:"1.3.0",source:"adserver.org",cacheExpiry:{match:6048e5,pass:864e5,error:864e5},targetingKeys:{exchangeBidding:"ixpid_1"}};module.exports={type:"identity",api:"1",main:main,profile:profile};
},{}],"/wrapper/src/modules/identity-layer/identity-partner-factory.js":[function(require,module,exports){
"use strict";function IdentityPartnerFactory(e,t){function r(e){return!!(e&&e.uids&&Utilities.isString(e.source)&&Utilities.isArray(e.uids))&&e.uids.every(function(e){return Boolean(!Utilities.isEmpty(e)&&e.id)})}function n(e,t){var r={match:"hs_identity_response",pass:"hs_identity_pass",error:"hs_identity_error"}[e];EventsService.emit(r,{statsId:C}),EventsService.emit("ip_module_result_"+y,e,t),"match"===e&&(U=t)}function i(e,t){if(!T){T=!0;var r={response:e,version:_.version};"pass"!==e&&(r.data=t),Object.keys(O).length&&(r.consent=O);var i=_.cacheExpiry[e];LocalCache.setData(F,r,i),n(e,t),w&&w()}}function s(e){if(!ComplianceService.isPrivacyEnabled())return null;if("gdpr"===e){var t=ComplianceService.gdpr.getConsent();return t&&t.consentString&&(O.gdpr=!0),t}return null}function o(e){var t=LocalCache.getData(e);return t&&"match"===t.response&&t.data?t.data:null}function c(e){var t={url:e.url,method:e.method,async:!0,withCredentials:!0,jsonp:!1,continueAfterTimeout:!1,timeout:e.timeout||0};return e.onSuccess&&(t.onSuccess=e.onSuccess),e.onTimeout&&(t.onTimeout=e.onTimeout),e.onFailure&&(t.onFailure=e.onFailure),void 0!==e.data&&(t.data=e.data),void 0!==e.contentType&&(t.contentType=e.contentType),Network.ajax(t)}function a(){return _.sonar&&_.sonar.enabled?PublisherSonarService.getSonarPayload(_.sonar.entrypoints):{}}function u(e){E=e}function l(e){return Boolean(_.sonar&&_.sonar.enabled&&PublisherSonarService.getLastUpdated(a())>e.created)}function d(e){return!(!_.consent||!ComplianceService.isPrivacyEnabled())&&((!e.data.consent||!Utilities.isArraySubset(Object.keys(_.consent),Object.keys(e.data.consent)))&&ComplianceService.wait().then(function(){return Object.keys(_.consent).some(function(t){if(e.data.consent&&e.data.consent[t])return!1;var r=ComplianceService[t].getConsent();return r&&r.consentString})}))}function p(e){return e.data.version!==_.version}function v(e){return!r(e.data.data)}function m(){return _.consent&&ComplianceService.isPrivacyEnabled()?ComplianceService.wait():null}function f(){var e=LocalCache.getEntry(F);return Prms.resolve().then(function(){if(!e)return null;var t=I[e.data.response];return t?Prms.all(t.map(function(t){return t.call(null,e)})):null}).then(function(t){return!t||t.indexOf(!0)>-1?null:(EventsService.emit("hs_identity_cached",{statsId:C}),n(e.data.response,e.data.data),e.data)})}function b(){return Prms.resolve().then(function(){return Prms.all(k.map(function(e){return e.call()}))}).then(function(){return new Prms(function(e){EventsService.emit("hs_identity_request",{statsId:C}),T=!1,w=e,EventsService.emit("ip_module_retrieve_"+y)})})}function g(){return C}function S(){return U}function j(){if(E)return E;if(U&&Utilities.isArray(U.uids)&&U.uids.length&&U.uids[0].id){var e={};return e[_.targetingKeys.exchangeBidding]=U.uids[0].id,e}return null}function h(){return f().then(function(e){return e?null:b()})}var _,y,C,P,U,E,O,w,F,T,I={match:[l,v],pass:[l,d,p],error:[p]},k=[m];return function(){ComplianceService=SpaceCamp.services.ComplianceService,EventsService=SpaceCamp.services.EventsService,PublisherSonarService=SpaceCamp.services.PublisherSonarService,_=e.profile,y=_.partnerId,C=_.statsId,U=null,E=null,w=null,F=y,O={},P={Utilities:{buildUrl:Network.buildUrl,getPageUrl:Browser.getPageUrl,getProtocol:Browser.getProtocol,getReferrer:Browser.getReferrer,getTime:System.now,getType:Utilities.getType,isArray:Utilities.isArray,isEmpty:Utilities.isEmpty,isFunction:Utilities.isFunction,isInteger:Utilities.isInteger,isNumeric:Utilities.isNumeric,isString:Utilities.isString,isObject:Utilities.isObject,isTopFrame:Browser.isTopFrame,isXhrSupported:Network.isXhrSupported,ajax:c,getConsent:s,getIdentityResultFrom:o,getPublisherSonarData:a},onRetrieve:EventsService.on.bind(null,"ip_module_retrieve_"+y),onResult:EventsService.on.bind(null,"ip_module_result_"+y),registerMatch:i.bind(null,"match"),registerPass:i.bind(null,"pass"),registerError:i.bind(null,"error"),registerEbTargeting:u,configs:t},e.main(P)}(),{__partnerProfile:_,__partnerApi:P,__cacheBustTriggers:I,__partnerRetrieveWaits:k,get __identityStore(){return U},set __identityStore(e){U=e},get __identityEbKv(){return E},set __identityEbKv(e){E=e},get __retrieveResolve(){return w},set __retrieveResolve(e){w=e},__registerResponseRetrieval:i,__bustCacheForInvalidEids:v,__bustCacheForSonarUpdate:l,__bustCacheForConsentUpdate:d,__bustCacheForModuleUpdate:p,__waitForConsent:m,get __validateEid(){return r},set __validateEid(e){r=e},get __retrieveFromCache(){return f},set __retrieveFromCache(e){f=e},get __retrieveFromPartner(){return b},set __retrieveFromPartner(e){b=e},get __registerRetrieval(){return n},set __registerRetrieval(e){n=e},getStatsId:g,getResults:S,getTargets:j,retrieve:h}}var Browser=require("browser.js"),LocalCache=require("cache.js"),Network=require("network.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),ComplianceService,EventsService,PublisherSonarService;module.exports=IdentityPartnerFactory;
},{"browser.js":"/wrapper/src/libs/browser.js","cache.js":"/wrapper/src/libs/cache.js","network.js":"/wrapper/src/libs/network.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/modules/identity-layer/live-intent-ip/live-intent-ip-validator.js":[function(require,module,exports){
"use strict";var Inspector=require("../../../libs/external/schema-inspector.js"),partnerValidator=function(r){var e=Inspector.validate({type:"object",properties:{}},r);return e.valid?null:e.format()};module.exports=partnerValidator;
},{"../../../libs/external/schema-inspector.js":"/wrapper/src/libs/external/schema-inspector.js"}],"/wrapper/src/modules/identity-layer/live-intent-ip/live-intent-ip.js":[function(require,module,exports){
"use strict";function getFpc(){try{return localStorage.getItem(FPC_KEY)}catch(e){return null}}function getTtdid(){var e=API.Utilities.getIdentityResultFrom("AdserverOrgIp");if(e){if(e.TDID)return e.TDID;if(e.uids){var r=e.uids.find(function(e){return e.id&&e.ext&&"TDID"===e.ext.rtiPartner});if(r)return r.id}}return null}function retrieve(){if(UserAgentMatcher.msie)return void API.registerError("Encrypted pid not supported in Internet Explorer");var e={},r=getFpc();r&&(e.duid=r);var t=getTtdid();t&&(e[TRADE_DESK_ID]=t),API.Utilities.ajax({url:API.Utilities.getProtocol()+BASE_URL,method:"GET",data:e,onSuccess:function(e){try{var r=JSON.parse(e);r&&r.unifiedId?r.unifiedId.id&&r.unifiedId.keyID?API.registerMatch({source:profile.source,uids:[{id:r.unifiedId.id,ext:{keyID:r.unifiedId.keyID,rtiPartner:"LDID",enc:1}}]}):API.registerError("response missing id and/or keyID"):API.registerError("response missing unifiedId object")}catch(e){API.registerError("response is not valid JSON")}},onFailure:function(e){204===e?API.registerPass():API.registerError("API returned error response "+e)}})}function main(e){API=e,API.onRetrieve(retrieve)}var UserAgentMatcher=require("user-agent-matcher.js"),API,TRADE_DESK_ID="44489",FPC_KEY="_li_duid",BASE_URL="//idx.liadm.com/idex/ie/any",profile={partnerId:"LiveIntentIp",statsId:"LVINT",version:"1.1.1",source:"liveintent.com",cacheExpiry:{match:2592e5,pass:864e5,error:864e5},targetingKeys:{exchangeBidding:"ixpid_5"}};module.exports={test:{get getFpc(){return getFpc},set getFpc(e){getFpc=e},get getTtdid(){return getTtdid},set getTtdid(e){getTtdid=e}},type:"identity",api:"1",main:main,profile:profile};
},{"user-agent-matcher.js":"/wrapper/src/libs/external/user-agent-matcher.js"}],"/wrapper/src/modules/identity-layer/live-ramp-ip/live-ramp-ip-validator.js":[function(require,module,exports){
arguments[4]["/wrapper/src/modules/identity-layer/live-intent-ip/live-intent-ip-validator.js"][0].apply(exports,arguments)
},{"../../../libs/external/schema-inspector.js":"/wrapper/src/libs/external/schema-inspector.js","dup":"/wrapper/src/modules/identity-layer/live-intent-ip/live-intent-ip-validator.js"}],"/wrapper/src/modules/identity-layer/live-ramp-ip/live-ramp-ip.js":[function(require,module,exports){
"use strict";function retrieve(){var e={pid:PARTNER_ID,rt:"envelope"},r=API.Utilities.getConsent("gdpr");r&&r.consentString&&(e[profile.consent.gdpr]=r.consentString,e[CONSENT_TCF_KEY]=CONSENT_TCF_VERSION);var i=[],t=profile.sonar.entrypoints[0].key,n=API.Utilities.getPublisherSonarData();n&&n.hasOwnProperty(t)&&(e[t]=n[t].data,e[SONAR_ATTR_KEY]=SONAR_ATTR_EMAIL,i.push(n[t].meta)),API.Utilities.ajax({url:API.Utilities.getProtocol()+BASE_URL,method:"GET",data:e,onSuccess:function(e){try{var r,t=JSON.parse(e);if(!API.Utilities.isObject(t))return void API.registerError("invalid response");if(API.Utilities.isEmpty(t))return void API.registerPass();if(!t.hasOwnProperty("envelope"))return void API.registerError("invalid envelope object");if(API.Utilities.isEmpty(t.envelope))return void API.registerPass();r={source:profile.source,uids:[{id:t.envelope,ext:{rtiPartner:"idl"}}]},i.length&&(r.ext={sonar:i}),API.registerMatch(r)}catch(e){API.registerError("response is not valid JSON")}},onFailure:function(e){204===e?API.registerPass():API.registerError("API returned error response "+e)}})}function main(e){API=e,API.onRetrieve(retrieve)}var API,BASE_URL="//api.rlcdn.com/api/identity",PARTNER_ID=2,SONAR_ATTR_KEY="it",SONAR_ATTR_EMAIL=4,CONSENT_TCF_KEY="ct",CONSENT_TCF_VERSION=1,profile={partnerId:"LiveRampIp",statsId:"LVRAMP",version:"1.3.0",source:"liveramp.com",cacheExpiry:{match:864e5,pass:864e5,error:864e5},consent:{gdpr:"cv"},targetingKeys:{exchangeBidding:"ixpid_3"},sonar:{enabled:!0,entrypoints:[{key:"iv",filter:{attr:1,algo:1}}]}};module.exports={type:"identity",api:"1",main:main,profile:profile};
},{}],"/wrapper/src/modules/identity-layer/merkle-ip/merkle-ip-validator.js":[function(require,module,exports){
"use strict";var Inspector=require("../../../libs/external/schema-inspector.js"),partnerValidator=function(r){var e=Inspector.validate({type:"object",properties:{pubid:{type:"string",minLength:1}}},r);return e.valid?null:e.format()};module.exports=partnerValidator;
},{"../../../libs/external/schema-inspector.js":"/wrapper/src/libs/external/schema-inspector.js"}],"/wrapper/src/modules/identity-layer/merkle-ip/merkle-ip.js":[function(require,module,exports){
"use strict";function retrieve(){var e={},r=[],i=API.Utilities.getPublisherSonarData();for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t].data,r.push(i[t].meta));e.ptk=AUTHORIZATION_TOKEN,e.pubid=API.configs.pubid,API.Utilities.ajax({url:API.Utilities.getProtocol()+BASE_URL,method:"GET",data:e,onSuccess:function(e){try{var i,t=JSON.parse(e);if(!API.Utilities.isObject(t))return void API.registerError("invalid response");var s=[];if(t.ppid){if(!t.ppid.id)return void API.registerError("invalid ppid object");s.push({id:t.ppid.id,ext:{enc:0}})}if(t.pam_id&&!UserAgentMatcher.msie){if(!t.pam_id.id||!t.pam_id.keyID)return void API.registerError("invalid pam_id object");s.push({id:t.pam_id.id,ext:{keyID:t.pam_id.keyID,enc:1}})}s.length?(i={source:profile.source,uids:s},r.length>0&&(i.ext={sonar:r}),API.registerMatch(i)):API.registerPass()}catch(e){API.registerError("response is not valid JSON")}},onFailure:function(e){API.registerError("API returned error response "+e)}})}function main(e){API=e,API.onRetrieve(retrieve)}var UserAgentMatcher=require("user-agent-matcher.js"),API,BASE_URL="//mid.rkdms.com/idsv2",AUTHORIZATION_TOKEN="17c1789b-e660-493b-aa74-3c8fb990dc5f",profile={partnerId:"MerkleIp",statsId:"MRKL",version:"1.4.2",source:"merkleinc.com",cacheExpiry:{match:6048e5,pass:864e5,error:864e5},targetingKeys:{exchangeBidding:"ixpid_4"},sonar:{enabled:!0,entrypoints:[{key:"qs1",filter:{attr:1,algo:2}}]}};module.exports={type:"identity",api:"1",main:main,profile:profile};
},{"user-agent-matcher.js":"/wrapper/src/libs/external/user-agent-matcher.js"}],"/wrapper/src/modules/partners-layer/dynamic-partner-loader/dynamic-partner-loader.js":[function(require,module,exports){
"use strict";function DynamicPartnerLoader(e){function r(e){return-1!==e.indexOf("validator.js")?System.noOp:c[e]}function s(){var s=Utilities.mergeObjects(e,window.adapter.configs),i={exports:{}};window.adapter.bidder(r,i,i.exports),n=i.exports(s)}function i(e,r){return n.retrieve(e,r)}var t,a,n,c={"browser.js":require("browser.js"),"cache.js":require("cache.js"),"classify.js":require("classify.js"),"command-queue.js":require("command-queue.js"),"config-validators.js":require("config-validators.js"),"constants.js":require("constants.js"),"device-type-checker.js":require("device-type-checker.js"),"network.js":require("network.js"),"openrtb.js":require("openrtb.js"),"openrtb2_5.js":require("openrtb2_5.js"),"partner.js":require("partner.js"),"scribe.js":require("scribe.js"),"size.js":require("size.js"),"space-camp.js":require("space-camp.js"),"system.js":require("system.js"),"utilities.js":require("utilities.js"),"whoopsie.js":require("whoopsie.js")};!function(){t={partnerId:"DynamicPartnerLoader",namespace:"DynamicPartnerLoader",statsId:"DYNLDR",version:"1.0.0",targetingType:"slot",enabledAnalytics:{requestTime:!0},features:{demandExpiry:{enabled:!1,value:0},rateLimiting:{enabled:!1,value:0}},targetingKeys:{id:"ix_dyn_id",om:"ix_dyn_cpm",pm:"ix_dyn_cpm",pmid:"ix_dyn_dealid"},bidUnitInCents:1,lineItemType:Constants.LineItemTypes.ID_AND_SIZE,callbackType:Partner.CallbackTypes.ID,architecture:Partner.Architectures.SRA,requestType:Partner.RequestTypes.ANY},s();var r=n.getPartnerId();t.namespace=r,a=Partner(t,e,null,{retriever:i});var c=n.getDirectInterface();if(c.hasOwnProperty(r))for(var o in c[r])c[r].hasOwnProperty(o)&&a._addToDirectInterface(o,c[r][o])}();var o={__baseClass:a,profile:t};return Classify.derive(a,o)}var Classify=require("classify.js"),Constants=require("constants.js"),Partner=require("partner.js"),System=require("system"),Utilities=require("utilities.js");module.exports=DynamicPartnerLoader;
},{"browser.js":"/wrapper/src/libs/browser.js","cache.js":"/wrapper/src/libs/cache.js","classify.js":"/wrapper/src/libs/classify.js","command-queue.js":"/wrapper/src/libs/command-queue.js","config-validators.js":"/wrapper/src/libs/config-validators.js","constants.js":"/wrapper/src/libs/constants.js","device-type-checker.js":"/wrapper/src/libs/device-type-checker.js","network.js":"/wrapper/src/libs/network.js","openrtb.js":"/wrapper/src/libs/openrtb.js","openrtb2_5.js":"/wrapper/src/libs/openrtb2_5.js","partner.js":"/wrapper/src/modules/partners-layer/partner.js","scribe.js":"/wrapper/src/libs/scribe.js","size.js":"/wrapper/src/libs/size.js","space-camp.js":"/wrapper/src/space-camp.js","system":"/wrapper/src/libs/system.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/partners-layer/partner.js":[function(require,module,exports){
"use strict";function Partner(e,t,r,a){function n(e){return function(t){A[e]=t,delete q[e]}}function i(e,t,r){for(var a in r)if(r.hasOwnProperty(a))for(var n in r[a])r[a].hasOwnProperty(n)&&r[a][n].length&&EventsService.emit(t,{sessionId:e,statsId:g.statsId,htSlotId:a,requestId:n,xSlotNames:r[a][n]})}function s(e,r){var a={};return a=e===w.PRICE?{outputCentsDivisor:1,outputPrecision:0,roundingType:"NONE"}:e===w.TARGETING?t.bidTransformer:t.bidTransformerTypes[e],Utilities.mergeObjects(O[e],{bidUnitInCents:g.bidUnitInCents},r||{},a||{})}function o(e){var t=[];g.architecture===Partner.Architectures.FSRA&&t.push([]);for(var r={},a=0;a<e.length;a++){var n=e[a].htSlot.getName();if(C.mapping.hasOwnProperty(n))for(var i="_"+System.generateUniqueId(),s=0;s<C.mapping[n].length;s++){var o={},u=C.mapping[n][s];o.partnerId=g.partnerId,o.partnerStatsId=g.statsId,o.htSlot=e[a].htSlot,o.ref=e[a].ref,o.xSlotRef=C.xSlots[u],o.xSlotName=u,o.requestId=i,e[a].firstPartyData&&(o.firstPartyData=e[a].firstPartyData),e[a].identityData&&(o.identityData=e[a].identityData),g.architecture===Partner.Architectures.MRA?t.push([o]):g.architecture===Partner.Architectures.FSRA?t[0].push(o):(r.hasOwnProperty(u)||(r[u]=0),t.length<r[u]+1&&t.push([]),t[r[u]].push(o),r[u]++)}}return t}function u(e,t){if(0===t.length)return Prms.resolve([]);E.keyValues=KeyValueService.getDefaultKeyValueData(),KeyValueService.hasKeyValueAccess(g.partnerId)&&(E.keyValues=KeyValueService.getKeyValueData());var r=T(t,E);if(Utilities.isEmpty(r))return Prms.resolve([]);g.callbackType===Partner.CallbackTypes.CALLBACK_NAME&&(q[r.callbackId]=n(r.callbackId));var a={};if(g.enabledAnalytics.requestTime){for(var s=0;s<t.length;s++){var o=t[s],u=o.htSlot.getId(),p=o.requestId;a.hasOwnProperty(u)||(a[u]={}),a[u].hasOwnProperty(p)||(a[u][p]=[]),a[u][p].push(o.xSlotName)}i(e,"hs_slot_request",a)}return new Prms(function(n){EventsService.emit("partner_request_sent",{partner:g.partnerId});var s,o,u={url:r.url,data:r.data,method:"GET",timeout:C.timeout,withCredentials:!0,jsonp:!0,sessionId:e,globalTimeout:!0,continueAfterTimeout:!0,onSuccess:function(o,u,p){var c,l="success";try{g.callbackType===Partner.CallbackTypes.NONE?c=JSON.parse(o):(o&&eval.call(null,o),c=A[r.callbackId],delete A[r.callbackId]),p&&!g.parseAfterTimeout||b(e,c,t,a,s,u,p)}catch(t){EventsService.emit("internal_error",g.partnerId+" error parsing demand: "+t,t.stack),l="error",g.enabledAnalytics.requestTime&&!p&&i(e,"hs_slot_error",a)}EventsService.emit("partner_request_complete",{sessionId:e,partner:g.partnerId,status:l}),n(t)},onTimeout:function(){EventsService.emit("partner_request_complete",{sessionId:e,partner:g.partnerId,status:"timeout"}),g.enabledAnalytics.requestTime&&i(e,"hs_slot_timeout",a),n(t)},onFailure:function(){EventsService.emit("partner_request_complete",{sessionId:e,partner:g.partnerId,status:"error"}),g.enabledAnalytics.requestTime&&i(e,"hs_slot_error",a),n(t)}};o=r.networkParamOverrides?Utilities.mergeObjects(u,r.networkParamOverrides):u,g.callbackType!==Partner.CallbackTypes.NONE&&g.requestType!==Partner.RequestTypes.AJAX||(o.jsonp=!1),s=g.requestType===Partner.RequestTypes.JSONP?Network.jsonp(o):Network.ajax(o)})}function p(e){_.push(e)}function c(){return h}function l(e){__directInterface={},__directInterface[g.namespace]=e}function m(e,t){__directInterface[g.namespace][e]=t}function d(){return g.partnerId}function v(){return __directInterface}function y(){return g.features.prefetchDisabled&&g.features.prefetchDisabled.enabled}function f(e,t){if(t=t.slice(),C.rateLimiting.enabled){var r=System.now();if("page"===g.targetingType){if(r<=I)return[];I=r+C.rateLimiting.value}else for(var a=t.length-1;a>=0;a--){var n=t[a].htSlot.getName();S.hasOwnProperty(n)&&r<=S[n]?t.splice(a,1):S[n]=r+C.rateLimiting.value}}if(!t.length)return[];if(P)return P(e,t);for(var i=o(t),s=[],p=0;p<i.length;p++)s.push(u(e,i[p]));return s}var g,h,I,S,__directInterface,P,T,b,O,C,_,A,R,k,q,E={keyValues:{}},w={PRICE:"price",TARGETING:"targeting",VIDEO:"video"};return function(){if(EventsService=SpaceCamp.services.EventsService,RenderService=SpaceCamp.services.RenderService,KeyValueService=SpaceCamp.services.KeyValueService,O={targeting:{bidUnitInCents:1,outputCentsDivisor:1,outputPrecision:0,roundingType:"FLOOR",floor:0,buckets:[{max:2e3,step:5},{max:5e3,step:100}]},price:{bidUnitInCents:1},video:{bidUnitInCents:1,outputCentsDivisor:1,outputPrecision:0,roundingType:"FLOOR",floor:0,buckets:[{max:300,step:1},{max:2e3,step:5},{max:7e3,step:100}]}},g=e,I=0,S={},_=[],q={},A={},C={timeout:0,lineItemType:e.lineItemType,targetingKeys:e.targetingKeys,rateLimiting:e.features.rateLimiting},t.hasOwnProperty("timeout")&&t.timeout>0&&(C.timeout=t.timeout,EventsService.emit("hs_define_partner_timeout",{timeout:C.timeout,statsId:g.statsId})),t.hasOwnProperty("targetingKeyOverride"))for(var n in t.targetingKeyOverride)t.targetingKeyOverride.hasOwnProperty(n)&&C.targetingKeys.hasOwnProperty(n)&&(C.targetingKeys[n]=t.targetingKeyOverride[n]);if(t.hasOwnProperty("rateLimiting")&&(t.rateLimiting.hasOwnProperty("enabled")&&(C.rateLimiting.enabled=t.rateLimiting.enabled),t.rateLimiting.value&&(C.rateLimiting.value=t.rateLimiting.value)),t.hasOwnProperty("lineItemType")&&(C.lineItemType=Constants.LineItemTypes[t.lineItemType]),C.xSlots=t.xSlots,C.mapping=t.mapping,h=!1,r){Utilities.isArray(r)||(r=[r]);var i=[];r.map(function(e){var t=Prms.defer();i.push(t.promise),Network.jsonp({url:e,onSuccess:function(){t.resolve()}})}),Prms.all(i).then(function(){h=!0,EventsService.emit("partner_instantiated",{partner:g.partnerId}),_=CommandQueue(_)})}else EventsService.emit("partner_instantiated",{partner:g.partnerId}),h=!0;RenderService.registerPartner(g.partnerId,C.lineItemType,C.targetingKeys.id),R={},e.hasOwnProperty("bidUnitInCents")&&(R.targeting=BidTransformer(s(w.TARGETING)),R.price=BidTransformer(s(w.PRICE)),R.video=BidTransformer(s(w.VIDEO))),a.retriever?P=a.retriever:(b=a.parseResponse,T=a.generateRequestObj,k=a.adResponseCallback),__directInterface={},__directInterface.hasOwnProperty(g.namespace)||(__directInterface[g.namespace]={}),g.callbackType===Partner.CallbackTypes.ID?__directInterface[g.namespace].adResponseCallback=k:__directInterface[g.namespace].adResponseCallbacks=q}(),{_configs:C,_adResponseStore:A,_bidTransformers:R,_setDirectInterface:l,_addToDirectInterface:m,_generateReturnParcels:o,_emitStatsEvent:i,_pushToCommandQueue:p,_generateBidTransformerConfig:s,getPartnerId:d,getDirectInterface:v,getPrefetchDisabled:y,isReady:c,retrieve:f}}var BidTransformer=require("bid-transformer.js"),CommandQueue=require("command-queue.js"),Constants=require("constants.js"),Network=require("network.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),EventsService,RenderService,KeyValueService;Partner.Architectures={MRA:0,SRA:1,FSRA:2},Partner.CallbackTypes={ID:0,CALLBACK_NAME:1,NONE:2},Partner.RequestTypes={ANY:0,AJAX:1,JSONP:2},module.exports=Partner;
},{"bid-transformer.js":"/wrapper/src/libs/bid-transformer.js","command-queue.js":"/wrapper/src/libs/command-queue.js","constants.js":"/wrapper/src/libs/constants.js","network.js":"/wrapper/src/libs/network.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/modules/partners-layer/prefetch.js":[function(require,module,exports){
"use strict";function Prefetch(e,t){function r(e){h||(h=HtSlotMapper({selectors:["divId"],filters:["deviceType"]}));for(var t=[],r=0;r<e.length;r++)SpaceCamp.htSlotsMap.hasOwnProperty(e[r])&&t.push(SpaceCamp.htSlotsMap[e[r]]);return h.filter(t,[{}]).map(function(e){return e.getName()})}function i(){if(!g||!d)return null;var e=Utilities.evalVariable(u);if(void 0===e||null===e)return null;if(!Utilities.isArray(e,"object")||Utilities.isEmpty(e))return EventsService.emit("error","`"+u+"` must be a non-empty array"),[];for(var t=[],r=", ignoring this p-slot",i=0;i<e.length;i++){var s=e[i];if(Utilities.isEmpty(s))EventsService.emit("error","`"+u+"["+i+"]` must be a non-empty object"+r);else if(s.hasOwnProperty("adUnitPath")&&Utilities.isString(s.adUnitPath)&&!Utilities.isEmpty(s.adUnitPath))if(!s.hasOwnProperty("divId")||Utilities.isString(s.divId)&&!Utilities.isEmpty(s.divId))if(!s.hasOwnProperty("sizes")||Size.isSizes(s.sizes)){if(s.hasOwnProperty("targeting")){if(!Utilities.isArray(s.targeting,"object")){EventsService.emit("error","`"+u+"["+i+"].targeting` must be an array of objects"+r);continue}for(var n=!1,a=0;a<s.targeting.length;a++){var o=s.targeting[a];for(var p in o)o.hasOwnProperty(p)&&(Utilities.isArray(o[p],"string")||(n=!0,EventsService.emit("error","`"+u+"["+i+"].targeting["+a+"]."+p+"` must be an array of strings")))}if(n)continue}!s.hasOwnProperty("deviceType")||DeviceTypeChecker.isValidDeviceType(s.deviceType)?t.push(s):EventsService.emit("error","`"+u+"["+i+"].deviceType` must be a valid device type string"+r)}else EventsService.emit("error","`"+u+"["+i+"].sizes` must be a sizes array"+r);else EventsService.emit("error","`"+u+"["+i+"].divId` must be a non-empty string"+r);else EventsService.emit("error","`"+u+"["+i+"].adUnitPath` is required and must be a non-empty string"+r)}if(!t.length)return[];h||(h=HtSlotMapper(g));var l=h.filter(SpaceCamp.htSlots,t);if("ALL"===d)return h.select(l,t).map(function(e){return e.htSlot.getName()});for(var c=[],v=0;v<t.length;v++)c=Utilities.appendToArray(c,h.select(l,[t[v]]).map(function(e){return e.htSlot.getName()}));return c}function s(){if(!y)return null;var e=Utilities.evalVariable(S);return void 0===e||null===e?null:!Utilities.isString(e)||Utilities.isEmpty(e)?(EventsService.emit("error","`"+S+"` must be a non-empty string"),[]):y.hasOwnProperty(e)?r(y[e]):(EventsService.emit("error",'Unrecognized page type "'+e+'"'),[])}function n(){return _?r(_):null}function a(){for(var e=[i,s,n],t=0;t<e.length;t++){var r=e[t]();if(r)return r}return[]}function o(e,t,r,i){t.drd.promise.then(function(t){for(var s=0;s<t.length;s++)EventsService.emit("hs_slot_prefetch",{sessionId:e,statsId:t[s].partnerStatsId,htSlotId:t[s].htSlot.getId(),requestId:t[s].requestId,xSlotNames:[t[s].xSlotName]}),t[s].ref=r.ref;i.resolve(t)})}function p(e,t,r,i){for(var s=[],n=0;n<i.length;){var a=i[n].htSlot.getName();if(!i[n].prefetch&&f.hasOwnProperty(a)&&f[a].hasOwnProperty(t))for(var p=f[a][t];p.length;){var l=p.shift();if(!(l.timeOfExpiry<System.now())){TimerService.startTimer(l.sessionId);var c=Prms.defer();o(e,l,i[n],c),s.push(c),i.splice(n,1),n--;break}}n++}return s}function l(e,t,r,i,s){var n={};i.map(function(t){n[t.ref]={sessionId:e,timeOfExpiry:1/0,drd:Prms.defer()}}),i.map(function(e){if(!r.getPrefetchDisabled()){var i=n[e.ref],a=i.drd;Prms.all(s).then(function(t){i.timeOfExpiry=System.now()+P;for(var r=[],s=0;s<t.length;s++)for(var n=t[s],o=0;o<n.length;o++){var p=n[o];p.ref===e.ref&&r.push(p)}a.resolve(r)}).catch(function(e){a.resolve([])});var o=e.htSlot.getName();f.hasOwnProperty(o)||(f[o]={}),f[o].hasOwnProperty(t)||(f[o][t]=[]),f[o][t].push(i)}})}function c(e,r){if(e.length){for(var i=[],s=0;s<e.length;s++){var n=e[s];if(SpaceCamp.htSlotsMap.hasOwnProperty(n)){var a={htSlot:SpaceCamp.htSlotsMap[n],prefetch:!0,ref:System.generateUuid()};r&&(a.identityData=r),i.push(a)}else EventsService.emit("error","Unrecognized htSlotName "+n)}if(i.length){var o=TimerService.createTimer(SpaceCamp.globalTimeout,!1);EventsService.emit("hs_session_start",{sessionId:o,timeout:SpaceCamp.globalTimeout,sessionType:HeaderStatsService.SessionTypes.DISPLAY});var p=t.__invokeAllPartners(o,i,!0);TimerService.addTimerCallback(o,function(){for(var e=0;e<p.defers.length;e++)p.defers[e].resolve([])}),Prms.all(p.promises).then(function(){EventsService.emit("hs_session_end",{sessionId:o})})}}}function v(e){if(m){var t=a();t.length&&c(t,e)}}var f,m,h,u,d,g,S,y,_,P=55e3;return function(){if(EventsService=SpaceCamp.services.EventsService,TimerService=SpaceCamp.services.TimerService,f={},m=!1,u="window.headertag.publisher.prefetchSlots",S="window.headertag.pagetype",e.prefetchOnLoad&&(e.prefetchOnLoad.enabled&&(m=!0),e.prefetchOnLoad.configs)){var t=e.prefetchOnLoad.configs.dynamic;t&&(t.var&&(u=t.var),t.slotMapping&&(t.slotMapping.style&&(d=t.slotMapping.style),t.slotMapping.selectors&&t.slotMapping.filters&&(g={selectors:t.slotMapping.selectors,filters:t.slotMapping.filters})));var r=e.prefetchOnLoad.configs.pageType;r&&(r.var&&(S=r.var),r.mapping&&(y=r.mapping));var i=e.prefetchOnLoad.configs.fixed;i&&i.htSlotNames&&(_=i.htSlotNames)}}(),{__storage:f,__prefetchOnLoad:m,__dynamicVar:u,__dynamicSlotMappingConfigs:g,__htSlotMapper:h,__pageTypeVar:S,__pageTypeMapping:y,__fixedList:_,__getHtSlotsByDynamic:i,__getHtSlotsByPageType:s,__getHtSlotsByFixed:n,__copyOverRef:o,prefetch:c,prefetchOnLoad:v,fulfilDemand:p,storeDemand:l}}var DeviceTypeChecker=require("device-type-checker.js"),HtSlotMapper=require("ht-slot-mapper.js"),Prms=require("prms.js"),Size=require("size.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),HeaderStatsService=require("header-stats-service.js"),EventsService,TimerService;module.exports=Prefetch;
},{"device-type-checker.js":"/wrapper/src/libs/device-type-checker.js","header-stats-service.js":"/wrapper/src/services/header-stats-service.js","ht-slot-mapper.js":"/wrapper/src/libs/ht-slot-mapper.js","prms.js":"/wrapper/src/libs/external/prms.js","size.js":"/wrapper/src/libs/size.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/services/adaptive-timeout-service.js":[function(require,module,exports){
"use strict";function AdaptiveTimeoutService(){function t(t){return e.getTimeout(t)}var e;return function(){e=NormalDistributionTimeoutModule()}(),{getTimeout:t}}var NormalDistributionTimeoutModule=require("normal-distribution-timeout-module.js");module.exports=AdaptiveTimeoutService;
},{"normal-distribution-timeout-module.js":"/wrapper/src/modules/adaptive-timeout-service/normal-distribution-timeout-module.js"}],"/wrapper/src/services/compliance-service.js":[function(require,module,exports){
"use strict";function ComplianceService(e){function t(e){e.hasOwnProperty("gdprApplies")&&"boolean"===Utilities.getType(e.gdprApplies)?w=e.gdprApplies:e.hasOwnProperty("isUserInEu")&&"boolean"===Utilities.getType(e.isUserInEu)&&(w=e.isUserInEu),e.hasOwnProperty("consentData")&&"string"===Utilities.getType(e.consentData)&&(y=e.consentData)}function r(e){e.hasOwnProperty("version")&&"integer"===Utilities.getType(e.version)&&(S=e.version),e.hasOwnProperty("uspString")&&"string"===Utilities.getType(e.uspString)&&(C=e.uspString)}function n(e){if(!j){var r=Utilities.getType(e);"undefined"!==r&&(j=!0,"string"===r?y=e:"object"===r&&t(e),R.resolve())}}function i(e,t){var n=Utilities.getType(e);"undefined"!==n&&t&&("object"===n&&r(e),I.resolve())}function s(e,t){return function(){if(e)try{window.__cmp("getConsentData",null,n)}catch(e){}if(t)try{L(n)}catch(e){}}}function a(){return function(){try{window.__uspapi("getUSPData",S,i)}catch(e){}}}function o(e){try{var t;if(t="string"===Utilities.getType(e.data)?JSON.parse(e.data):e.data,!t.hasOwnProperty("__cmpReturn")||"object"!==Utilities.getType(t.__cmpReturn))return;var r=t.__cmpReturn;r.callId===N&&(n(r.returnValue,r.success),window.removeEventListener("message",o,!1))}catch(e){}}function u(e){try{var t;if(t="string"===Utilities.getType(e.data)?JSON.parse(e.data):e.data,!t.hasOwnProperty("__uspapiReturn")||"object"!==Utilities.getType(t.__uspapiReturn))return;var r=t.__uspapiReturn;r.callId===b&&(i(r.returnValue,r.success),window.removeEventListener("message",u,!1))}catch(e){}}function p(e){w=e}function c(){return{applies:w,consentString:y}}function l(){return{version:S,uspString:C}}function m(){return!0}function _(e){return function(){U!==O.COMPLETE&&D&&TimerService.startTimer(D);var t=arguments;E.push(function(){e.apply(null,t)})}}function g(){var e=!1,t=!1,r=!1;if(window.__cmp&&"function"===Utilities.getType(window.__cmp)&&(t=!0),L&&(r=!0),t||r){e=!0;var n=s(t,r);if(n(),P>0){var i=window.setInterval(n,T);h.promise.then(function(){window.clearInterval(i)})}}else{var a=Browser.traverseContextTree(function(e){return e.__cmpLocator?e:null});if(a){e=!0,N=System.generateUniqueId();var u={__cmpCall:{command:"getConsentData",parameter:null,callId:N}};window.addEventListener("message",o,!1),a.postMessage(JSON.stringify(u),"*"),a.postMessage(u,"*")}}return e||R.resolve(),e}function f(){var e=!1;if(window.__uspapi&&"function"===Utilities.getType(window.__uspapi)){e=!0;a()()}else{var t=Browser.traverseContextTree(function(e){var t=e.document.getElementsByName("__uspapiLocator");return t.length>0&&"iframe"===t[0].tagName.toLowerCase()?e:null});if(t){e=!0,b=System.generateUniqueId();var r={__uspapiCall:{command:"getUSPData",parameter:null,version:S,callId:b}};window.addEventListener("message",u,!1),t.postMessage(r,"*")}}return e||I.resolve(),e}function v(){if(U===O.NOT_STARTED){h=Prms.defer(),R=Prms.defer(),I=Prms.defer(),U=O.IN_PROGRESS,h.promise.then(function(){E=CommandQueue(E),U=O.COMPLETE}),Prms.all([R.promise,I.promise]).then(function(){h.resolve()});g(),f();0===P?h.resolve():D||(D=TimerService.createTimer(P,!1,function(){h.resolve()}))}}function d(){return U===O.NOT_STARTED&&v(),U!==O.COMPLETE&&D&&TimerService.startTimer(D),h.promise}var T=250,w,y,S,C,E,U,O={NOT_STARTED:0,IN_PROGRESS:1,COMPLETE:2},P,h,R,I,D,L,j,N=0,b=0;return function t(){if(TimerService=SpaceCamp.services.TimerService,w=e.gdprAppliesDefault,y="",S=1,C="",E=[],P=e.timeout,U=O.NOT_STARTED,j=!1,e.customFn)try{L=eval(e.customFn),"function"!==Utilities.getType(L)&&(L=null)}catch(e){L=null}else L=null;v()}(),{gdpr:{getConsent:c,setApplies:p},usp:{getConsent:l},isPrivacyEnabled:m,delay:_,wait:d,__gdprApplies:w,__gdprConsentString:y,__uspVersion:S,__uspString:C,__retrieve:v,__interpretCmpResultObject:t,__cmpCallback:n,__makeCmpCaller:s,__messageListener:o}}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),Prms=require("prms.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),TimerService;module.exports=ComplianceService;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","prms.js":"/wrapper/src/libs/external/prms.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/services/events-service.js":[function(require,module,exports){
"use strict";function EventsService(){function e(e,r,n){i.hasOwnProperty(e)||(i[e]=[]);var t=System.generateUniqueId();return i[e].push({id:t,fn:n,once:r}),t}function r(r,n){return e(r,!1,n)}function n(r,n){return e(r,!0,n)}function t(e){for(var r in i)if(i.hasOwnProperty(r))for(var n=i[r].length-1;n>=0;n--)if(i[r][n].id===e)return void i[r].splice(n,1)}function o(){var e=Array.prototype.slice.call(arguments),r=e.shift();if(r&&i.hasOwnProperty(r))for(var n=i[r].length-1;n>=0;n--){try{i[r][n].fn.apply(null,e)}catch(e){}i[r][n].once&&i[r].splice(n,1)}}var i;return function(){i={}}(),{__eventsMap:i,__on:e,on:r,once:n,off:t,emit:o}}var System=require("system.js"),Whoopsie=require("whoopsie.js");module.exports=EventsService;
},{"system.js":"/wrapper/src/libs/system.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/services/gpt-service.js":[function(require,module,exports){
"use strict";function GptService(t){function e(t){GptHelper.loadGpt().cmd.push(function(){r(null,[{targetingType:"page",targeting:t}])})}var r;return function(){r=GptSetTargeting(t,{}).setTargeting}(),{get __setTargeting(){return r},set __setTargeting(t){r=t},setIdentityTargeting:e}}var GptHelper=require("gpt-helper.js"),GptSetTargeting=require("gpt-set-targeting.js");module.exports=GptService;
},{"gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","gpt-set-targeting.js":"/wrapper/src/modules/gpt-layer/gpt-set-targeting.js"}],"/wrapper/src/services/header-stats-service.js":[function(require,module,exports){
"use strict";function HeaderStats(e){function t(e){var t={auction_cycle:"ac",global_timeout:"gt",bid_requests:"brq",bid_responses:"brs",bid_errors:"be",bid_passes:"bp",bid_timeouts:"bt",dfp_kv_pushed:"kv",top_bid:"tb",prefetch:"p",res_latency:"rl",partner_timeout:"pt"};return t.hasOwnProperty(e)?t[e]:e}function s(){if(Utilities.isEmpty(g))return[];var e={s:"identity",t:U,xslots:{}};for(var s in g)if(g.hasOwnProperty(s)){e.xslots.hasOwnProperty(s)||(e.xslots[s]={});for(var r=0;r<g[s].length;r++){var i=g[s][r];"bid_requests"!==i.n&&"res_latency"!==i.n||(i.v=String(i.v)),e.xslots[s].hasOwnProperty(i.x)||(e.xslots[s][i.x]={});var n=t(i.n);e.xslots[s][i.x][n]=i.v}E.hasOwnProperty(s)&&!1!==E[s]||(e.xslots[s].before[t("partner_timeout")]=q,E[s]=!0)}return g={},[e]}function r(e,t){Utilities.isEmpty(g)&&(U=System.now());var s=t.statsId;g[s]=g[s]||[];var r={b:s,x:k?"after":"before"};"hs_identity_request"===e?(r.n="bid_requests",r.v=1,I[s]=System.now()):"hs_identity_cached"===e?(r.n="bid_requests",r.v=0):"hs_identity_response"===e?(r.n="bid_responses",r.v=1):"hs_identity_error"===e?(r.n="bid_errors",r.v=1):"hs_identity_pass"===e?(r.n="bid_passes",r.v=1):"hs_identity_timeout"===e?(r.n="bid_timeouts",r.v=1):"hs_identity_bid_latency"===e&&(r.n="res_latency",r.v=System.now()-I[s]),g[s].push(r)}function i(e,s){if(!N.hasOwnProperty(e)||Utilities.isEmpty(s))return[];var r=["bid_requests","bid_responses","bid_errors","bid_passes","bid_timeouts"],i={s:"data",t:System.now(),xslots:{UNKN:{}}};for(var n in s)if(s.hasOwnProperty(n)){var o=s[n];for(var a in o.events)if(o.events.hasOwnProperty(a))for(var _ in o.events[a])if(o.events[a].hasOwnProperty(_)&&-1!==r.indexOf(_))for(var d in o.events[a][_])if(o.events[a][_].hasOwnProperty(d)){var u=o.events[a][_][d],v=u.v,y=t(_);i.xslots.UNKN.hasOwnProperty(d)||(i.xslots.UNKN[d]={},i.xslots.UNKN[d][t("res_latency")]=S[e]),i.xslots.UNKN[d].hasOwnProperty(y)||(i.xslots.UNKN[d][y]=0),i.xslots.UNKN[d][y]+=v}}return[i]}function n(e,s){var r=[],i="",n="";for(var o in s)if(s.hasOwnProperty(o)){var a=s[o],_={s:a.s,t:a.t,xslots:{}};for(n in a.events)if(a.events.hasOwnProperty(n)){for(var d in a.events[n])if(a.events[n].hasOwnProperty(d))for(i in a.events[n][d])if(a.events[n][d].hasOwnProperty(i)){var u=a.events[n][d][i],v=u.v,y=t(d);"res_latency"===u.n&&(u.v=String(u.v)),_.xslots.hasOwnProperty(n)||(_.xslots[n]={}),_.xslots[n].hasOwnProperty(i)||(_.xslots[n][i]={}),_.xslots[n][i][y]=v}for(i in _.xslots[n])_.xslots[n].hasOwnProperty(i)&&O.hasOwnProperty(n)&&(_.xslots[n][i][t("partner_timeout")]=O[n])}r.push(_)}return r}function o(e){if(w.hasOwnProperty(e)&&w[e]!==T.IPR&&w[e]!==T.SENT){var r={p:P[e],d:SpaceCamp.DeviceTypeChecker.getDeviceType(),c:u,s:e,w:y,t:System.now(),pg:{t:h,e:f[e]}};r[t("global_timeout")]=String(S[e]),v.auctionCycle&&(r.ac=c[e]),r.sl=Utilities.mergeArrays(n(e,m[e]),i(e,m[e]),s()),r.akamaiDebugInfo=b[e],delete b[e],delete f[e],delete m[e],delete S[e],delete N[e],delete P[e];var o=Network.buildUrl(_,null,{s:d,u:Browser.getPageUrl(),v:3});Network.ajax({method:"POST",url:o,data:r}),w[e]=T.SENT}}function a(e,t){var s=t.sessionId,r=t.htSlotId,i=t.statsId,n=t.xSlotNames,o=t.requestId||"";if(w.hasOwnProperty(s)&&w[s]!==T.DONE&&w[s]!==T.SENT){m[s].hasOwnProperty(r)||(m[s][r]={s:r,t:System.now(),events:{}}),m[s][r].events.hasOwnProperty(i)||(m[s][r].events[i]={}),m[s][r].events[i].hasOwnProperty(e)||(m[s][r].events[i][e]={});for(var a=m[s][r].events[i][e],_=0;_<n.length;_++){var d=n[_],u=s+i+r+d+o;if(!x[u]){"bid_timeouts"===e&&(x[u]=!0),a.hasOwnProperty(d)||(a[d]={n:e,v:0,b:i,x:d});var v=a[d];if("res_latency"===e){var y=System.now()-p[u];delete p[u],(!v.v||v.v>y)&&(v.v=y)}else"prefetch"===e?v.v=1:v.v++;"bid_requests"===e?p[u]=System.now():"bid_responses"===e&&EventsService.emit("hs_slot_valid_bid_latency",t)}}}}if(!Network.isXhrSupported())return null;var _,d,u,v,y,h,p,l,c,f,m,b,w,S,P,O,x,N,g,q,E,I,U,k,T={IPR:0,DONE:1,SENT:2},D={hs_session_start:function(e){var t=e.sessionId;w.hasOwnProperty(t)||(w[t]=T.IPR,l[t]=System.now(),f[t]=[],m[t]={},P[t]=HeaderStats.SessionTypes.DISPLAY,P[t]=e.sessionType,S[t]=e.timeout);var s=Cache.getData(NormalDistributionTimeoutModule.STORAGE_KEY_NAME);null!==s&&s.hasOwnProperty("prt")&&Utilities.isArray(s.prt)&&0!==s.prt.length||(N[t]=!0)},hs_session_end:function(e){var t=e.sessionId;w.hasOwnProperty(t)&&w[t]!==T.DONE&&(c[t]=String(System.now()-l[t]),delete l[t],setTimeout(function(){w[t]=T.DONE,o(t)},0))},hs_akamai_debug:function(e){var t=e.sessionId;b[t]={},b[t].hostname=e.hostname,e.hasOwnProperty("requestHost")&&(b[t].requestHost=e.requestHost),e.hasOwnProperty("akamaiPresent")&&(b[t].akamaiPresent=e.akamaiPresent)},hs_slot_request:function(e){a("bid_requests",e)},hs_slot_bid:function(e){a("bid_responses",e)},hs_slot_pass:function(e){a("bid_passes",e)},hs_slot_timeout:function(e){a("bid_timeouts",e)},hs_slot_error:function(e){a("bid_errors",e)},hs_slot_highest_bid:function(e){a("top_bid",e)},hs_slot_valid_bid_latency:function(e){a("res_latency",e)},hs_slot_kv_pushed:function(e){a("dfp_kv_pushed",e)},hs_slot_prefetch:function(e){a("prefetch",e)},hs_define_partner_timeout:function(e){O[e.statsId]=String(e.timeout)},hs_identity_request:function(e){r("hs_identity_request",e)},hs_identity_cached:function(e){r("hs_identity_cached",e)},hs_identity_response:function(e){r("hs_identity_response",e),EventsService.emit("hs_identity_bid_latency",e)},hs_identity_error:function(e){r("hs_identity_error",e),EventsService.emit("hs_identity_bid_latency",e)},hs_identity_pass:function(e){r("hs_identity_pass",e),EventsService.emit("hs_identity_bid_latency",e)},hs_identity_bid_latency:function(e){Utilities.isNumber(I[e.statsId])&&r("hs_identity_bid_latency",e)},hs_identity_timeout:function(e){r("hs_identity_timeout",e),k=!0},hs_define_identity_timeout:function(e){q=String(e.timeout)}};return function(){EventsService=SpaceCamp.services.EventsService,h=System.now(),_="https://as-sec.casalemedia.com/headerstats",d=e.siteId,u=e.configId,v=e.options,y=d+System.now(),y+=System.generateUniqueId(32-y.length),SpaceCamp.instanceId=y,w={},f={},m={},b={},p={},l={},c={},P={},S={},O={},x={},N={},g={},I={},k=!1,E={};for(var t in D)D.hasOwnProperty(t)&&SpaceCamp.services.EventsService.on(t,D[t])}(),{__pageEvents:f,__slotStats:m,__requestStartTimes:p,__sessionStates:w,__identityEvents:g,__akamaiDebugInfo:b,__recordIdentityEvent:r,__transformIdentityStats:s}}var Browser=require("browser.js"),Cache=require("cache.js"),NormalDistributionTimeoutModule=require("normal-distribution-timeout-module.js"),Network=require("network.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),EventsService;HeaderStats.SessionTypes={DISPLAY:"display",VIDEO:"video"},module.exports=HeaderStats;
},{"browser.js":"/wrapper/src/libs/browser.js","cache.js":"/wrapper/src/libs/cache.js","network.js":"/wrapper/src/libs/network.js","normal-distribution-timeout-module.js":"/wrapper/src/modules/adaptive-timeout-service/normal-distribution-timeout-module.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/services/key-value-service.js":[function(require,module,exports){
"use strict";function KeyValueService(){function e(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function t(){return Utilities.deepCopy(s)}function i(){return Utilities.deepCopy(a)}function u(){return!0}function r(t){return!!e(t)&&(a.site=Utilities.deepCopy(t),!0)}function n(t){return!!e(t)&&(a.user=Utilities.deepCopy(t),!0)}var s={site:{},user:{}},a={};return function(){a=Utilities.deepCopy(s)}(),{getDefaultKeyValueData:t,getKeyValueData:i,hasKeyValueAccess:u,setSiteKeyValueData:r,setUserKeyValueData:n}}var Utilities=require("utilities.js");module.exports=KeyValueService;
},{"utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/services/publisher-sonar-service.js":[function(require,module,exports){
"use strict";function PublisherSonarService(){function e(){if(u)for(var e in localStorage)if(localStorage.hasOwnProperty(e)&&0===e.indexOf(c)){var t=e.split("_");if(!(t.length<5)){var r={attr:parseInt(t[1],10),algo:parseInt(t[2],10),impl:parseInt(t[3],10),prov:t[4],name:t[5]||""};if(r.attr>0&&r.algo>0&&r.impl>0&&r.prov){var a;try{a=JSON.parse(localStorage.getItem(e))}catch(e){continue}a.created=a.created||0,a&&a.value&&Utilities.isString(a.value)&&Utilities.isInteger(a.created)&&!(a.created>System.now())&&(o[t.slice(1).join("_")]={time:a.created,data:a.value,meta:r})}}}}function t(){o={},e()}function r(e){var t={};return e.forEach(function(e){for(var r in o)if(o.hasOwnProperty(r)){var a=!0,i=o[r].meta;for(var s in e.filter)if(e.filter.hasOwnProperty(s)&&i[s]!==e.filter[s]){a=!1;break}if(a){var n=e.key||l+r;t[n]=o[r];break}}}),t}function a(e){return o||t(),e?r(e):Utilities.deepCopy(o)}function i(e){return e||(o||t(),e=o),Object.keys(e).reduce(function(t,r){return e[r].time>t?e[r].time:t},0)}function s(e,t){switch(e){case 1:return SHA1(t).toString(BASE64);case 2:return SHA256(t).toString(BASE64);case 3:return SHA512(t).toString(BASE64);default:return t.toString(BASE64)}}function n(e){return!Utilities.isString(e)||Utilities.isEmpty(e)?{status:!1,message:"Email must be a non empty string"}:u?(S.forEach(function(t){var r=[c,1,t,1,"sp"],a=s(t,e),i={value:a,created:System.now()};localStorage.setItem(r.join("_"),JSON.stringify(i))}),t(),{status:!0,message:"Successfully stored email"}):{status:!1,message:"Local Storage not available"}}var o,u,c="ixps",l="sonar_",S=[1,2,3];return function(){u=Browser.isLocalStorageSupported()}(),{__localStorageAvailable:u,__generateHash:s,getSonarPayload:a,getLastUpdated:i,setSonarEmail:n}}var SHA1=require("crypto-js/sha1"),SHA256=require("crypto-js/sha256"),SHA512=require("crypto-js/sha512"),BASE64=require("crypto-js/enc-base64"),Browser=require("browser.js"),System=require("system.js"),Utilities=require("utilities.js");module.exports=PublisherSonarService;
},{"browser.js":"/wrapper/src/libs/browser.js","crypto-js/enc-base64":2,"crypto-js/sha1":3,"crypto-js/sha256":4,"crypto-js/sha512":5,"system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/services/render-service.js":[function(require,module,exports){
"use strict";function RenderService(e){function r(e,r,i,t){if(e.hasOwnProperty(r)&&e[r].hasOwnProperty(i)){for(var n=null,a=0;a<t.length;a++){var s=t[a];e[r][i].hasOwnProperty(s)&&(n=e[r][i][s])}return n}}function i(e){return!!p.hasOwnProperty(e)&&(l[e]=!0,delete p[e],!0)}function t(){var e=System.now();for(var r in p)p.hasOwnProperty(r)&&p[r].timeOfExpiry&&e>p[r].timeOfExpiry&&i(r)}function n(e){var r;do{r=System.generateUniqueId(Constants.PUBKIT_AD_ID_LENGTH,"ALPHANUM")}while(p.hasOwnProperty[r]);return p[r]=e,r}function a(e){if(p.hasOwnProperty(e)&&p[e].timeOfExpiry&&System.now()>p[e].timeOfExpiry&&i(e),l[e])return EventsService.emit("internal_info","Attempted to render expired ad "+e),null;if(!p.hasOwnProperty(e))throw Whoopsie("INVALID_VALUE","`pubKitAdId` does not match any registered ad");var r=p[e];return i(e),r}function s(e){if(e.auxFn)try{e.auxFn.apply(null,e.auxArgs)}catch(e){EventsService.emit("internal_error","Error occurred running ad aux function.",e.stack)}}function o(e,r){var i=a(r);if(!i)return!1;s(i);try{System.documentWrite(e,i.adm)}catch(e){return EventsService.emit("internal_error",'Error occurred while rendering ad "'+r+'".',e.stack),!1}return!0}function d(e){var r=n(e);if(e.price||e.dealId){var i=e.partnerId,t=e.requestId;if(h.hasOwnProperty(i)){var a;a=Utilities.isString(e.size)?e.size:Size.arrayToString(e.size),Size.isSpecialSize(a)&&(_[t]=a),y[i]||(y[i]={}),y[i][a]||(y[i][a]={}),y[i][a][t]||(y[i][a][t]=[]),y[i][a][t].push(r);var s=e.price;s&&(g[i]||(g[i]={}),g[i][s]||(g[i][s]={}),g[i][s][t]||(g[i][s][t]=[]),g[i][s][t].push(r));var o=e.dealId;return o&&(S[i]||(S[i]={}),S[i][o]||(S[i][o]={}),S[i][o][t]||(S[i][o][t]=[]),S[i][o][t].push(r)),r}}}function v(e,r,i,t,n){try{if(!y.hasOwnProperty(e))return void EventsService.emit("internal_error","Partner "+e+" missing from ad ID map.");if(!Utilities.isObject(i))return void EventsService.emit("internal_error","invalid targeting map");if(!i.hasOwnProperty(h[e].idKey))return void EventsService.emit("internal_error","targeting map missing key "+h[e].idKey);var a=i[h[e].idKey];if(!Utilities.isArray(a))return void EventsService.emit("internal_error","invalid targeting map");if(!Utilities.isNumeric(t))return void EventsService.emit("internal_error","invalid width");if(!Utilities.isNumeric(n))return void EventsService.emit("internal_error","invalid height");var s=t+"x"+n;if(f&&f.hasOwnProperty(s)){var d=f[s];s=d[0]+"x"+d[1]}for(var v=0;v<a.length;v++){var c=a[v],u=_[c]||s;if(!y[e].hasOwnProperty(u))return void EventsService.emit("internal_error","Size key "+u+" missing from ad ID map for partner "+e);if(y[e][u].hasOwnProperty(c)){var p=y[e][u][c];if(p.length){o(r,Utilities.randomSplice(p));break}}}}catch(r){EventsService.emit("internal_error",'Error occurred while rendering ad for "'+e+'".',r.stack)}}function c(e,i){if(void 0!==e.partner&&void 0!==e.id&&void 0!==e.targeting&&(void 0!==e.size||void 0!==e.price)){var t=e.partner,n=e.price,o=e.id,d=e.targeting,v=e.size;if(h[t]){if(!d.hasOwnProperty(h[t].idKey))return void EventsService.emit("internal_error","targeting map missing key "+h[t].idKey);var c=d[h[t].idKey],u=null;if(void 0!==n)for(var p=[S,g],l=0;l<p.length&&!(u=r(p[l],t,n,c));l++);else{if(!Size.isSize(v))return;var m=Size.arrayToString(v);if(f&&f.hasOwnProperty(m)){var _=f[m];m=Size.arrayToString(_)}u=r(y,t,m,c)}if(u){var E=Utilities.randomSplice(u),w=a(E);if(!w)return void EventsService.emit("internal_error","No ad found for ad ID "+E);s(w);for(var O,P=w.size,x=w.adm,I=document.getElementsByTagName("iframe"),z=0;z<I.length;z++)if(I[z].contentWindow===i){O=I[z];break}O&&(O.width=String(P[0]),O.height=String(P[1]),""!==O.parentElement.style.width&&""!==O.parentElement.style.height&&(O.parentElement.style.width=P[0]+"px",O.parentElement.style.height=P[1]+"px")),i.postMessage("ix_ht_render_adm:"+JSON.stringify({adm:x,id:o,size:P}),"*")}}}}function u(e,r,i){h.hasOwnProperty(e)||(h[e]={}),h[e].lineItemType=r,h[e].idKey=i}var p,l,m,f,h={},y={},g={},S={},_={};return function(){p={},l={},f=e.sizeRetargeting||null,m=setInterval(t,Constants.RENDER_SERVICE_EXPIRY_SWEEP_TIMER),EventsService=SpaceCamp.services.EventsService,window.addEventListener("message",function(e){try{if(!Utilities.isString(e.data)||"ix_ht_render:"!==e.data.substr(0,"ix_ht_render:".length))return;c(JSON.parse(e.data.substr("ix_ht_render:".length)),e.source,e.origin)}catch(e){EventsService.emit("internal_error","Error occurred while rendering ad.",e.stack)}},!1)}(),{__adStorage:p,__expiredAdStorage:l,__expirySweepIntervalId:m,__findAdIdsFromMap:r,registerAd:d,render:o,registerPartner:u,renderDfpAd:v,__expireAd:i,__removeExpiredAds:t}}var Constants=require("constants.js"),Size=require("size.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),Utilities=require("utilities.js"),Whoopsie=require("whoopsie.js"),EventsService;module.exports=RenderService;
},{"constants.js":"/wrapper/src/libs/constants.js","size.js":"/wrapper/src/libs/size.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","utilities.js":"/wrapper/src/libs/utilities.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/services/stubs/compliance-service.stub.js":[function(require,module,exports){
"use strict";function ComplianceServiceStub(){function n(){return{applies:!0,consentString:""}}function e(){return{version:1,uspString:""}}function r(){return!1}function t(n){return n}function i(){return Prms.resolve()}return{gdpr:{getConsent:n,setApplies:function(){}},usp:{getConsent:e},isPrivacyEnabled:r,delay:t,wait:i}}var Prms=require("prms.js");module.exports=ComplianceServiceStub;
},{"prms.js":"/wrapper/src/libs/external/prms.js"}],"/wrapper/src/services/stubs/events-service.stub.js":[function(require,module,exports){
"use strict";var System=require("system.js");module.exports=function(){return{on:System.noOp,emit:System.noOp}};
},{"system.js":"/wrapper/src/libs/system.js"}],"/wrapper/src/services/stubs/gpt-service.stub.js":[function(require,module,exports){
"use strict";var System=require("system.js");module.exports=function(){return{setIdentityTargeting:System.noOp}};
},{"system.js":"/wrapper/src/libs/system.js"}],"/wrapper/src/services/stubs/publisher-sonar-service.stub.js":[function(require,module,exports){
"use strict";module.exports=function(){return{getSonarPayload:function(){return{}},getLastUpdated:function(){return 0},setSonarEmail:function(){return{}}}};
},{}],"/wrapper/src/services/timer-service.js":[function(require,module,exports){
"use strict";function TimerService(){function e(e){return function(){a[e].state=o.TERMINATED;for(var t=0;t<a[e].cbs.length;t++)try{a[e].cbs[t]()}catch(e){}delete a[e].cbs,delete a[e].timer}}function t(t,r,s){var i=System.generateUniqueId(Constants.SESSION_ID_LENGTH);return r=!!r,s=s?[s]:[],a[i]={state:o.NEW,cbs:s,timeout:t},r&&(a[i].state=o.RUNNABLE,a[i].timer=setTimeout(e(i),t)),i}function r(t){a.hasOwnProperty(t)&&a[t].state===o.NEW&&(a[t].state=o.RUNNABLE,a[t].timer=setTimeout(e(t),a[t].timeout))}function s(e,t){a.hasOwnProperty(e)&&a[e].state!==o.TERMINATED&&a[e].cbs.unshift(t)}function i(e){return a.hasOwnProperty(e)?a[e].state:null}function n(e){a.hasOwnProperty(e)&&a[e].state!==o.TERMINATED&&(a[e].state=o.TERMINATED,clearTimeout(a[e].timer),delete a[e].cbs,delete a[e].timer)}var a,o={NEW:0,RUNNABLE:1,TERMINATED:2};return function(){a={}}(),{TimerStates:o,__timerStorage:a,__generateTimerCallback:e,createTimer:t,startTimer:r,addTimerCallback:s,getTimerState:i,clearTimer:n}}var Constants=require("constants.js"),System=require("system.js"),Whoopsie=require("whoopsie.js");module.exports=TimerService;
},{"constants.js":"/wrapper/src/libs/constants.js","system.js":"/wrapper/src/libs/system.js","whoopsie.js":"/wrapper/src/libs/whoopsie.js"}],"/wrapper/src/shells/cassandra-shell.js":[function(require,module,exports){
"use strict";function CassandraShell(){function r(r){if(!Utilities.isObject(r))return void EventsService.emit("error","invalid first-party data: `data` must be an object");if(r.hasOwnProperty("rubicon")){if(!Utilities.isObject(r.rubicon))return void EventsService.emit("error","invalid first-party data.rubicon");for(var e in r.rubicon)if(r.rubicon.hasOwnProperty(e)&&-1===["keywords","inventory","visitor"].indexOf(e))return void EventsService.emit("error","invalid first-party data: unrecognized property "+e+" of `data.rubicon`");if(r.rubicon.hasOwnProperty("keywords")&&!Utilities.isArray(r.rubicon.keywords,"string"))return void EventsService.emit("error","invalid first-party data: `data.rubicon.keywords` must be an array of strings");if(r.rubicon.hasOwnProperty("inventory")){if(!Utilities.isObject(r.rubicon.inventory))return void EventsService.emit("error","invalid first-party data: `data.rubicon.inventory` must be an object");for(var t in r.rubicon.inventory)if(r.rubicon.inventory.hasOwnProperty(t)&&!Utilities.isArray(r.rubicon.inventory[t],"string"))return void EventsService.emit("error","invalid first-party data: property "+t+" of `data.rubicon.inventory` must be an array of strings")}if(r.rubicon.hasOwnProperty("visitor")){if(!Utilities.isObject(r.rubicon.visitor))return void EventsService.emit("error","invalid first-party data: `data.rubicon.visitor` must be an object");for(var i in r.rubicon.visitor)if(r.rubicon.visitor.hasOwnProperty(i)&&!Utilities.isArray(r.rubicon.visitor[i],"string"))return void EventsService.emit("error","invalid first-party data: property "+i+" of `data.rubicon.visitor` must be an array of strings")}}try{__directInterface.Layers.PartnersLayer.setFirstPartyData(r)}catch(r){EventsService.emit("error",r)}}function e(r,e){try{if(!Utilities.isFunction(e))return EventsService.emit("error","callback must be a function"),"";if(!Utilities.isArray(r,"object"))return void EventsService.emit("error","slotDemandObjs must be an array of objects");for(var t=0;t<r.length;t++){var i=r[t];if(!i.hasOwnProperty("slot"))return void EventsService.emit("error","slotDemandObjs["+t+"]: members must contain the slot property");if(!(i.slot.getSlotElementId&&i.slot.setTargeting&&i.slot.getTargeting&&i.slot.clearTargeting))return void EventsService.emit("error","slotDemandObjs["+t+"]: `slot` must be a google slot object");if(i.hasOwnProperty("firstPartyData")){if(!Utilities.isObject(i.firstPartyData))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: `data` must be an object");if(i.firstPartyData.hasOwnProperty("rubicon")){var n=i.firstPartyData.rubicon;if(!Utilities.isObject(n))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid rubicon first-party data");for(var a in n)if(n.hasOwnProperty(a)&&-1===["keywords","inventory","visitor","position"].indexOf(a))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: unrecognized property of `firstPartyData.rubicon`");if(n.hasOwnProperty("keywords")&&!Utilities.isArray(n.keywords,"string"))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: `firstPartyData.rubicon.keywords` must be an array of strings");if(!n.hasOwnProperty("inventory")){if(!Utilities.isObject(n.inventory))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: `firstPartyData.rubicon.inventory` must be an object");for(var s in n.inventory)if(n.inventory.hasOwnProperty(s)&&!Utilities.isArray(n.inventory[s],"string"))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: property "+s+" of `firstPartyData.rubicon.inventory` must be an array of strings")}if(n.hasOwnProperty("visitor")){if(!Utilities.isObject(n.visitor))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: `firstPartyData.rubicon.visitor` must be an object");for(var o in n.visitor)if(n.visitor.hasOwnProperty(o)&&!Utilities.isArray(n.visitor[o],"string"))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: property "+o+" of `firstPartyData.rubicon.visitor` must be an array of strings")}if(n.hasOwnProperty("position")&&!Utilities.isString(n.position))return void EventsService.emit("error","slotDemandObjs["+t+"]: invalid first-party data: `firstPartyData.rubicon.position` must be a string")}}}__directInterface.Layers.GptLayer.retrieveAndSetTargeting(r).then(function(){e()}).catch(function(r){EventsService.emit("error",r),setTimeout(e.bind(null,"Error occurred while retrieving demand"+r.toString()),0)})}catch(r){EventsService.emit("error",r),setTimeout(e.bind(null,"Error occurred while retrieving demand"+r.toString()),0)}}function t(r,e,t){var i="";try{if(!Utilities.isBoolean(e))return EventsService.emit("error","`once` must be a boolean"),i;if(!Utilities.isFunction(t))return EventsService.emit("error","`callback` must be a function"),i;if(!Utilities.isString(r))return EventsService.emit("error","`eventName` must be a string"),i;if(!v.hasOwnProperty(r))return EventsService.emit("error","Unrecognized event "+r),i;var n=function(){var e=Array.prototype.slice.call(arguments);t(r,JSON.stringify(e))};i=e?EventsService.once(r,n):EventsService.on(r,n)}catch(r){EventsService.emit("error",r)}return i}function i(r){try{if(!Utilities.isString(r))return void EventsService.emit("error","`subscriptionId` must be a string");EventsService.off(r)}catch(r){EventsService.emit("error",r)}}function n(){return __directInterface.Layers.IdentityLayer.getIdentityResults()}function a(r){var e={status:!1,message:"Identity feature not enabled"};return e=SpaceCamp.services.PublisherSonarService.setSonarEmail(r),e.status&&__directInterface.Layers.IdentityLayer.invokeAllPartners(),e}var s,__directInterface,o,v={error:1,warning:2,global_timeout_reached:3,partner_instantiated:4,partner_request_sent:5,partner_request_complete:6};if(function(){try{s=window.configs,__directInterface=Loader(s).getDirectInterface(),ComplianceService=SpaceCamp.services.ComplianceService,EventsService=SpaceCamp.services.EventsService;try{__directInterface.Layers.IdentityLayer.retrieve()}catch(r){}}catch(r){o={setFirstPartyData:function(){},retrieveAndSetDemand:function(r,e){return setTimeout(e.bind(null,"wrapper failed to load"),0),""},subscribeEvent:function(){return""},unsubscribeEvent:function(){}}}}(),o)return o;var shellInterface={};if(window[SpaceCamp.NAMESPACE])for(var c in window[SpaceCamp.NAMESPACE])window[SpaceCamp.NAMESPACE].hasOwnProperty(c)&&(shellInterface[c]=window[SpaceCamp.NAMESPACE][c]);shellInterface.setFirstPartyData=r,shellInterface.retrieveAndSetDemand=ComplianceService.delay(e),shellInterface.subscribeEvent=t,shellInterface.unsubscribeEvent=i,shellInterface.setSiteKeyValueData=SpaceCamp.services.KeyValueService.setSiteKeyValueData,shellInterface.setUserKeyValueData=SpaceCamp.services.KeyValueService.setUserKeyValueData,shellInterface.getIdentityInfo=n,shellInterface.setSonarEmail=a;try{eval(window.adapter.exports)}catch(r){}return shellInterface}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),Loader=require("loader.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),ComplianceService,EventsService;module.exports=CassandraShell;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","loader.js":"/wrapper/src/loader.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/shells/direct-bidding-shell.js":[function(require,module,exports){
"use strict";function DirectBiddingShell(){function e(e){if(!Utilities.isObject(e))return void EventsService.emit("error","invalid first-party data: `data` must be an object");if(e.hasOwnProperty("rubicon")){if(!Utilities.isObject(e.rubicon))return void EventsService.emit("error","invalid first-party data.rubicon");for(var r in e.rubicon)if(e.rubicon.hasOwnProperty(r)&&-1===["keywords","inventory","visitor"].indexOf(r))return void EventsService.emit("error","invalid first-party data: unrecognized property "+r+" of `data.rubicon`");if(e.rubicon.hasOwnProperty("keywords")&&!Utilities.isArray(e.rubicon.keywords,"string"))return void EventsService.emit("error","invalid first-party data: `data.rubicon.keywords` must be an array of strings");if(e.rubicon.hasOwnProperty("inventory")){if(!Utilities.isObject(e.rubicon.inventory))return void EventsService.emit("error","invalid first-party data: `data.rubicon.inventory` must be an object");for(var t in e.rubicon.inventory)if(e.rubicon.inventory.hasOwnProperty(t)&&!Utilities.isArray(e.rubicon.inventory[t],"string"))return void EventsService.emit("error","invalid first-party data: property "+t+" of `data.rubicon.inventory` must be an array of strings")}if(e.rubicon.hasOwnProperty("visitor")){if(!Utilities.isObject(e.rubicon.visitor))return void EventsService.emit("error","invalid first-party data: `data.rubicon.visitor` must be an object");for(var i in e.rubicon.visitor)if(e.rubicon.visitor.hasOwnProperty(i)&&!Utilities.isArray(e.rubicon.visitor[i],"string"))return void EventsService.emit("error","invalid first-party data: property "+i+" of `data.rubicon.visitor` must be an array of strings")}}try{__directInterface.Layers.PartnersLayer.setFirstPartyData(e)}catch(e){EventsService.emit("error",e)}}function r(e,r,t){var i={sessionId:""},n="";try{if(!Utilities.isFunction(r))throw n="callback must be a function",EventsService.emit("error",n),new Error(n);if(!Utilities.isArray(e,"object"))return n="htSlotDemandObjs must be an array of objects",EventsService.emit("error",n),void r({},new Error(n));for(var a=0;a<e.length;a++){var o=e[a];if(!o.hasOwnProperty("htSlotName"))return n="htSlotDemandObjs["+a+"]: members must contain the htSlotName property",EventsService.emit("error",n),void r({},new Error(n));if(!Utilities.isString(o.htSlotName))return n="htSlotDemandObjs["+a+"]: htSlotName must be a string",EventsService.emit("error",n),void r({},new Error(n));if(o.hasOwnProperty("firstPartyData")){if(!Utilities.isObject(o.firstPartyData))return n="htSlotDemandObjs["+a+"]: invalid first-party data: `data` must be an object",EventsService.emit("error",n),void r({},new Error(n));if(o.firstPartyData.hasOwnProperty("rubicon")){var s=o.firstPartyData.rubicon;if(!Utilities.isObject(s))return n="htSlotDemandObjs["+a+"]: invalid rubicon first-party data",EventsService.emit("error",n),void r({},new Error(n));for(var v in s)if(s.hasOwnProperty(v)&&-1===["keywords","inventory","visitor","position"].indexOf(v))return n="htSlotDemandObjs["+a+"]: invalid first-party data: unrecognized property of `firstPartyData.rubicon`",EventsService.emit("error",n),void r({},new Error(n));if(s.hasOwnProperty("keywords")&&!Utilities.isArray(s.keywords,"string"))return n="htSlotDemandObjs["+a+"]: invalid first-party data: `firstPartyData.rubicon.keywords` must be an array of strings",EventsService.emit("error",n),void r({},new Error(n));if(!s.hasOwnProperty("inventory")){if(!Utilities.isObject(s.inventory))return n="htSlotDemandObjs["+a+"]: invalid first-party data: `firstPartyData.rubicon.inventory` must be an object",EventsService.emit("error",n),void r({},new Error(n));for(var c in s.inventory)if(s.inventory.hasOwnProperty(c)&&!Utilities.isArray(s.inventory[c],"string"))return n="htSlotDemandObjs["+a+"]: invalid first-party data: property "+c+" of `firstPartyData.rubicon.inventory` must be an array of strings",EventsService.emit("error",n),void r({},new Error(n))}if(s.hasOwnProperty("visitor")){if(!Utilities.isObject(s.visitor))return n="htSlotDemandObjs["+a+"]: invalid first-party data: `firstPartyData.rubicon.visitor` must be an object",EventsService.emit("error",n),void r({},new Error(n));for(var u in s.visitor)if(s.visitor.hasOwnProperty(u)&&!Utilities.isArray(s.visitor[u],"string"))return n="htSlotDemandObjs["+a+"]: invalid first-party data: property "+u+" of `firstPartyData.rubicon.visitor` must be an array of strings",EventsService.emit("error",n),void r({},new Error(n))}if(s.hasOwnProperty("position")&&!Utilities.isString(s.position))return n="htSlotDemandObjs["+a+"]: invalid first-party data: `firstPartyData.rubicon.position` must be a string",EventsService.emit("error",n),void r({},new Error(n))}}}if("undefined"!==Utilities.getType(t)){if(!Utilities.isObject(t))return n="options must be an object",EventsService.emit("error",n),void r({},new Error(n));if(t.hasOwnProperty("timeout")&&(!Utilities.isInteger(t.timeout)||t.timeout<0))return n="options.timeout must be an integer greater than 0",EventsService.emit("error",n),void r({},new Error(n))}i=__directInterface.Layers.DirectBiddingLayer.retrieveDemand(e,t),i.promise.then(function(e){r(e)}).catch(function(e){EventsService.emit("error",e),setTimeout(r.bind(null,{}),0)})}catch(e){EventsService.emit("error",e),setTimeout(r.bind(null,{}),0)}return i.sessionId}function t(e,r,t){if(__directInterface.Layers.VideoInterfaceLayer.retrieveVideoDemandValidation(e,r,t))try{ComplianceService.delay(function(){__directInterface.Layers.VideoInterfaceLayer.retrieveVideoDemand(e,t).promise.then(function(e){r(e)}).catch(function(e){EventsService.emit("error",e),setTimeout(r.bind(null,{}),0)})})()}catch(e){EventsService.emit("error",e),setTimeout(r.bind(null,{}),0)}}function i(e,r){return __directInterface.Layers.VideoInterfaceLayer.buildGamMvt(e,r)}function n(){var e=m;"mobile"===SpaceCamp.DeviceTypeChecker.getDeviceType()&&(e=f);try{e=SpaceCamp.services.AdaptiveTimeoutService.getTimeout(e)}catch(e){}return e}function a(e,r,t){var i="";try{if(!Utilities.isBoolean(r))return EventsService.emit("error","`once` must be a boolean"),i;if(!Utilities.isFunction(t))return EventsService.emit("error","`callback` must be a function"),i;if(!Utilities.isString(e))return EventsService.emit("error","`eventName` must be a string"),i;if(!d.hasOwnProperty(e))return EventsService.emit("error","Unrecognized event "+e),i;var n=function(){var r=Array.prototype.slice.call(arguments);t(e,JSON.stringify(r))};i=r?EventsService.once(e,n):EventsService.on(e,n)}catch(e){EventsService.emit("error",e)}return i}function o(e){try{if(!Utilities.isString(e))return void EventsService.emit("error","`subscriptionId` must be a string");EventsService.off(e)}catch(e){EventsService.emit("error",e)}}function s(){var e={};e=__directInterface.Layers.IdentityLayer.getIdentityResults();for(var r in y)y.hasOwnProperty(r)&&delete e[y[r]];return e}function v(e){var r={status:!1,message:"Identity feature not enabled"};return r=SpaceCamp.services.PublisherSonarService.setSonarEmail(e),r.status&&__directInterface.Layers.IdentityLayer.invokeAllPartners(),r}var c,__directInterface,u,d={error:1,warning:2,global_timeout_reached:3,partner_instantiated:4,partner_request_sent:5,partner_request_complete:6},y,m,f;if(function(){try{c=window.configs,y=[],m=c.Layers[0].configs.desktopGlobalTimeout,f=c.Layers[0].configs.mobileGlobalTimeout,__directInterface=Loader(c).getDirectInterface(),ComplianceService=SpaceCamp.services.ComplianceService,EventsService=SpaceCamp.services.EventsService;try{__directInterface.Layers.IdentityLayer.retrieve()}catch(e){}}catch(e){u={setFirstPartyData:function(){},retrieveDemand:function(e,r){return setTimeout(r.bind(null,{}),0),""},retrieveVideoDemand:function(e,r){return setTimeout(r.bind(null,{}),0),""},subscribeEvent:function(){return""},unsubscribeEvent:function(){}}}}(),u)return u;var shellInterface={};if(window[SpaceCamp.NAMESPACE])for(var l in window[SpaceCamp.NAMESPACE])window[SpaceCamp.NAMESPACE].hasOwnProperty(l)&&(shellInterface[l]=window[SpaceCamp.NAMESPACE][l]);shellInterface.__RTISupressList=y,shellInterface.setFirstPartyData=e,shellInterface.retrieveDemand=ComplianceService.delay(r),shellInterface.retrieveVideoDemand=t,shellInterface.buildGamMvt=i,shellInterface.subscribeEvent=a,shellInterface.unsubscribeEvent=o,shellInterface.getTimeout=n,shellInterface.setSiteKeyValueData=SpaceCamp.services.KeyValueService.setSiteKeyValueData,shellInterface.setUserKeyValueData=SpaceCamp.services.KeyValueService.setUserKeyValueData,shellInterface.getIdentityInfo=s,shellInterface.setSonarEmail=v;try{eval(window.adapter.exports)}catch(e){}return shellInterface}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),Loader=require("loader.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),ComplianceService,EventsService;module.exports=DirectBiddingShell;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","loader.js":"/wrapper/src/loader.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/shells/identity-shell.js":[function(require,module,exports){
"use strict";function IdentityShell(){function e(e,r,t){var i="";try{if(!Utilities.isBoolean(r))return EventsService.emit("error","`once` must be a boolean"),i;if(!Utilities.isFunction(t))return EventsService.emit("error","`callback` must be a function"),i;if(!Utilities.isString(e))return EventsService.emit("error","`eventName` must be a string"),i;if(!c.hasOwnProperty(e))return EventsService.emit("error","Unrecognized event "+e),i;if("rti_partner_request_complete"===e&&!0===a.emitted)return t(e,a.args),i;var n=function(){var r=Array.prototype.slice.call(arguments);t(e,JSON.stringify(r))};i=r?EventsService.once(e,n):EventsService.on(e,n)}catch(e){EventsService.emit("error",e)}return i}function r(e){try{if(!Utilities.isString(e))return void EventsService.emit("error","`subscriptionId` must be a string");EventsService.off(e)}catch(e){EventsService.emit("error",e)}}function t(){return __directInterface.Layers.IdentityLayer.getAllPartnerResults()}function i(e){var r={status:!1,message:"Identity feature not enabled"};return r=SpaceCamp.services.PublisherSonarService.setSonarEmail(e),r.status&&__directInterface.Layers.IdentityLayer.invokeAllPartners(),r}var n,__directInterface,s,a={emitted:!1,args:{}},c={error:1,warning:2,rti_partner_request_complete:3};if(function(){try{n=window.configs,__directInterface=Loader(n).getDirectInterface(),ComplianceService=SpaceCamp.services.ComplianceService,EventsService=SpaceCamp.services.EventsService;var r=Math.random().toString(36).slice(-5);EventsService.emit("hs_session_start",{sessionId:r}),e("rti_partner_request_complete",!0,function(e,t){a={emitted:!0,args:t},EventsService.emit("hs_session_end",{sessionId:r})}),ComplianceService.wait().then(function(){__directInterface.Layers.IdentityLayer.retrieve()}).catch(function(e){})}catch(e){s={subscribeEvent:function(){return""},unsubscribeEvent:function(){}}}}(),s)return s;var shellInterface={};if(window[SpaceCamp.NAMESPACE])for(var o in window[SpaceCamp.NAMESPACE])window[SpaceCamp.NAMESPACE].hasOwnProperty(o)&&(shellInterface[o]=window[SpaceCamp.NAMESPACE][o]);return shellInterface.subscribeEvent=e,shellInterface.unsubscribeEvent=r,shellInterface.getIdentityInfo=t,shellInterface.setSonarEmail=i,shellInterface}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),Loader=require("loader.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),ComplianceService,EventsService;module.exports=IdentityShell;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","loader.js":"/wrapper/src/loader.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/shells/post-gpt-shell.js":[function(require,module,exports){
"use strict";function PostGptShell(){function e(e){for(var t=e.parentElement.parentElement.getAttribute("id"),a=GptHelper.getGpt().pubads().getSlots(),r=0;r<a.length;r++)if(a[r].getSlotElementId()===t)return a[r]}function t(e){if(UserAgentMatcher.msie||UserAgentMatcher.msedge){var t=System.generateUniqueId(),a=document.createElement("div");a.id=t,document.body.appendChild(a);var r=GptHelper.loadGpt();r.cmd.push(function(){window.parent.googletag.pubads().getTargetingKeys().map(function(e){r.pubads().setTargeting(e,window.parent.googletag.pubads().getTargeting(e))});var a=e.getAdUnitPath(),n=[];e.getSizes().map(function(e){n.push([e.getWidth(),e.getHeight()])});var s=e.getTargetingMap(),o=r.defineSlot(a,n,t).addService(r.pubads());for(var c in s)s.hasOwnProperty(c)&&o.setTargeting(c,s[c]);o.setTargeting(i.key,i.value),r.enableServices(),r.display(t)})}else e.setTargeting(i.key,i.value),GptHelper.run(function(){window.parent.googletag.pubads().refresh([e])},window.parent.googletag)}function a(a){var r=e(a);try{var n=Browser.createHiddenIFrame(null,window),i=window.frameElement;__directInterface.Layers.PostGptLayer.display(r,n,i).catch(function(e){try{t(r)}catch(e){}})}catch(e){try{t(r)}catch(e){}}}function r(e){var t={status:!1,message:"Identity feature not enabled"};return t=SpaceCamp.services.PublisherSonarService.setSonarEmail(e),t.status&&__directInterface.Layers.IdentityLayer.invokeAllPartners(),t}var n,i,__directInterface,s;if(function(){try{n=window.configs,i=n.Layers[0].configs.lineItemDisablerTargeting,__directInterface=Loader(n).getDirectInterface(),ComplianceService=SpaceCamp.services.ComplianceService;try{__directInterface.Layers.IdentityLayer.retrieve()}catch(e){}}catch(a){s={display:function(a){t(e(a))}}}}(),s)return s;var shellInterface={};if(window[SpaceCamp.NAMESPACE])for(var o in window[SpaceCamp.NAMESPACE])window[SpaceCamp.NAMESPACE].hasOwnProperty(o)&&(shellInterface[o]=window[SpaceCamp.NAMESPACE][o]);shellInterface.__findGSlot=e,shellInterface.display=ComplianceService.delay(a),shellInterface.setSiteKeyValueData=SpaceCamp.services.KeyValueService.setSiteKeyValueData,shellInterface.setUserKeyValueData=SpaceCamp.services.KeyValueService.setUserKeyValueData,shellInterface.setSonarEmail=r;try{eval(window.adapter.exports)}catch(e){}return shellInterface}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),GptHelper=require("gpt-helper.js"),Loader=require("loader.js"),SpaceCamp=require("space-camp.js"),System=require("system.js"),UserAgentMatcher=require("user-agent-matcher.js"),ComplianceService;module.exports=PostGptShell;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","loader.js":"/wrapper/src/loader.js","space-camp.js":"/wrapper/src/space-camp.js","system.js":"/wrapper/src/libs/system.js","user-agent-matcher.js":"/wrapper/src/libs/external/user-agent-matcher.js"}],"/wrapper/src/shells/pre-gpt-shell.js":[function(require,module,exports){
"use strict";function PreGptShell(){function e(e){return SpaceCamp.LastLineGoogletag.display?SpaceCamp.LastLineGoogletag.display(e):window.googletag.display(e)}function t(e,t){return SpaceCamp.LastLineGoogletag.refresh?SpaceCamp.LastLineGoogletag.refresh(e,t):window.googletag.pubads().refresh(e,t)}function r(e){return SpaceCamp.LastLineGoogletag.destroySlots?SpaceCamp.LastLineGoogletag.destroySlots(e):window.googletag.destroySlots(e)}function i(){return SpaceCamp.LastLineGoogletag.enableSingleRequest?SpaceCamp.LastLineGoogletag.enableSingleRequest():window.googletag.pubads().enableSingleRequest()}function a(){return SpaceCamp.LastLineGoogletag.disableInitialLoad?SpaceCamp.LastLineGoogletag.disableInitialLoad():window.googletag.pubads().disableInitialLoad()}function n(t){try{if(!Utilities.isString(t)&&!GptHelper.isGSlot(t))return EventsService.emit("error","divOrSlot must be a string or valid gslot object"),e(t);__directInterface.Layers.GptLayer.display(t).catch(function(r){return EventsService.emit("error",r),e(t)})}catch(r){return EventsService.emit("error",r),e(t)}}function o(e,r){try{if(e&&!Utilities.isArray(e))return EventsService.emit("error","gSlots must be an array of g-slots."),t(e,r);__directInterface.Layers.GptLayer.refresh(e,r).catch(function(i){return EventsService.emit("error",i),t(e,r)})}catch(i){return EventsService.emit("error",i),t(e,r)}}function s(e,t){var i=!1;!t&&Utilities.isFunction(e)&&(t=e,e=void 0);try{if(e&&!Utilities.isArray(e)?(EventsService.emit("error","gSlots must be an array of g-slots."),i=r(e)):i=__directInterface.Layers.GptLayer.destroySlots(e),Utilities.isFunction(t))return t(i),i}catch(a){if(EventsService.emit("error",a),i=i||r(e),Utilities.isFunction(t))try{return t(i),i}catch(e){EventsService.emit("error",e)}}return i}function c(){try{return __directInterface.Layers.GptLayer.enableSingleRequest()}catch(e){return EventsService.emit("error",e),i()}}function l(){try{return __directInterface.Layers.GptLayer.disableInitialLoad()}catch(e){return EventsService.emit("error",e),a()}}function u(){return w}function d(e){if(!Utilities.isObject(e))return void EventsService.emit("error","invalid first-party data: `data` must be an object");if(e.hasOwnProperty("rubicon")){if(!Utilities.isObject(e.rubicon))return void EventsService.emit("error","invalid first-party data.rubicon");for(var t in e.rubicon)if(e.rubicon.hasOwnProperty(t)&&-1===["keywords","inventory","visitor"].indexOf(t))return void EventsService.emit("error","invalid first-party data: unrecognized property "+t+" of `data.rubicon`");if(e.rubicon.hasOwnProperty("keywords")&&!Utilities.isArray(e.rubicon.keywords,"string"))return void EventsService.emit("error","invalid first-party data: `data.rubicon.keywords` must be an array of strings");if(e.rubicon.hasOwnProperty("inventory")){if(!Utilities.isObject(e.rubicon.inventory))return void EventsService.emit("error","invalid first-party data: `data.rubicon.inventory` must be an object");for(var r in e.rubicon.inventory)if(e.rubicon.inventory.hasOwnProperty(r)&&!Utilities.isArray(e.rubicon.inventory[r],"string"))return void EventsService.emit("error","invalid first-party data: property "+r+" of `data.rubicon.inventory` must be an array of strings")}if(e.rubicon.hasOwnProperty("visitor")){if(!Utilities.isObject(e.rubicon.visitor))return void EventsService.emit("error","invalid first-party data: `data.rubicon.visitor` must be an object");for(var i in e.rubicon.visitor)if(e.rubicon.visitor.hasOwnProperty(i)&&!Utilities.isArray(e.rubicon.visitor[i],"string"))return void EventsService.emit("error","invalid first-party data: property "+i+" of `data.rubicon.visitor` must be an array of strings")}}try{__directInterface.Layers.PartnersLayer.setFirstPartyData(e)}catch(e){EventsService.emit("error",e)}}function v(e,t,r){var i="";try{if(!Utilities.isBoolean(t))return EventsService.emit("error","`once` must be a boolean"),i;if(!Utilities.isFunction(r))return EventsService.emit("error","`callback` must be a function"),i;if(!Utilities.isString(e))return EventsService.emit("error","`eventName` must be a string"),i;if(!L.hasOwnProperty(e))return EventsService.emit("error","Unrecognized event "+e),i;var a=function(){var t=Array.prototype.slice.call(arguments);r(e,JSON.stringify(t))};i=t?EventsService.once(e,a):EventsService.on(e,a)}catch(e){EventsService.emit("error",e)}return i}function g(e){try{if(!Utilities.isString(e))return void EventsService.emit("error","`subscriptionId` must be a string");EventsService.off(e)}catch(e){EventsService.emit("error",e)}}function p(){return __directInterface.Layers.IdentityLayer.getIdentityResults()}function y(e,t,r){if(__directInterface.Layers.VideoInterfaceLayer.retrieveVideoDemandValidation(e,t,r))try{ComplianceService.delay(function(){__directInterface.Layers.VideoInterfaceLayer.retrieveVideoDemand(e,r).promise.then(function(e){t(e)}).catch(function(e){EventsService.emit("error",e),setTimeout(t.bind(null,{}),0)})})()}catch(e){EventsService.emit("error",e),setTimeout(t.bind(null,{}),0)}}function S(e,t){return __directInterface.Layers.VideoInterfaceLayer.buildGamMvt(e,t)}function m(e){var t={status:!1,message:"Identity feature not enabled"};return t=SpaceCamp.services.PublisherSonarService.setSonarEmail(e),t.status&&__directInterface.Layers.IdentityLayer.invokeAllPartners(),t}var b,__directInterface,f,w,L={error:1,warning:2,global_timeout_reached:3,partner_instantiated:4,partner_request_sent:5,partner_request_complete:6};if(function(){SpaceCamp.LastLineGoogletag={};try{b=window.configs,window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],__directInterface=Loader(b).getDirectInterface(),ComplianceService=SpaceCamp.services.ComplianceService,EventsService=SpaceCamp.services.EventsService;var u=b.Layers[0].configs.override;if(u){var d=function(){u.display&&(SpaceCamp.LastLineGoogletag.display=window.googletag.display,window.googletag.display=ComplianceService.delay(n)),u.refresh&&(SpaceCamp.LastLineGoogletag.refresh=window.googletag.pubads().refresh.bind(window.googletag.pubads()),window.googletag.pubads().refresh=ComplianceService.delay(o)),u.destroySlots&&(SpaceCamp.LastLineGoogletag.destroySlots=window.googletag.destroySlots,window.googletag.destroySlots=ComplianceService.delay(s)),u.enableSingleRequest&&(SpaceCamp.LastLineGoogletag.enableSingleRequest=window.googletag.pubads().enableSingleRequest.bind(window.googletag.pubads()),window.googletag.pubads().enableSingleRequest=c),u.disableInitialLoad&&(SpaceCamp.LastLineGoogletag.disableInitialLoad=window.googletag.pubads().disableInitialLoad.bind(window.googletag.pubads()),window.googletag.pubads().disableInitialLoad=l)};SpaceCamp.initQueue.unshift(d);var v=function(){SpaceCamp.initQueue=CommandQueue(SpaceCamp.initQueue)};Utilities.isArray(window.googletag.cmd)?window.googletag.cmd.unshift(v):window.googletag.cmd.push(v)}w={refresh:ComplianceService.delay(o),enableSingleRequest:c,disableInitialLoad:l};try{__directInterface.Layers.IdentityLayer.retrieve()}catch(e){}}catch(n){f={display:e,destroySlots:r,pubads:function(){return{refresh:t,enableSingleRequest:i,disableInitialLoad:a}},setFirstPartyData:function(){},subscribeEvent:function(){return""},unsubscribeEvent:function(){}}}}(),f)return f;var shellInterface={};if(window[SpaceCamp.NAMESPACE])for(var E in window[SpaceCamp.NAMESPACE])window[SpaceCamp.NAMESPACE].hasOwnProperty(E)&&(shellInterface[E]=window[SpaceCamp.NAMESPACE][E]);shellInterface.display=ComplianceService.delay(n),shellInterface.refresh=ComplianceService.delay(o),shellInterface.destroySlots=ComplianceService.delay(s),shellInterface.enableSingleRequest=c,shellInterface.disableInitialLoad=l,shellInterface.pubads=u,shellInterface.setFirstPartyData=d,shellInterface.subscribeEvent=v,shellInterface.unsubscribeEvent=g,shellInterface.apiReady=!0,shellInterface.setSiteKeyValueData=SpaceCamp.services.KeyValueService.setSiteKeyValueData,shellInterface.setUserKeyValueData=SpaceCamp.services.KeyValueService.setUserKeyValueData,shellInterface.getIdentityInfo=p,shellInterface.retrieveVideoDemand=y,shellInterface.buildGamMvt=S,shellInterface.setSonarEmail=m;try{eval(window.adapter.exports)}catch(e){}return shellInterface}var Browser=require("browser.js"),CommandQueue=require("command-queue.js"),Loader=require("loader.js"),SpaceCamp=require("space-camp.js"),Utilities=require("utilities.js"),GptHelper=require("gpt-helper.js"),ComplianceService,EventsService;module.exports=PreGptShell;
},{"browser.js":"/wrapper/src/libs/browser.js","command-queue.js":"/wrapper/src/libs/command-queue.js","gpt-helper.js":"/wrapper/src/libs/gpt-helper.js","loader.js":"/wrapper/src/loader.js","space-camp.js":"/wrapper/src/space-camp.js","utilities.js":"/wrapper/src/libs/utilities.js"}],"/wrapper/src/space-camp.js":[function(require,module,exports){
"use strict";var SpaceCamp={NAMESPACE:"headertag",PRODUCT:"DfpMode",services:{},htSlots:[],htSlotsMap:{},DeviceTypeChecker:{},initQueue:[],globalTimeout:null,instanceId:null,version:"2.28.0"};module.exports=SpaceCamp;
},{}]},{},[]);
